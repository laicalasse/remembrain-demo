var gf=Object.defineProperty;var bf=(r,e,t)=>e in r?gf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var te=(r,e,t)=>bf(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const _f="modulepreload",vf=function(r){return"/remembrain-demo/"+r},Pa={},Ho=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=vf(l),l in Pa)return;Pa[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":_f,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((p,v)=>{h.addEventListener("load",p),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ta=new WeakMap,Ia=r=>{if((t=>t.pattern!==void 0)(r))return r.pattern;let e=Ta.get(r);return e===void 0&&Ta.set(r,e=new URLPattern({pathname:r.path})),e};let yf=class{constructor(e,t,n){this.routes=[],this.o=[],this.t={},this.i=i=>{if(i.routes===this)return;const s=i.routes;this.o.push(s),s.h=this,i.stopImmediatePropagation(),i.onDisconnect=()=>{var o;(o=this.o)==null||o.splice(this.o.indexOf(s)>>>0,1)};const a=Ma(this.t);a!==void 0&&s.goto(a)},(this.l=e).addController(this),this.routes=[...t],this.fallback=n==null?void 0:n.fallback}link(e){var t;if(e!=null&&e.startsWith("/"))return e;if(e!=null&&e.startsWith("."))throw Error("Not implemented");return e??(e=this.u),(((t=this.h)==null?void 0:t.link())??"")+e}async goto(e){let t;if(this.routes.length===0&&this.fallback===void 0)t=e,this.u="",this.t={0:t};else{const n=this.p(e);if(n===void 0)throw Error("No route found for "+e);const i=Ia(n).exec({pathname:e}),s=(i==null?void 0:i.pathname.groups)??{};if(t=Ma(s),typeof n.enter=="function"&&await n.enter(s)===!1)return;this.v=n,this.t=s,this.u=t===void 0?e:e.substring(0,e.length-t.length)}if(t!==void 0)for(const n of this.o)n.goto(t);this.l.requestUpdate()}outlet(){var e,t;return(t=(e=this.v)==null?void 0:e.render)==null?void 0:t.call(e,this.t)}get params(){return this.t}p(e){const t=this.routes.find(n=>Ia(n).test({pathname:e}));return t||this.fallback===void 0?t:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(zi.eventName,this.i);const e=new zi(this);this.l.dispatchEvent(e),this._=e.onDisconnect}hostDisconnected(){var e;(e=this._)==null||e.call(this),this.h=void 0}};const Ma=r=>{let e;for(const t of Object.keys(r))/\d+/.test(t)&&(e===void 0||t>e)&&(e=t);return e&&r[e]};let zi=class Wo extends Event{constructor(e){super(Wo.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=e}};zi.eventName="lit-routes-connected";/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const wf=location.origin||location.protocol+"//"+location.host;let xf=class extends yf{constructor(){super(...arguments),this.m=e=>{const t=e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey;if(e.defaultPrevented||t)return;const n=e.composedPath().find(a=>a.tagName==="A");if(n===void 0||n.target!==""||n.hasAttribute("download")||n.getAttribute("rel")==="external")return;const i=n.href;if(i===""||i.startsWith("mailto:"))return;const s=window.location;n.origin===wf&&(e.preventDefault(),i!==s.href&&(window.history.pushState({},"",i),this.goto(n.pathname)))},this.R=e=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}};function W(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];throw new Error(typeof r=="number"?"[MobX] minified error nr: "+r+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+r)}var Af={};function Zr(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:Af}var qo=Object.assign,Nr=Object.getOwnPropertyDescriptor,Ze=Object.defineProperty,Kn=Object.prototype,Vi=[];Object.freeze(Vi);var _s={};Object.freeze(_s);var Sf=typeof Proxy<"u",Ef=Object.toString();function Ko(){Sf||W("Proxy not available")}function Go(r){var e=!1;return function(){if(!e)return e=!0,r.apply(this,arguments)}}var Qt=function(){};function ze(r){return typeof r=="function"}function Tt(r){var e=typeof r;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Qr(r){return r!==null&&typeof r=="object"}function lt(r){if(!Qr(r))return!1;var e=Object.getPrototypeOf(r);if(e==null)return!0;var t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t.toString()===Ef}function Xo(r){var e=r==null?void 0:r.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function ei(r,e,t){Ze(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function Jo(r,e,t){Ze(r,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function yt(r,e){var t="isMobX"+r;return e.prototype[t]=!0,function(n){return Qr(n)&&n[t]===!0}}function dn(r){return r!=null&&Object.prototype.toString.call(r)==="[object Map]"}function kf(r){var e=Object.getPrototypeOf(r),t=Object.getPrototypeOf(e),n=Object.getPrototypeOf(t);return n===null}function st(r){return r!=null&&Object.prototype.toString.call(r)==="[object Set]"}var Yo=typeof Object.getOwnPropertySymbols<"u";function Cf(r){var e=Object.keys(r);if(!Yo)return e;var t=Object.getOwnPropertySymbols(r);return t.length?[].concat(e,t.filter(function(n){return Kn.propertyIsEnumerable.call(r,n)})):e}var Bn=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Yo?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames;function Zo(r){return r===null?null:typeof r=="object"?""+r:r}function bt(r,e){return Kn.hasOwnProperty.call(r,e)}var Of=Object.getOwnPropertyDescriptors||function(e){var t={};return Bn(e).forEach(function(n){t[n]=Nr(e,n)}),t};function Ae(r,e){return!!(r&e)}function Se(r,e,t){return t?r|=e:r&=~e,r}function Na(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function Rf(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Pf(n.key),n)}}function pn(r,e,t){return e&&Rf(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function en(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=Tf(r))||e){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ln(){return ln=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ln.apply(null,arguments)}function Qo(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Hi(r,e)}function Hi(r,e){return Hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Hi(r,e)}function $f(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Pf(r){var e=$f(r,"string");return typeof e=="symbol"?e:e+""}function Tf(r,e){if(r){if(typeof r=="string")return Na(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Na(r,e):void 0}}var tn=Symbol("mobx-stored-annotations");function Qe(r){function e(t,n){if(Xn(n))return r.decorate_20223_(t,n);Gn(t,n,r)}return Object.assign(e,r)}function Gn(r,e,t){bt(r,tn)||ei(r,tn,ln({},r[tn])),Bf(t)||(r[tn][e]=t)}function Xn(r){return typeof r=="object"&&typeof r.kind=="string"}var j=Symbol("mobx administration"),wt=function(){function r(t){t===void 0&&(t="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=K.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t}var e=r.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return gl(this)},e.reportChanged=function(){Re(),bl(this),$e()},e.toString=function(){return this.name_},pn(r,[{key:"isBeingObserved",get:function(){return Ae(this.flags_,r.isBeingObservedMask_)},set:function(n){this.flags_=Se(this.flags_,r.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Ae(this.flags_,r.isPendingUnobservationMask_)},set:function(n){this.flags_=Se(this.flags_,r.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Ae(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=Se(this.flags_,r.diffValueMask_,n===1)}}])}();wt.isBeingObservedMask_=1;wt.isPendingUnobservationMask_=2;wt.diffValueMask_=4;var vs=yt("Atom",wt);function el(r,e,t){e===void 0&&(e=Qt),t===void 0&&(t=Qt);var n=new wt(r);return e!==Qt&&zh(n,e),t!==Qt&&Sl(n,t),n}function If(r,e){return Dl(r,e)}function Mf(r,e){return Object.is?Object.is(r,e):r===e?r!==0||1/r===1/e:r!==r&&e!==e}var un={structural:If,default:Mf};function It(r,e,t){return As(r)?r:Array.isArray(r)?pe.array(r,{name:t}):lt(r)?pe.object(r,void 0,{name:t}):dn(r)?pe.map(r,{name:t}):st(r)?pe.set(r,{name:t}):typeof r=="function"&&!Fn(r)&&!Un(r)?Xo(r)?cn(r):jn(t,r):r}function Nf(r,e,t){if(r==null||tr(r)||er(r)||xt(r)||De(r))return r;if(Array.isArray(r))return pe.array(r,{name:t,deep:!1});if(lt(r))return pe.object(r,void 0,{name:t,deep:!1});if(dn(r))return pe.map(r,{name:t,deep:!1});if(st(r))return pe.set(r,{name:t,deep:!1})}function ti(r){return r}function Lf(r,e){return Dl(r,e)?e:r}var Df="override";function Bf(r){return r.annotationType_===Df}function Jn(r,e){return{annotationType_:r,options_:e,make_:jf,extend_:Ff,decorate_20223_:Uf}}function jf(r,e,t,n){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(r,e,t,!1)===null?0:1;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if(Fn(t.value))return 1;var s=tl(r,this,e,t,!1);return Ze(n,e,s),2}function Ff(r,e,t,n){var i=tl(r,this,e,t);return r.defineProperty_(e,i,n)}function Uf(r,e){var t=e.kind,n=e.name,i=e.addInitializer,s=this,a=function(u){var c,h,p,v;return Mt((c=(h=s.options_)==null?void 0:h.name)!=null?c:n.toString(),u,(p=(v=s.options_)==null?void 0:v.autoAction)!=null?p:!1)};if(t=="field")return function(l){var u,c=l;return Fn(c)||(c=a(c)),(u=s.options_)!=null&&u.bound&&(c=c.bind(this),c.isMobxAction=!0),c};if(t=="method"){var o;return Fn(r)||(r=a(r)),(o=this.options_)!=null&&o.bound&&i(function(){var l=this,u=l[n].bind(l);u.isMobxAction=!0,l[n]=u}),r}W("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+t+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function zf(r,e,t,n){e.annotationType_,n.value}function tl(r,e,t,n,i){var s,a,o,l,u,c,h;i===void 0&&(i=T.safeDescriptors),zf(r,e,t,n);var p=n.value;if((s=e.options_)!=null&&s.bound){var v;p=p.bind((v=r.proxy_)!=null?v:r.target_)}return{value:Mt((a=(o=e.options_)==null?void 0:o.name)!=null?a:t.toString(),p,(l=(u=e.options_)==null?void 0:u.autoAction)!=null?l:!1,(c=e.options_)!=null&&c.bound?(h=r.proxy_)!=null?h:r.target_:void 0),configurable:i?r.isPlainObject_:!0,enumerable:!1,writable:!i}}function nl(r,e){return{annotationType_:r,options_:e,make_:Vf,extend_:Hf,decorate_20223_:Wf}}function Vf(r,e,t,n){var i;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!bt(r.target_,e)||!Un(r.target_[e]))&&this.extend_(r,e,t,!1)===null)return 0;if(Un(t.value))return 1;var s=rl(r,this,e,t,!1,!1);return Ze(n,e,s),2}function Hf(r,e,t,n){var i,s=rl(r,this,e,t,(i=this.options_)==null?void 0:i.bound);return r.defineProperty_(e,s,n)}function Wf(r,e){var t,n=e.name,i=e.addInitializer;return Un(r)||(r=cn(r)),(t=this.options_)!=null&&t.bound&&i(function(){var s=this,a=s[n].bind(s);a.isMobXFlow=!0,s[n]=a}),r}function qf(r,e,t,n){e.annotationType_,n.value}function rl(r,e,t,n,i,s){s===void 0&&(s=T.safeDescriptors),qf(r,e,t,n);var a=n.value;if(Un(a)||(a=cn(a)),i){var o;a=a.bind((o=r.proxy_)!=null?o:r.target_),a.isMobXFlow=!0}return{value:a,configurable:s?r.isPlainObject_:!0,enumerable:!1,writable:!s}}function ys(r,e){return{annotationType_:r,options_:e,make_:Kf,extend_:Gf,decorate_20223_:Xf}}function Kf(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function Gf(r,e,t,n){return Jf(r,this,e,t),r.defineComputedProperty_(e,ln({},this.options_,{get:t.get,set:t.set}),n)}function Xf(r,e){var t=this,n=e.name,i=e.addInitializer;return i(function(){var s=mn(this)[j],a=ln({},t.options_,{get:r,context:this});a.name||(a.name="ObservableObject."+n.toString()),s.values_.set(n,new Ve(a))}),function(){return this[j].getObservablePropValue_(n)}}function Jf(r,e,t,n){e.annotationType_,n.get}function ni(r,e){return{annotationType_:r,options_:e,make_:Yf,extend_:Zf,decorate_20223_:Qf}}function Yf(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function Zf(r,e,t,n){var i,s;return eh(r,this),r.defineObservableProperty_(e,t.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:It,n)}function Qf(r,e){var t=this,n=e.kind,i=e.name,s=new WeakSet;function a(o,l){var u,c,h=mn(o)[j],p=new _t(l,(u=(c=t.options_)==null?void 0:c.enhancer)!=null?u:It,"ObservableObject."+i.toString(),!1);h.values_.set(i,p),s.add(o)}if(n=="accessor")return{get:function(){return s.has(this)||a(this,r.get.call(this)),this[j].getObservablePropValue_(i)},set:function(l){return s.has(this)||a(this,l),this[j].setObservablePropValue_(i,l)},init:function(l){return s.has(this)||a(this,l),l}}}function eh(r,e,t,n){e.annotationType_}var th="true",nh=il();function il(r){return{annotationType_:th,options_:r,make_:rh,extend_:ih,decorate_20223_:sh}}function rh(r,e,t,n){var i,s;if(t.get)return ri.make_(r,e,t,n);if(t.set){var a=Mt(e.toString(),t.set);return n===r.target_?r.defineProperty_(e,{configurable:T.safeDescriptors?r.isPlainObject_:!0,set:a})===null?0:2:(Ze(n,e,{configurable:!0,set:a}),2)}if(n!==r.target_&&typeof t.value=="function"){var o;if(Xo(t.value)){var l,u=(l=this.options_)!=null&&l.autoBind?cn.bound:cn;return u.make_(r,e,t,n)}var c=(o=this.options_)!=null&&o.autoBind?jn.bound:jn;return c.make_(r,e,t,n)}var h=((i=this.options_)==null?void 0:i.deep)===!1?pe.ref:pe;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var p;t.value=t.value.bind((p=r.proxy_)!=null?p:r.target_)}return h.make_(r,e,t,n)}function ih(r,e,t,n){var i,s;if(t.get)return ri.extend_(r,e,t,n);if(t.set)return r.defineProperty_(e,{configurable:T.safeDescriptors?r.isPlainObject_:!0,set:Mt(e.toString(),t.set)},n);if(typeof t.value=="function"&&(i=this.options_)!=null&&i.autoBind){var a;t.value=t.value.bind((a=r.proxy_)!=null?a:r.target_)}var o=((s=this.options_)==null?void 0:s.deep)===!1?pe.ref:pe;return o.extend_(r,e,t,n)}function sh(r,e){W("'"+this.annotationType_+"' cannot be used as a decorator")}var ah="observable",oh="observable.ref",lh="observable.shallow",uh="observable.struct",sl={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(sl);function dr(r){return r||sl}var Wi=ni(ah),ch=ni(oh,{enhancer:ti}),fh=ni(lh,{enhancer:Nf}),hh=ni(uh,{enhancer:Lf}),al=Qe(Wi);function pr(r){return r.deep===!0?It:r.deep===!1?ti:ph(r.defaultDecorator)}function dh(r){var e;return r?(e=r.defaultDecorator)!=null?e:il(r):void 0}function ph(r){var e,t;return r&&(e=(t=r.options_)==null?void 0:t.enhancer)!=null?e:It}function ol(r,e,t){if(Xn(e))return Wi.decorate_20223_(r,e);if(Tt(e)){Gn(r,e,Wi);return}return As(r)?r:lt(r)?pe.object(r,e,t):Array.isArray(r)?pe.array(r,e):dn(r)?pe.map(r,e):st(r)?pe.set(r,e):typeof r=="object"&&r!==null?r:pe.box(r,e)}qo(ol,al);var mh={box:function(e,t){var n=dr(t);return new _t(e,pr(n),n.name,!0,n.equals)},array:function(e,t){var n=dr(t);return(T.useProxies===!1||n.proxy===!1?ud:Qh)(e,pr(n),n.name)},map:function(e,t){var n=dr(t);return new Pl(e,pr(n),n.name)},set:function(e,t){var n=dr(t);return new Tl(e,pr(n),n.name)},object:function(e,t,n){return Ut(function(){return Cl(T.useProxies===!1||(n==null?void 0:n.proxy)===!1?mn({},n):Jh({},n),e,t)})},ref:Qe(ch),shallow:Qe(fh),deep:al,struct:Qe(hh)},pe=qo(ol,mh),ll="computed",gh="computed.struct",qi=ys(ll),bh=ys(gh,{equals:un.structural}),ri=function(e,t){if(Xn(t))return qi.decorate_20223_(e,t);if(Tt(t))return Gn(e,t,qi);if(lt(e))return Qe(ys(ll,e));var n=lt(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new Ve(n)};Object.assign(ri,qi);ri.struct=Qe(bh);var La,Da,Lr=0,_h=1,vh=(La=(Da=Nr(function(){},"name"))==null?void 0:Da.configurable)!=null?La:!1,Ba={value:"action",configurable:!0,writable:!1,enumerable:!1};function Mt(r,e,t,n){t===void 0&&(t=!1);function i(){return ul(r,t,e,n||this,arguments)}return i.isMobxAction=!0,i.toString=function(){return e.toString()},vh&&(Ba.value=r,Ze(i,"name",Ba)),i}function ul(r,e,t,n,i){var s=yh(r,e);try{return t.apply(n,i)}catch(a){throw s.error_=a,a}finally{wh(s)}}function yh(r,e,t,n){var i=!1,s=0,a=T.trackingDerivation,o=!e||!a;Re();var l=T.allowStateChanges;o&&(jt(),l=ii(!0));var u=ws(!0),c={runAsAction_:o,prevDerivation_:a,prevAllowStateChanges_:l,prevAllowStateReads_:u,notifySpy_:i,startTime_:s,actionId_:_h++,parentActionId_:Lr};return Lr=c.actionId_,c}function wh(r){Lr!==r.actionId_&&W(30),Lr=r.parentActionId_,r.error_!==void 0&&(T.suppressReactionErrors=!0),si(r.prevAllowStateChanges_),$n(r.prevAllowStateReads_),$e(),r.runAsAction_&&ot(r.prevDerivation_),T.suppressReactionErrors=!1}function xh(r,e){var t=ii(r);try{return e()}finally{si(t)}}function ii(r){var e=T.allowStateChanges;return T.allowStateChanges=r,e}function si(r){T.allowStateChanges=r}var _t=function(r){function e(n,i,s,a,o){var l;return s===void 0&&(s="ObservableValue"),o===void 0&&(o=un.default),l=r.call(this,s)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=i,l.name_=s,l.equals=o,l.value_=i(n,void 0,s),l}Qo(e,r);var t=e.prototype;return t.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==T.UNCHANGED&&this.setNewValue_(i)},t.prepareNewValue_=function(i){if(Ce(this)){var s=Oe(this,{object:this,type:et,newValue:i});if(!s)return T.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?T.UNCHANGED:i},t.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),Fe(this)&&Ue(this,{type:et,object:this,newValue:i,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(i){return Zn(this,i)},t.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:et,newValue:this.value_,oldValue:void 0}),Qn(this,i)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return Zo(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},e}(wt),Ah=yt("ObservableValue",_t),Ve=function(){function r(t){this.dependenciesState_=K.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=K.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Br(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Dr.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||W(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=Mt("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?un.structural:un.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var e=r.prototype;return e.onBecomeStale_=function(){Oh(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing&&W(32,this.name_,this.derivation),T.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Ki(this)&&(this.warnAboutUntrackedRead_(),Re(),this.value_=this.computeValue_(!1),$e());else if(gl(this),Ki(this)){var n=T.trackingContext;this.keepAlive_&&!n&&(T.trackingContext=this),this.trackAndCompute()&&Ch(this),T.trackingContext=n}var i=this.value_;if(Er(i))throw i.cause;return i},e.set=function(n){if(this.setter_){this.isRunningSetter&&W(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else W(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,i=this.dependenciesState_===K.NOT_TRACKING_,s=this.computeValue_(!0),a=i||Er(n)||Er(s)||!this.equals_(n,s);return a&&(this.value_=s),a},e.computeValue_=function(n){this.isComputing=!0;var i=ii(!1),s;if(n)s=cl(this,this.derivation,this.scope_);else if(T.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(a){s=new Br(a)}return si(i),this.isComputing=!1,s},e.suspend_=function(){this.keepAlive_||(Gi(this),this.value_=void 0)},e.observe_=function(n,i){var s=this,a=!0,o=void 0;return Dh(function(){var l=s.get();if(!a||i){var u=jt();n({observableKind:"computed",debugObjectName:s.name_,type:et,object:s,newValue:l,oldValue:o}),ot(u)}a=!1,o=l})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return Zo(this.get())},e[Symbol.toPrimitive]=function(){return this.valueOf()},pn(r,[{key:"isComputing",get:function(){return Ae(this.flags_,r.isComputingMask_)},set:function(n){this.flags_=Se(this.flags_,r.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return Ae(this.flags_,r.isRunningSetterMask_)},set:function(n){this.flags_=Se(this.flags_,r.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return Ae(this.flags_,r.isBeingObservedMask_)},set:function(n){this.flags_=Se(this.flags_,r.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Ae(this.flags_,r.isPendingUnobservationMask_)},set:function(n){this.flags_=Se(this.flags_,r.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Ae(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=Se(this.flags_,r.diffValueMask_,n===1)}}])}();Ve.isComputingMask_=1;Ve.isRunningSetterMask_=2;Ve.isBeingObservedMask_=4;Ve.isPendingUnobservationMask_=8;Ve.diffValueMask_=16;var Yn=yt("ComputedValue",Ve),K;(function(r){r[r.NOT_TRACKING_=-1]="NOT_TRACKING_",r[r.UP_TO_DATE_=0]="UP_TO_DATE_",r[r.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",r[r.STALE_=2]="STALE_"})(K||(K={}));var Dr;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(Dr||(Dr={}));var Br=function(e){this.cause=void 0,this.cause=e};function Er(r){return r instanceof Br}function Ki(r){switch(r.dependenciesState_){case K.UP_TO_DATE_:return!1;case K.NOT_TRACKING_:case K.STALE_:return!0;case K.POSSIBLY_STALE_:{for(var e=ws(!0),t=jt(),n=r.observing_,i=n.length,s=0;s<i;s++){var a=n[s];if(Yn(a)){if(T.disableErrorBoundaries)a.get();else try{a.get()}catch{return ot(t),$n(e),!0}if(r.dependenciesState_===K.STALE_)return ot(t),$n(e),!0}}return hl(r),ot(t),$n(e),!1}}}function cl(r,e,t){var n=ws(!0);hl(r),r.newObserving_=new Array(r.runId_===0?100:r.observing_.length),r.unboundDepsCount_=0,r.runId_=++T.runId;var i=T.trackingDerivation;T.trackingDerivation=r,T.inBatch++;var s;if(T.disableErrorBoundaries===!0)s=e.call(t);else try{s=e.call(t)}catch(a){s=new Br(a)}return T.inBatch--,T.trackingDerivation=i,Sh(r),$n(n),s}function Sh(r){for(var e=r.observing_,t=r.observing_=r.newObserving_,n=K.UP_TO_DATE_,i=0,s=r.unboundDepsCount_,a=0;a<s;a++){var o=t[a];o.diffValue===0&&(o.diffValue=1,i!==a&&(t[i]=o),i++),o.dependenciesState_>n&&(n=o.dependenciesState_)}for(t.length=i,r.newObserving_=null,s=e.length;s--;){var l=e[s];l.diffValue===0&&pl(l,r),l.diffValue=0}for(;i--;){var u=t[i];u.diffValue===1&&(u.diffValue=0,kh(u,r))}n!==K.UP_TO_DATE_&&(r.dependenciesState_=n,r.onBecomeStale_())}function Gi(r){var e=r.observing_;r.observing_=[];for(var t=e.length;t--;)pl(e[t],r);r.dependenciesState_=K.NOT_TRACKING_}function fl(r){var e=jt();try{return r()}finally{ot(e)}}function jt(){var r=T.trackingDerivation;return T.trackingDerivation=null,r}function ot(r){T.trackingDerivation=r}function ws(r){var e=T.allowStateReads;return T.allowStateReads=r,e}function $n(r){T.allowStateReads=r}function hl(r){if(r.dependenciesState_!==K.UP_TO_DATE_){r.dependenciesState_=K.UP_TO_DATE_;for(var e=r.observing_,t=e.length;t--;)e[t].lowestObserverState_=K.UP_TO_DATE_}}var kr=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},Cr=!0,dl=!1,T=function(){var r=Zr();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(Cr=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new kr().version&&(Cr=!1),Cr?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new kr):(setTimeout(function(){dl||W(35)},1),new kr)}();function Eh(){if((T.pendingReactions.length||T.inBatch||T.isRunningReactions)&&W(36),dl=!0,Cr){var r=Zr();--r.__mobxInstanceCount===0&&(r.__mobxGlobals=void 0),T=new kr}}function kh(r,e){r.observers_.add(e),r.lowestObserverState_>e.dependenciesState_&&(r.lowestObserverState_=e.dependenciesState_)}function pl(r,e){r.observers_.delete(e),r.observers_.size===0&&ml(r)}function ml(r){r.isPendingUnobservation===!1&&(r.isPendingUnobservation=!0,T.pendingUnobservations.push(r))}function Re(){T.inBatch++}function $e(){if(--T.inBatch===0){_l();for(var r=T.pendingUnobservations,e=0;e<r.length;e++){var t=r[e];t.isPendingUnobservation=!1,t.observers_.size===0&&(t.isBeingObserved&&(t.isBeingObserved=!1,t.onBUO()),t instanceof Ve&&t.suspend_())}T.pendingUnobservations=[]}}function gl(r){var e=T.trackingDerivation;return e!==null?(e.runId_!==r.lastAccessedBy_&&(r.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=r,!r.isBeingObserved&&T.trackingContext&&(r.isBeingObserved=!0,r.onBO())),r.isBeingObserved):(r.observers_.size===0&&T.inBatch>0&&ml(r),!1)}function bl(r){r.lowestObserverState_!==K.STALE_&&(r.lowestObserverState_=K.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===K.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=K.STALE_}))}function Ch(r){r.lowestObserverState_!==K.STALE_&&(r.lowestObserverState_=K.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===K.POSSIBLY_STALE_?e.dependenciesState_=K.STALE_:e.dependenciesState_===K.UP_TO_DATE_&&(r.lowestObserverState_=K.UP_TO_DATE_)}))}function Oh(r){r.lowestObserverState_===K.UP_TO_DATE_&&(r.lowestObserverState_=K.POSSIBLY_STALE_,r.observers_.forEach(function(e){e.dependenciesState_===K.UP_TO_DATE_&&(e.dependenciesState_=K.POSSIBLY_STALE_,e.onBecomeStale_())}))}var tt=function(){function r(t,n,i,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=K.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=Dr.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=i,this.requiresObservable_=s}var e=r.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled||(this.isScheduled=!0,T.pendingReactions.push(this),_l())},e.runReaction_=function(){if(!this.isDisposed){Re(),this.isScheduled=!1;var n=T.trackingContext;if(T.trackingContext=this,Ki(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}T.trackingContext=n,$e()}},e.track=function(n){if(!this.isDisposed){Re(),this.isRunning=!0;var i=T.trackingContext;T.trackingContext=this;var s=cl(this,n,void 0);T.trackingContext=i,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Gi(this),Er(s)&&this.reportExceptionInDerivation_(s.cause),$e()}},e.reportExceptionInDerivation_=function(n){var i=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(T.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";T.suppressReactionErrors||console.error(s,n),T.globalReactionErrorHandlers.forEach(function(a){return a(n,i)})},e.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Re(),Gi(this),$e()))},e.getDisposer_=function(n){var i=this,s=function a(){i.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",a)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[j]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},pn(r,[{key:"isDisposed",get:function(){return Ae(this.flags_,r.isDisposedMask_)},set:function(n){this.flags_=Se(this.flags_,r.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return Ae(this.flags_,r.isScheduledMask_)},set:function(n){this.flags_=Se(this.flags_,r.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return Ae(this.flags_,r.isTrackPendingMask_)},set:function(n){this.flags_=Se(this.flags_,r.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return Ae(this.flags_,r.isRunningMask_)},set:function(n){this.flags_=Se(this.flags_,r.isRunningMask_,n)}},{key:"diffValue",get:function(){return Ae(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=Se(this.flags_,r.diffValueMask_,n===1)}}])}();tt.isDisposedMask_=1;tt.isScheduledMask_=2;tt.isTrackPendingMask_=4;tt.isRunningMask_=8;tt.diffValueMask_=16;var Rh=100,Xi=function(e){return e()};function _l(){T.inBatch>0||T.isRunningReactions||Xi($h)}function $h(){T.isRunningReactions=!0;for(var r=T.pendingReactions,e=0;r.length>0;){++e===Rh&&(console.error("[mobx] cycle in reaction: "+r[0]),r.splice(0));for(var t=r.splice(0),n=0,i=t.length;n<i;n++)t[n].runReaction_()}T.isRunningReactions=!1}var jr=yt("Reaction",tt);function Ph(r){var e=Xi;Xi=function(n){return r(function(){return e(n)})}}function Pn(){return!1}function Th(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var vl="action",Ih="action.bound",yl="autoAction",Mh="autoAction.bound",wl="<unnamed action>",Ji=Jn(vl),Nh=Jn(Ih,{bound:!0}),Yi=Jn(yl,{autoAction:!0}),Lh=Jn(Mh,{autoAction:!0,bound:!0});function xl(r){var e=function(n,i){if(ze(n))return Mt(n.name||wl,n,r);if(ze(i))return Mt(n,i,r);if(Xn(i))return(r?Yi:Ji).decorate_20223_(n,i);if(Tt(i))return Gn(n,i,r?Yi:Ji);if(Tt(n))return Qe(Jn(r?yl:vl,{name:n,autoAction:r}))};return e}var Pe=xl(!1);Object.assign(Pe,Ji);var jn=xl(!0);Object.assign(jn,Yi);Pe.bound=Qe(Nh);jn.bound=Qe(Lh);function Ft(r){return ul(r.name||wl,!1,r,this,void 0)}function Fn(r){return ze(r)&&r.isMobxAction===!0}function Dh(r,e){var t,n,i,s;e===void 0&&(e=_s);var a=(t=(n=e)==null?void 0:n.name)!=null?t:"Autorun",o=!e.scheduler&&!e.delay,l;if(o)l=new tt(a,function(){this.track(h)},e.onError,e.requiresObservable);else{var u=Al(e),c=!1;l=new tt(a,function(){c||(c=!0,u(function(){c=!1,l.isDisposed||l.track(h)}))},e.onError,e.requiresObservable)}function h(){r(l)}return(i=e)!=null&&(i=i.signal)!=null&&i.aborted||l.schedule_(),l.getDisposer_((s=e)==null?void 0:s.signal)}var Bh=function(e){return e()};function Al(r){return r.scheduler?r.scheduler:r.delay?function(e){return setTimeout(e,r.delay)}:Bh}function xs(r,e,t){var n,i,s;t===void 0&&(t=_s);var a=(n=t.name)!=null?n:"Reaction",o=Pe(a,t.onError?jh(t.onError,e):e),l=!t.scheduler&&!t.delay,u=Al(t),c=!0,h=!1,p,v=t.compareStructural?un.structural:t.equals||un.default,y=new tt(a,function(){c||l?w():h||(h=!0,u(w))},t.onError,t.requiresObservable);function w(){if(h=!1,!y.isDisposed){var x=!1,B=p;y.track(function(){var C=xh(!1,function(){return r(y)});x=c||!v(p,C),p=C}),(c&&t.fireImmediately||!c&&x)&&o(p,B,y),c=!1}}return(i=t)!=null&&(i=i.signal)!=null&&i.aborted||y.schedule_(),y.getDisposer_((s=t)==null?void 0:s.signal)}function jh(r,e){return function(){try{return e.apply(this,arguments)}catch(t){r.call(this,t)}}}var Fh="onBO",Uh="onBUO";function zh(r,e,t){return El(Fh,r,e,t)}function Sl(r,e,t){return El(Uh,r,e,t)}function El(r,e,t,n){var i=Zi(e),s=ze(n)?n:t,a=r+"L";return i[a]?i[a].add(s):i[a]=new Set([s]),function(){var o=i[a];o&&(o.delete(s),o.size===0&&delete i[a])}}var Vh="never",mr="always",Hh="observed";function kl(r){r.isolateGlobalState===!0&&Eh();var e=r.useProxies,t=r.enforceActions;if(e!==void 0&&(T.useProxies=e===mr?!0:e===Vh?!1:typeof Proxy<"u"),e==="ifavailable"&&(T.verifyProxies=!0),t!==void 0){var n=t===mr?mr:t===Hh;T.enforceActions=n,T.allowStateChanges=!(n===!0||n===mr)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in r&&(T[i]=!!r[i])}),T.allowStateReads=!T.observableRequiresReaction,r.reactionScheduler&&Ph(r.reactionScheduler)}function Cl(r,e,t,n){var i=Of(e);return Ut(function(){var s=mn(r,n)[j];Bn(i).forEach(function(a){s.extend_(a,i[a],t&&a in t?t[a]:!0)})}),r}var Wh=0;function Ol(){this.message="FLOW_CANCELLED"}Ol.prototype=Object.create(Error.prototype);var Si=nl("flow"),qh=nl("flow.bound",{bound:!0}),cn=Object.assign(function(e,t){if(Xn(t))return Si.decorate_20223_(e,t);if(Tt(t))return Gn(e,t,Si);var n=e,i=n.name||"<unnamed flow>",s=function(){var o=this,l=arguments,u=++Wh,c=Pe(i+" - runid: "+u+" - init",n).apply(o,l),h,p=void 0,v=new Promise(function(y,w){var x=0;h=w;function B(I){p=void 0;var S;try{S=Pe(i+" - runid: "+u+" - yield "+x++,c.next).call(c,I)}catch(P){return w(P)}L(S)}function C(I){p=void 0;var S;try{S=Pe(i+" - runid: "+u+" - yield "+x++,c.throw).call(c,I)}catch(P){return w(P)}L(S)}function L(I){if(ze(I==null?void 0:I.then)){I.then(L,w);return}return I.done?y(I.value):(p=Promise.resolve(I.value),p.then(B,C))}B(void 0)});return v.cancel=Pe(i+" - runid: "+u+" - cancel",function(){try{p&&ja(p);var y=c.return(void 0),w=Promise.resolve(y.value);w.then(Qt,Qt),ja(w),h(new Ol)}catch(x){h(x)}}),v};return s.isMobXFlow=!0,s},Si);cn.bound=Qe(qh);function ja(r){ze(r.cancel)&&r.cancel()}function Un(r){return(r==null?void 0:r.isMobXFlow)===!0}function Kh(r,e){return r?tr(r)||!!r[j]||vs(r)||jr(r)||Yn(r):!1}function As(r){return Kh(r)}function Gh(r){if(tr(r))return r[j].ownKeys_();W(38)}function gr(r,e,t){return r.set(e,t),t}function Xt(r,e){if(r==null||typeof r!="object"||r instanceof Date||!As(r))return r;if(Ah(r)||Yn(r))return Xt(r.get(),e);if(e.has(r))return e.get(r);if(er(r)){var t=gr(e,r,new Array(r.length));return r.forEach(function(a,o){t[o]=Xt(a,e)}),t}if(De(r)){var n=gr(e,r,new Set);return r.forEach(function(a){n.add(Xt(a,e))}),n}if(xt(r)){var i=gr(e,r,new Map);return r.forEach(function(a,o){i.set(o,Xt(a,e))}),i}else{var s=gr(e,r,{});return Gh(r).forEach(function(a){Kn.propertyIsEnumerable.call(r,a)&&(s[a]=Xt(r[a],e))}),s}}function Rl(r,e){return Xt(r,new Map)}function at(r,e){e===void 0&&(e=void 0),Re();try{return r.apply(e)}finally{$e()}}function Wt(r){return r[j]}var Xh={has:function(e,t){return Wt(e).has_(t)},get:function(e,t){return Wt(e).get_(t)},set:function(e,t,n){var i;return Tt(t)?(i=Wt(e).set_(t,n,!0))!=null?i:!0:!1},deleteProperty:function(e,t){var n;return Tt(t)?(n=Wt(e).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(e,t,n){var i;return(i=Wt(e).defineProperty_(t,n))!=null?i:!0},ownKeys:function(e){return Wt(e).ownKeys_()},preventExtensions:function(e){W(13)}};function Jh(r,e){var t,n;return Ko(),r=mn(r,e),(n=(t=r[j]).proxy_)!=null?n:t.proxy_=new Proxy(r,Xh)}function Ce(r){return r.interceptors_!==void 0&&r.interceptors_.length>0}function Zn(r,e){var t=r.interceptors_||(r.interceptors_=[]);return t.push(e),Go(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Oe(r,e){var t=jt();try{for(var n=[].concat(r.interceptors_||[]),i=0,s=n.length;i<s&&(e=n[i](e),e&&!e.type&&W(14),!!e);i++);return e}finally{ot(t)}}function Fe(r){return r.changeListeners_!==void 0&&r.changeListeners_.length>0}function Qn(r,e){var t=r.changeListeners_||(r.changeListeners_=[]);return t.push(e),Go(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Ue(r,e){var t=jt(),n=r.changeListeners_;if(n){n=n.slice();for(var i=0,s=n.length;i<s;i++)n[i](e);ot(t)}}var Ei=Symbol("mobx-keys");function ai(r,e,t){return lt(r)?Cl(r,r,e,t):(Ut(function(){var n=mn(r,t)[j];if(!r[Ei]){var i=Object.getPrototypeOf(r),s=new Set([].concat(Bn(r),Bn(i)));s.delete("constructor"),s.delete(j),ei(i,Ei,s)}r[Ei].forEach(function(a){return n.make_(a,e&&a in e?e[a]:!0)})}),r)}var Fa="splice",et="update",Yh=1e4,Zh={get:function(e,t){var n=e[j];return t===j?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):bt(Fr,t)?Fr[t]:e[t]},set:function(e,t,n){var i=e[j];return t==="length"&&i.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){W(15)}},Ss=function(){function r(t,n,i,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new wt(t),this.enhancer_=function(a,o){return n(a,o,"ObservableArray[..]")}}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return Zn(this,n)},e.observe_=function(n,i){return i===void 0&&(i=!1),i&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Qn(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&W("Out of range: "+n);var i=this.values_.length;if(n!==i)if(n>i){for(var s=new Array(n-i),a=0;a<n-i;a++)s[a]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(n,i-n)},e.updateArrayLength_=function(n,i){n!==this.lastKnownLength_&&W(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&Ll(n+i+1)},e.spliceWithArray_=function(n,i,s){var a=this;this.atom_;var o=this.values_.length;if(n===void 0?n=0:n>o?n=o:n<0&&(n=Math.max(0,o+n)),arguments.length===1?i=o-n:i==null?i=0:i=Math.max(0,Math.min(i,o-n)),s===void 0&&(s=Vi),Ce(this)){var l=Oe(this,{object:this.proxy_,type:Fa,index:n,removedCount:i,added:s});if(!l)return Vi;i=l.removedCount,s=l.added}if(s=s.length===0?s:s.map(function(h){return a.enhancer_(h,void 0)}),this.legacyMode_){var u=s.length-i;this.updateArrayLength_(o,u)}var c=this.spliceItemsIntoValues_(n,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(n,s,c),this.dehanceValues_(c)},e.spliceItemsIntoValues_=function(n,i,s){if(s.length<Yh){var a;return(a=this.values_).splice.apply(a,[n,i].concat(s))}else{var o=this.values_.slice(n,n+i),l=this.values_.slice(n+i);this.values_.length+=s.length-i;for(var u=0;u<s.length;u++)this.values_[n+u]=s[u];for(var c=0;c<l.length;c++)this.values_[n+s.length+c]=l[c];return o}},e.notifyArrayChildUpdate_=function(n,i,s){var a=!this.owned_&&Pn(),o=Fe(this),l=o||a?{observableKind:"array",object:this.proxy_,type:et,debugObjectName:this.atom_.name_,index:n,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),o&&Ue(this,l)},e.notifyArraySplice_=function(n,i,s){var a=!this.owned_&&Pn(),o=Fe(this),l=o||a?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Fa,index:n,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),o&&Ue(this,l)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,i){var s=this.values_;if(this.legacyMode_&&n>s.length&&W(17,n,s.length),n<s.length){this.atom_;var a=s[n];if(Ce(this)){var o=Oe(this,{type:et,object:this.proxy_,index:n,newValue:i});if(!o)return;i=o.newValue}i=this.enhancer_(i,a);var l=i!==a;l&&(s[n]=i,this.notifyArrayChildUpdate_(n,i,a))}else{for(var u=new Array(n+1-s.length),c=0;c<u.length-1;c++)u[c]=void 0;u[u.length-1]=i,this.spliceWithArray_(s.length,0,u)}},r}();function Qh(r,e,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),Ko(),Ut(function(){var i=new Ss(t,e,n,!1);Jo(i.values_,j,i);var s=new Proxy(i.values_,Zh);return i.proxy_=s,r&&r.length&&i.spliceWithArray_(0,0,r),s})}var Fr={clear:function(){return this.splice(0)},replace:function(e){var t=this[j];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var a=this[j];switch(arguments.length){case 0:return[];case 1:return a.spliceWithArray_(e);case 2:return a.spliceWithArray_(e,t)}return a.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[j].spliceWithArray_(e,t,n)},push:function(){for(var e=this[j],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[j].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[j],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return T.trackingDerivation&&W(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){T.trackingDerivation&&W(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[j],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};ne("at",Ee);ne("concat",Ee);ne("flat",Ee);ne("includes",Ee);ne("indexOf",Ee);ne("join",Ee);ne("lastIndexOf",Ee);ne("slice",Ee);ne("toString",Ee);ne("toLocaleString",Ee);ne("toSorted",Ee);ne("toSpliced",Ee);ne("with",Ee);ne("every",He);ne("filter",He);ne("find",He);ne("findIndex",He);ne("findLast",He);ne("findLastIndex",He);ne("flatMap",He);ne("forEach",He);ne("map",He);ne("some",He);ne("toReversed",He);ne("reduce",$l);ne("reduceRight",$l);function ne(r,e){typeof Array.prototype[r]=="function"&&(Fr[r]=e(r))}function Ee(r){return function(){var e=this[j];e.atom_.reportObserved();var t=e.dehanceValues_(e.values_);return t[r].apply(t,arguments)}}function He(r){return function(e,t){var n=this,i=this[j];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[r](function(a,o){return e.call(t,a,o,n)})}}function $l(r){return function(){var e=this,t=this[j];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),i=arguments[0];return arguments[0]=function(s,a,o){return i(s,a,o,e)},n[r].apply(n,arguments)}}var ed=yt("ObservableArrayAdministration",Ss);function er(r){return Qr(r)&&ed(r[j])}var td={},mt="add",Ur="delete",Pl=function(){function r(t,n,i){var s=this;n===void 0&&(n=It),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[j]=td,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=i,ze(Map)||W(18),Ut(function(){s.keysAtom_=el("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var e=r.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var i=this;if(!T.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var a=s=new _t(this.has_(n),ti,"ObservableMap.key?",!1);this.hasMap_.set(n,a),Sl(a,function(){return i.hasMap_.delete(n)})}return s.get()},e.set=function(n,i){var s=this.has_(n);if(Ce(this)){var a=Oe(this,{type:s?et:mt,object:this,newValue:i,name:n});if(!a)return this;i=a.newValue}return s?this.updateValue_(n,i):this.addValue_(n,i),this},e.delete=function(n){var i=this;if(this.keysAtom_,Ce(this)){var s=Oe(this,{type:Ur,object:this,name:n});if(!s)return!1}if(this.has_(n)){var a=Pn(),o=Fe(this),l=o||a?{observableKind:"map",debugObjectName:this.name_,type:Ur,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return at(function(){var u;i.keysAtom_.reportChanged(),(u=i.hasMap_.get(n))==null||u.setNewValue_(!1);var c=i.data_.get(n);c.setNewValue_(void 0),i.data_.delete(n)}),o&&Ue(this,l),!0}return!1},e.updateValue_=function(n,i){var s=this.data_.get(n);if(i=s.prepareNewValue_(i),i!==T.UNCHANGED){var a=Pn(),o=Fe(this),l=o||a?{observableKind:"map",debugObjectName:this.name_,type:et,object:this,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),o&&Ue(this,l)}},e.addValue_=function(n,i){var s=this;this.keysAtom_,at(function(){var u,c=new _t(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,c),i=c.value_,(u=s.hasMap_.get(n))==null||u.setNewValue_(!0),s.keysAtom_.reportChanged()});var a=Pn(),o=Fe(this),l=o||a?{observableKind:"map",debugObjectName:this.name_,type:mt,object:this,name:n,newValue:i}:null;o&&Ue(this,l)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,i=this.keys();return Ua({next:function(){var a=i.next(),o=a.done,l=a.value;return{done:o,value:o?void 0:n.get(l)}}})},e.entries=function(){var n=this,i=this.keys();return Ua({next:function(){var a=i.next(),o=a.done,l=a.value;return{done:o,value:o?void 0:[l,n.get(l)]}}})},e[Symbol.iterator]=function(){return this.entries()},e.forEach=function(n,i){for(var s=en(this),a;!(a=s()).done;){var o=a.value,l=o[0],u=o[1];n.call(i,u,l,this)}},e.merge=function(n){var i=this;return xt(n)&&(n=new Map(n)),at(function(){lt(n)?Cf(n).forEach(function(s){return i.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var a=s[0],o=s[1];return i.set(a,o)}):dn(n)?(kf(n)||W(19,n),n.forEach(function(s,a){return i.set(a,s)})):n!=null&&W(20,n)}),this},e.clear=function(){var n=this;at(function(){fl(function(){for(var i=en(n.keys()),s;!(s=i()).done;){var a=s.value;n.delete(a)}})})},e.replace=function(n){var i=this;return at(function(){for(var s=nd(n),a=new Map,o=!1,l=en(i.data_.keys()),u;!(u=l()).done;){var c=u.value;if(!s.has(c)){var h=i.delete(c);if(h)o=!0;else{var p=i.data_.get(c);a.set(c,p)}}}for(var v=en(s.entries()),y;!(y=v()).done;){var w=y.value,x=w[0],B=w[1],C=i.data_.has(x);if(i.set(x,B),i.data_.has(x)){var L=i.data_.get(x);a.set(x,L),C||(o=!0)}}if(!o)if(i.data_.size!==a.size)i.keysAtom_.reportChanged();else for(var I=i.data_.keys(),S=a.keys(),P=I.next(),E=S.next();!P.done;){if(P.value!==E.value){i.keysAtom_.reportChanged();break}P=I.next(),E=S.next()}i.data_=a}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,i){return Qn(this,n)},e.intercept_=function(n){return Zn(this,n)},pn(r,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),xt=yt("ObservableMap",Pl);function Ua(r){return r[Symbol.toStringTag]="MapIterator",ks(r)}function nd(r){if(dn(r)||xt(r))return r;if(Array.isArray(r))return new Map(r);if(lt(r)){var e=new Map;for(var t in r)e.set(t,r[t]);return e}else return W(21,r)}var rd={},Tl=function(){function r(t,n,i){var s=this;n===void 0&&(n=It),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[j]=rd,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,ze(Set)||W(22),this.enhancer_=function(a,o){return n(a,o,i)},Ut(function(){s.atom_=el(s.name_),t&&s.replace(t)})}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;at(function(){fl(function(){for(var i=en(n.data_.values()),s;!(s=i()).done;){var a=s.value;n.delete(a)}})})},e.forEach=function(n,i){for(var s=en(this),a;!(a=s()).done;){var o=a.value;n.call(i,o,o,this)}},e.add=function(n){var i=this;if(this.atom_,Ce(this)){var s=Oe(this,{type:mt,object:this,newValue:n});if(!s)return this}if(!this.has(n)){at(function(){i.data_.add(i.enhancer_(n,void 0)),i.atom_.reportChanged()});var a=!1,o=Fe(this),l=o||a?{observableKind:"set",debugObjectName:this.name_,type:mt,object:this,newValue:n}:null;o&&Ue(this,l)}return this},e.delete=function(n){var i=this;if(Ce(this)){var s=Oe(this,{type:Ur,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var a=!1,o=Fe(this),l=o||a?{observableKind:"set",debugObjectName:this.name_,type:Ur,object:this,oldValue:n}:null;return at(function(){i.atom_.reportChanged(),i.data_.delete(n)}),o&&Ue(this,l),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=this.values();return za({next:function(){var s=n.next(),a=s.value,o=s.done;return o?{value:void 0,done:o}:{value:[a,a],done:o}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,i=this.data_.values();return za({next:function(){var a=i.next(),o=a.value,l=a.done;return l?{value:void 0,done:l}:{value:n.dehanceValue_(o),done:l}}})},e.intersection=function(n){if(st(n)&&!De(n))return n.intersection(this);var i=new Set(this);return i.intersection(n)},e.union=function(n){if(st(n)&&!De(n))return n.union(this);var i=new Set(this);return i.union(n)},e.difference=function(n){return new Set(this).difference(n)},e.symmetricDifference=function(n){if(st(n)&&!De(n))return n.symmetricDifference(this);var i=new Set(this);return i.symmetricDifference(n)},e.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},e.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},e.isDisjointFrom=function(n){if(st(n)&&!De(n))return n.isDisjointFrom(this);var i=new Set(this);return i.isDisjointFrom(n)},e.replace=function(n){var i=this;return De(n)&&(n=new Set(n)),at(function(){Array.isArray(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):st(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):n!=null&&W("Cannot initialize set from "+n)}),this},e.observe_=function(n,i){return Qn(this,n)},e.intercept_=function(n){return Zn(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Symbol.iterator]=function(){return this.values()},pn(r,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),De=yt("ObservableSet",Tl);function za(r){return r[Symbol.toStringTag]="SetIterator",ks(r)}var Va=Object.create(null),Ha="remove",Il=function(){function r(t,n,i,s){n===void 0&&(n=new Map),s===void 0&&(s=nh),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new wt("ObservableObject.keys"),this.isPlainObject_=lt(this.target_)}var e=r.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,i){var s=this.values_.get(n);if(s instanceof Ve)return s.set(i),!0;if(Ce(this)){var a=Oe(this,{type:et,object:this.proxy_||this.target_,name:n,newValue:i});if(!a)return null;i=a.newValue}if(i=s.prepareNewValue_(i),i!==T.UNCHANGED){var o=Fe(this),l=!1,u=o||l?{type:et,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),o&&Ue(this,u)}return!0},e.get_=function(n){return T.trackingDerivation&&!bt(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,i,s){return s===void 0&&(s=!1),bt(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,i):s?Reflect.set(this.target_,n,i):(this.target_[n]=i,!0):this.extend_(n,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(n){if(!T.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(n);return i||(i=new _t(n in this.target_,ti,"ObservableObject.key?",!1),this.pendingKeys_.set(n,i)),i.get()},e.make_=function(n,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(n in this.target_)){var s;if((s=this.target_[tn])!=null&&s[n])return;W(1,i.annotationType_,this.name_+"."+n.toString())}for(var a=this.target_;a&&a!==Kn;){var o=Nr(a,n);if(o){var l=i.make_(this,n,o,a);if(l===0)return;if(l===1)break}a=Object.getPrototypeOf(a)}qa(this,i,n)}},e.extend_=function(n,i,s,a){if(a===void 0&&(a=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,i,a);var o=s.extend_(this,n,i,a);return o&&qa(this,s,n),o},e.defineProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{Re();var a=this.delete_(n);if(!a)return a;if(Ce(this)){var o=Oe(this,{object:this.proxy_||this.target_,name:n,type:mt,newValue:i.value});if(!o)return null;var l=o.newValue;i.value!==l&&(i=ln({},i,{value:l}))}if(s){if(!Reflect.defineProperty(this.target_,n,i))return!1}else Ze(this.target_,n,i);this.notifyPropertyAddition_(n,i.value)}finally{$e()}return!0},e.defineObservableProperty_=function(n,i,s,a){a===void 0&&(a=!1),this.keysAtom_;try{Re();var o=this.delete_(n);if(!o)return o;if(Ce(this)){var l=Oe(this,{object:this.proxy_||this.target_,name:n,type:mt,newValue:i});if(!l)return null;i=l.newValue}var u=Wa(n),c={configurable:T.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:u.get,set:u.set};if(a){if(!Reflect.defineProperty(this.target_,n,c))return!1}else Ze(this.target_,n,c);var h=new _t(i,s,"ObservableObject.key",!1);this.values_.set(n,h),this.notifyPropertyAddition_(n,h.value_)}finally{$e()}return!0},e.defineComputedProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{Re();var a=this.delete_(n);if(!a)return a;if(Ce(this)){var o=Oe(this,{object:this.proxy_||this.target_,name:n,type:mt,newValue:void 0});if(!o)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var l=Wa(n),u={configurable:T.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(s){if(!Reflect.defineProperty(this.target_,n,u))return!1}else Ze(this.target_,n,u);this.values_.set(n,new Ve(i)),this.notifyPropertyAddition_(n,void 0)}finally{$e()}return!0},e.delete_=function(n,i){if(i===void 0&&(i=!1),this.keysAtom_,!bt(this.target_,n))return!0;if(Ce(this)){var s=Oe(this,{object:this.proxy_||this.target_,name:n,type:Ha});if(!s)return null}try{var a;Re();var o=Fe(this),l=!1,u=this.values_.get(n),c=void 0;if(!u&&(o||l)){var h;c=(h=Nr(this.target_,n))==null?void 0:h.value}if(i){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(u&&(this.values_.delete(n),u instanceof _t&&(c=u.value_),bl(u)),this.keysAtom_.reportChanged(),(a=this.pendingKeys_)==null||(a=a.get(n))==null||a.set(n in this.target_),o||l){var p={type:Ha,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:c,name:n};o&&Ue(this,p)}}finally{$e()}return!0},e.observe_=function(n,i){return Qn(this,n)},e.intercept_=function(n){return Zn(this,n)},e.notifyPropertyAddition_=function(n,i){var s,a=Fe(this),o=!1;if(a||o){var l=a||o?{type:mt,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:i}:null;a&&Ue(this,l)}(s=this.pendingKeys_)==null||(s=s.get(n))==null||s.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),Bn(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},r}();function mn(r,e){var t;if(bt(r,j))return r;var n=(t=e==null?void 0:e.name)!=null?t:"ObservableObject",i=new Il(r,new Map,String(n),dh(e));return ei(r,j,i),r}var id=yt("ObservableObjectAdministration",Il);function Wa(r){return Va[r]||(Va[r]={get:function(){return this[j].getObservablePropValue_(r)},set:function(t){return this[j].setObservablePropValue_(r,t)}})}function tr(r){return Qr(r)?id(r[j]):!1}function qa(r,e,t){var n;(n=r.target_[tn])==null||delete n[t]}var sd=Nl(0),ad=function(){var r=!1,e={};return Object.defineProperty(e,"0",{set:function(){r=!0}}),Object.create(e)[0]=1,r===!1}(),ki=0,Ml=function(){};function od(r,e){Object.setPrototypeOf?Object.setPrototypeOf(r.prototype,e):r.prototype.__proto__!==void 0?r.prototype.__proto__=e:r.prototype=e}od(Ml,Array.prototype);var Es=function(r){function e(n,i,s,a){var o;return s===void 0&&(s="ObservableArray"),a===void 0&&(a=!1),o=r.call(this)||this,Ut(function(){var l=new Ss(s,i,a,!0);l.proxy_=o,Jo(o,j,l),n&&n.length&&o.spliceWithArray(0,0,n),ad&&Object.defineProperty(o,"0",sd)}),o}Qo(e,r);var t=e.prototype;return t.concat=function(){this[j].atom_.reportObserved();for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Array.prototype.concat.apply(this.slice(),s.map(function(o){return er(o)?o.slice():o}))},t[Symbol.iterator]=function(){var n=this,i=0;return ks({next:function(){return i<n.length?{value:n[i++],done:!1}:{done:!0,value:void 0}}})},pn(e,[{key:"length",get:function(){return this[j].getArrayLength_()},set:function(i){this[j].setArrayLength_(i)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(Ml);Object.entries(Fr).forEach(function(r){var e=r[0],t=r[1];e!=="concat"&&ei(Es.prototype,e,t)});function Nl(r){return{enumerable:!1,configurable:!0,get:function(){return this[j].get_(r)},set:function(t){this[j].set_(r,t)}}}function ld(r){Ze(Es.prototype,""+r,Nl(r))}function Ll(r){if(r>ki){for(var e=ki;e<r+100;e++)ld(e);ki=r}}Ll(1e3);function ud(r,e,t){return new Es(r,e,t)}function Zi(r,e){if(typeof r=="object"&&r!==null){if(er(r))return e!==void 0&&W(23),r[j].atom_;if(De(r))return r.atom_;if(xt(r)){if(e===void 0)return r.keysAtom_;var t=r.data_.get(e)||r.hasMap_.get(e);return t||W(25,e,Qi(r)),t}if(tr(r)){if(!e)return W(26);var n=r[j].values_.get(e);return n||W(27,e,Qi(r)),n}if(vs(r)||Yn(r)||jr(r))return r}else if(ze(r)&&jr(r[j]))return r[j];W(28)}function cd(r,e){if(r||W(29),vs(r)||Yn(r)||jr(r)||xt(r)||De(r))return r;if(r[j])return r[j];W(24,r)}function Qi(r,e){var t;if(e!==void 0)t=Zi(r,e);else{if(Fn(r))return r.name;tr(r)||xt(r)||De(r)?t=cd(r):t=Zi(r)}return t.name_}function Ut(r){var e=jt(),t=ii(!0);Re();try{return r()}finally{$e(),si(t),ot(e)}}var Ka=Kn.toString;function Dl(r,e,t){return t===void 0&&(t=-1),es(r,e,t)}function es(r,e,t,n,i){if(r===e)return r!==0||1/r===1/e;if(r==null||e==null)return!1;if(r!==r)return e!==e;var s=typeof r;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var a=Ka.call(r);if(a!==Ka.call(e))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+r==""+e;case"[object Number]":return+r!=+r?+e!=+e:+r==0?1/+r===1/e:+r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":t>=0&&t++;break}r=Ga(r),e=Ga(e);var o=a==="[object Array]";if(!o){if(typeof r!="object"||typeof e!="object")return!1;var l=r.constructor,u=e.constructor;if(l!==u&&!(ze(l)&&l instanceof l&&ze(u)&&u instanceof u)&&"constructor"in r&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],i=i||[];for(var c=n.length;c--;)if(n[c]===r)return i[c]===e;if(n.push(r),i.push(e),o){if(c=r.length,c!==e.length)return!1;for(;c--;)if(!es(r[c],e[c],t-1,n,i))return!1}else{var h=Object.keys(r),p;if(c=h.length,Object.keys(e).length!==c)return!1;for(;c--;)if(p=h[c],!(bt(e,p)&&es(r[p],e[p],t-1,n,i)))return!1}return n.pop(),i.pop(),!0}function Ga(r){return er(r)?r.slice():dn(r)||xt(r)||st(r)||De(r)?Array.from(r.entries()):r}var Xa,fd=((Xa=Zr().Iterator)==null?void 0:Xa.prototype)||{};function ks(r){return r[Symbol.iterator]=hd,Object.assign(Object.create(fd),r)}function hd(){return this}["Symbol","Map","Set"].forEach(function(r){var e=Zr();typeof e[r]>"u"&&W("MobX requires global '"+r+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Th,extras:{getDebugName:Qi},$mobx:j});kl({useProxies:"never"});const se=ai({title:"Untitled Conversation",id:`${new Date().getTime()}`,messages:[]}),Bl=Pe(r=>{se.messages.push({role:"user",content:r})});Pe(r=>{se.messages.push({role:"assistant",content:r})});const dd=Pe(r=>{let e=se.messages[se.messages.length-1];e&&e.role==="assistant"?e.content+=r:se.messages.push({role:"assistant",content:r})});Pe(r=>{se.messages=[{role:"system",content:r},...se.messages.filter(e=>e.role!=="system")]});const jl=Pe(()=>(se.messages=[],se.id=`${new Date().getTime()}`,se.title="Untitled Conversation",console.log(`New chat created with id: ${se.id}`),se.id));var br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function _r(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ci={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var Ja;function md(){return Ja||(Ja=1,function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function a(u,c){if(!i[u]){if(!n[u]){var h=typeof _r=="function"&&_r;if(!c&&h)return h(u,!0);if(o)return o(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var v=i[u]={exports:{}};n[u][0].call(v.exports,function(y){var w=n[u][1][y];return a(w||y)},v,v.exports,t,n,i,s)}return i[u].exports}for(var o=typeof _r=="function"&&_r,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,n,i){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,u=new a(y),c=s.document.createTextNode("");u.observe(c,{characterData:!0}),o=function(){c.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var h=new s.MessageChannel;h.port1.onmessage=y,o=function(){h.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var x=s.document.createElement("script");x.onreadystatechange=function(){y(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},s.document.documentElement.appendChild(x)}:o=function(){setTimeout(y,0)};var p,v=[];function y(){p=!0;for(var x,B,C=v.length;C;){for(B=v,v=[],x=-1;++x<C;)B[x]();C=v.length}p=!1}n.exports=w;function w(x){v.push(x)===1&&!p&&o()}}).call(this,typeof br<"u"?br:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,n,i){var s=t(1);function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];n.exports=h;function h(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,S!==a&&w(this,S)}h.prototype.catch=function(S){return this.then(null,S)},h.prototype.then=function(S,P){if(typeof S!="function"&&this.state===u||typeof P!="function"&&this.state===l)return this;var E=new this.constructor(a);if(this.state!==c){var D=this.state===u?S:P;v(E,D,this.outcome)}else this.queue.push(new p(E,S,P));return E};function p(S,P,E){this.promise=S,typeof P=="function"&&(this.onFulfilled=P,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},p.prototype.otherCallFulfilled=function(S){v(this.promise,this.onFulfilled,S)},p.prototype.callRejected=function(S){o.reject(this.promise,S)},p.prototype.otherCallRejected=function(S){v(this.promise,this.onRejected,S)};function v(S,P,E){s(function(){var D;try{D=P(E)}catch(U){return o.reject(S,U)}D===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,D)})}o.resolve=function(S,P){var E=x(y,P);if(E.status==="error")return o.reject(S,E.value);var D=E.value;if(D)w(S,D);else{S.state=u,S.outcome=P;for(var U=-1,V=S.queue.length;++U<V;)S.queue[U].callFulfilled(P)}return S},o.reject=function(S,P){S.state=l,S.outcome=P;for(var E=-1,D=S.queue.length;++E<D;)S.queue[E].callRejected(P);return S};function y(S){var P=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof P=="function")return function(){P.apply(S,arguments)}}function w(S,P){var E=!1;function D(ue){E||(E=!0,o.reject(S,ue))}function U(ue){E||(E=!0,o.resolve(S,ue))}function V(){P(U,D)}var F=x(V);F.status==="error"&&D(F.value)}function x(S,P){var E={};try{E.value=S(P),E.status="success"}catch(D){E.status="error",E.value=D}return E}h.resolve=B;function B(S){return S instanceof this?S:o.resolve(new this(a),S)}h.reject=C;function C(S){var P=new this(a);return o.reject(P,S)}h.all=L;function L(S){var P=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,D=!1;if(!E)return this.resolve([]);for(var U=new Array(E),V=0,F=-1,ue=new this(a);++F<E;)ye(S[F],F);return ue;function ye(Et,kt){P.resolve(Et).then(pi,function(Vt){D||(D=!0,o.reject(ue,Vt))});function pi(Vt){U[kt]=Vt,++V===E&&!D&&(D=!0,o.resolve(ue,U))}}}h.race=I;function I(S){var P=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,D=!1;if(!E)return this.resolve([]);for(var U=-1,V=new this(a);++U<E;)F(S[U]);return V;function F(ue){P.resolve(ue).then(function(ye){D||(D=!0,o.resolve(V,ye))},function(ye){D||(D=!0,o.reject(V,ye))})}}},{1:1}],3:[function(t,n,i){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof br<"u"?br:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,n,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f};function a(f,m){if(!(f instanceof m))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=o();function u(){try{if(!l||!l.open)return!1;var f=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),m=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!f||m)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c(f,m){f=f||[],m=m||{};try{return new Blob(f,m)}catch(g){if(g.name!=="TypeError")throw g;for(var d=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,b=new d,_=0;_<f.length;_+=1)b.append(f[_]);return b.getBlob(m.type)}}typeof Promise>"u"&&t(3);var h=Promise;function p(f,m){m&&f.then(function(d){m(null,d)},function(d){m(d)})}function v(f,m,d){typeof m=="function"&&f.then(m),typeof d=="function"&&f.catch(d)}function y(f){return typeof f!="string"&&(console.warn(f+" used as a key, but it is not a string."),f=String(f)),f}function w(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var x="local-forage-detect-blob-support",B=void 0,C={},L=Object.prototype.toString,I="readonly",S="readwrite";function P(f){for(var m=f.length,d=new ArrayBuffer(m),b=new Uint8Array(d),_=0;_<m;_++)b[_]=f.charCodeAt(_);return d}function E(f){return new h(function(m){var d=f.transaction(x,S),b=c([""]);d.objectStore(x).put(b,"key"),d.onabort=function(_){_.preventDefault(),_.stopPropagation(),m(!1)},d.oncomplete=function(){var _=navigator.userAgent.match(/Chrome\/(\d+)/),g=navigator.userAgent.match(/Edge\//);m(g||!_||parseInt(_[1],10)>=43)}}).catch(function(){return!1})}function D(f){return typeof B=="boolean"?h.resolve(B):E(f).then(function(m){return B=m,B})}function U(f){var m=C[f.name],d={};d.promise=new h(function(b,_){d.resolve=b,d.reject=_}),m.deferredOperations.push(d),m.dbReady?m.dbReady=m.dbReady.then(function(){return d.promise}):m.dbReady=d.promise}function V(f){var m=C[f.name],d=m.deferredOperations.pop();if(d)return d.resolve(),d.promise}function F(f,m){var d=C[f.name],b=d.deferredOperations.pop();if(b)return b.reject(m),b.promise}function ue(f,m){return new h(function(d,b){if(C[f.name]=C[f.name]||fa(),f.db)if(m)U(f),f.db.close();else return d(f.db);var _=[f.name];m&&_.push(f.version);var g=l.open.apply(l,_);m&&(g.onupgradeneeded=function(A){var k=g.result;try{k.createObjectStore(f.storeName),A.oldVersion<=1&&k.createObjectStore(x)}catch(O){if(O.name==="ConstraintError")console.warn('The database "'+f.name+'" has been upgraded from version '+A.oldVersion+" to version "+A.newVersion+', but the storage "'+f.storeName+'" already exists.');else throw O}}),g.onerror=function(A){A.preventDefault(),b(g.error)},g.onsuccess=function(){var A=g.result;A.onversionchange=function(k){k.target.close()},d(A),V(f)}})}function ye(f){return ue(f,!1)}function Et(f){return ue(f,!0)}function kt(f,m){if(!f.db)return!0;var d=!f.db.objectStoreNames.contains(f.storeName),b=f.version<f.db.version,_=f.version>f.db.version;if(b&&(f.version!==m&&console.warn('The database "'+f.name+`" can't be downgraded from version `+f.db.version+" to version "+f.version+"."),f.version=f.db.version),_||d){if(d){var g=f.db.version+1;g>f.version&&(f.version=g)}return!0}return!1}function pi(f){return new h(function(m,d){var b=new FileReader;b.onerror=d,b.onloadend=function(_){var g=btoa(_.target.result||"");m({__local_forage_encoded_blob:!0,data:g,type:f.type})},b.readAsBinaryString(f)})}function Vt(f){var m=P(atob(f.data));return c([m],{type:f.type})}function ca(f){return f&&f.__local_forage_encoded_blob}function gc(f){var m=this,d=m._initReady().then(function(){var b=C[m._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return v(d,f,f),d}function bc(f){U(f);for(var m=C[f.name],d=m.forages,b=0;b<d.length;b++){var _=d[b];_._dbInfo.db&&(_._dbInfo.db.close(),_._dbInfo.db=null)}return f.db=null,ye(f).then(function(g){return f.db=g,kt(f)?Et(f):g}).then(function(g){f.db=m.db=g;for(var A=0;A<d.length;A++)d[A]._dbInfo.db=g}).catch(function(g){throw F(f,g),g})}function nt(f,m,d,b){b===void 0&&(b=1);try{var _=f.db.transaction(f.storeName,m);d(null,_)}catch(g){if(b>0&&(!f.db||g.name==="InvalidStateError"||g.name==="NotFoundError"))return h.resolve().then(function(){if(!f.db||g.name==="NotFoundError"&&!f.db.objectStoreNames.contains(f.storeName)&&f.version<=f.db.version)return f.db&&(f.version=f.db.version+1),Et(f)}).then(function(){return bc(f).then(function(){nt(f,m,d,b-1)})}).catch(d);d(g)}}function fa(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function _c(f){var m=this,d={db:null};if(f)for(var b in f)d[b]=f[b];var _=C[d.name];_||(_=fa(),C[d.name]=_),_.forages.push(m),m._initReady||(m._initReady=m.ready,m.ready=gc);var g=[];function A(){return h.resolve()}for(var k=0;k<_.forages.length;k++){var O=_.forages[k];O!==m&&g.push(O._initReady().catch(A))}var R=_.forages.slice(0);return h.all(g).then(function(){return d.db=_.db,ye(d)}).then(function($){return d.db=$,kt(d,m._defaultConfig.version)?Et(d):$}).then(function($){d.db=_.db=$,m._dbInfo=d;for(var M=0;M<R.length;M++){var z=R[M];z!==m&&(z._dbInfo.db=d.db,z._dbInfo.version=d.version)}})}function vc(f,m){var d=this;f=y(f);var b=new h(function(_,g){d.ready().then(function(){nt(d._dbInfo,I,function(A,k){if(A)return g(A);try{var O=k.objectStore(d._dbInfo.storeName),R=O.get(f);R.onsuccess=function(){var $=R.result;$===void 0&&($=null),ca($)&&($=Vt($)),_($)},R.onerror=function(){g(R.error)}}catch($){g($)}})}).catch(g)});return p(b,m),b}function yc(f,m){var d=this,b=new h(function(_,g){d.ready().then(function(){nt(d._dbInfo,I,function(A,k){if(A)return g(A);try{var O=k.objectStore(d._dbInfo.storeName),R=O.openCursor(),$=1;R.onsuccess=function(){var M=R.result;if(M){var z=M.value;ca(z)&&(z=Vt(z));var J=f(z,M.key,$++);J!==void 0?_(J):M.continue()}else _()},R.onerror=function(){g(R.error)}}catch(M){g(M)}})}).catch(g)});return p(b,m),b}function wc(f,m,d){var b=this;f=y(f);var _=new h(function(g,A){var k;b.ready().then(function(){return k=b._dbInfo,L.call(m)==="[object Blob]"?D(k.db).then(function(O){return O?m:pi(m)}):m}).then(function(O){nt(b._dbInfo,S,function(R,$){if(R)return A(R);try{var M=$.objectStore(b._dbInfo.storeName);O===null&&(O=void 0);var z=M.put(O,f);$.oncomplete=function(){O===void 0&&(O=null),g(O)},$.onabort=$.onerror=function(){var J=z.error?z.error:z.transaction.error;A(J)}}catch(J){A(J)}})}).catch(A)});return p(_,d),_}function xc(f,m){var d=this;f=y(f);var b=new h(function(_,g){d.ready().then(function(){nt(d._dbInfo,S,function(A,k){if(A)return g(A);try{var O=k.objectStore(d._dbInfo.storeName),R=O.delete(f);k.oncomplete=function(){_()},k.onerror=function(){g(R.error)},k.onabort=function(){var $=R.error?R.error:R.transaction.error;g($)}}catch($){g($)}})}).catch(g)});return p(b,m),b}function Ac(f){var m=this,d=new h(function(b,_){m.ready().then(function(){nt(m._dbInfo,S,function(g,A){if(g)return _(g);try{var k=A.objectStore(m._dbInfo.storeName),O=k.clear();A.oncomplete=function(){b()},A.onabort=A.onerror=function(){var R=O.error?O.error:O.transaction.error;_(R)}}catch(R){_(R)}})}).catch(_)});return p(d,f),d}function Sc(f){var m=this,d=new h(function(b,_){m.ready().then(function(){nt(m._dbInfo,I,function(g,A){if(g)return _(g);try{var k=A.objectStore(m._dbInfo.storeName),O=k.count();O.onsuccess=function(){b(O.result)},O.onerror=function(){_(O.error)}}catch(R){_(R)}})}).catch(_)});return p(d,f),d}function Ec(f,m){var d=this,b=new h(function(_,g){if(f<0){_(null);return}d.ready().then(function(){nt(d._dbInfo,I,function(A,k){if(A)return g(A);try{var O=k.objectStore(d._dbInfo.storeName),R=!1,$=O.openKeyCursor();$.onsuccess=function(){var M=$.result;if(!M){_(null);return}f===0||R?_(M.key):(R=!0,M.advance(f))},$.onerror=function(){g($.error)}}catch(M){g(M)}})}).catch(g)});return p(b,m),b}function kc(f){var m=this,d=new h(function(b,_){m.ready().then(function(){nt(m._dbInfo,I,function(g,A){if(g)return _(g);try{var k=A.objectStore(m._dbInfo.storeName),O=k.openKeyCursor(),R=[];O.onsuccess=function(){var $=O.result;if(!$){b(R);return}R.push($.key),$.continue()},O.onerror=function(){_(O.error)}}catch($){_($)}})}).catch(_)});return p(d,f),d}function Cc(f,m){m=w.apply(this,arguments);var d=this.config();f=typeof f!="function"&&f||{},f.name||(f.name=f.name||d.name,f.storeName=f.storeName||d.storeName);var b=this,_;if(!f.name)_=h.reject("Invalid arguments");else{var g=f.name===d.name&&b._dbInfo.db,A=g?h.resolve(b._dbInfo.db):ye(f).then(function(k){var O=C[f.name],R=O.forages;O.db=k;for(var $=0;$<R.length;$++)R[$]._dbInfo.db=k;return k});f.storeName?_=A.then(function(k){if(k.objectStoreNames.contains(f.storeName)){var O=k.version+1;U(f);var R=C[f.name],$=R.forages;k.close();for(var M=0;M<$.length;M++){var z=$[M];z._dbInfo.db=null,z._dbInfo.version=O}var J=new h(function(Y,ae){var ie=l.open(f.name,O);ie.onerror=function(ke){var yn=ie.result;yn.close(),ae(ke)},ie.onupgradeneeded=function(){var ke=ie.result;ke.deleteObjectStore(f.storeName)},ie.onsuccess=function(){var ke=ie.result;ke.close(),Y(ke)}});return J.then(function(Y){R.db=Y;for(var ae=0;ae<$.length;ae++){var ie=$[ae];ie._dbInfo.db=Y,V(ie._dbInfo)}}).catch(function(Y){throw(F(f,Y)||h.resolve()).catch(function(){}),Y})}}):_=A.then(function(k){U(f);var O=C[f.name],R=O.forages;k.close();for(var $=0;$<R.length;$++){var M=R[$];M._dbInfo.db=null}var z=new h(function(J,Y){var ae=l.deleteDatabase(f.name);ae.onerror=function(){var ie=ae.result;ie&&ie.close(),Y(ae.error)},ae.onblocked=function(){console.warn('dropInstance blocked for database "'+f.name+'" until all open connections are closed')},ae.onsuccess=function(){var ie=ae.result;ie&&ie.close(),J(ie)}});return z.then(function(J){O.db=J;for(var Y=0;Y<R.length;Y++){var ae=R[Y];V(ae._dbInfo)}}).catch(function(J){throw(F(f,J)||h.resolve()).catch(function(){}),J})})}return p(_,m),_}var Oc={_driver:"asyncStorage",_initStorage:_c,_support:u(),iterate:yc,getItem:vc,setItem:wc,removeItem:xc,clear:Ac,length:Sc,key:Ec,keys:kc,dropInstance:Cc};function Rc(){return typeof openDatabase=="function"}var ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$c="~~local_forage_type~",ha=/^~~local_forage_type~([^~]+)~/,fr="__lfsc__:",mi=fr.length,gi="arbf",bi="blob",da="si08",pa="ui08",ma="uic8",ga="si16",ba="si32",_a="ur16",va="ui32",ya="fl32",wa="fl64",xa=mi+gi.length,Aa=Object.prototype.toString;function Sa(f){var m=f.length*.75,d=f.length,b,_=0,g,A,k,O;f[f.length-1]==="="&&(m--,f[f.length-2]==="="&&m--);var R=new ArrayBuffer(m),$=new Uint8Array(R);for(b=0;b<d;b+=4)g=ct.indexOf(f[b]),A=ct.indexOf(f[b+1]),k=ct.indexOf(f[b+2]),O=ct.indexOf(f[b+3]),$[_++]=g<<2|A>>4,$[_++]=(A&15)<<4|k>>2,$[_++]=(k&3)<<6|O&63;return R}function _i(f){var m=new Uint8Array(f),d="",b;for(b=0;b<m.length;b+=3)d+=ct[m[b]>>2],d+=ct[(m[b]&3)<<4|m[b+1]>>4],d+=ct[(m[b+1]&15)<<2|m[b+2]>>6],d+=ct[m[b+2]&63];return m.length%3===2?d=d.substring(0,d.length-1)+"=":m.length%3===1&&(d=d.substring(0,d.length-2)+"=="),d}function Pc(f,m){var d="";if(f&&(d=Aa.call(f)),f&&(d==="[object ArrayBuffer]"||f.buffer&&Aa.call(f.buffer)==="[object ArrayBuffer]")){var b,_=fr;f instanceof ArrayBuffer?(b=f,_+=gi):(b=f.buffer,d==="[object Int8Array]"?_+=da:d==="[object Uint8Array]"?_+=pa:d==="[object Uint8ClampedArray]"?_+=ma:d==="[object Int16Array]"?_+=ga:d==="[object Uint16Array]"?_+=_a:d==="[object Int32Array]"?_+=ba:d==="[object Uint32Array]"?_+=va:d==="[object Float32Array]"?_+=ya:d==="[object Float64Array]"?_+=wa:m(new Error("Failed to get type for BinaryArray"))),m(_+_i(b))}else if(d==="[object Blob]"){var g=new FileReader;g.onload=function(){var A=$c+f.type+"~"+_i(this.result);m(fr+bi+A)},g.readAsArrayBuffer(f)}else try{m(JSON.stringify(f))}catch(A){console.error("Couldn't convert value into a JSON string: ",f),m(null,A)}}function Tc(f){if(f.substring(0,mi)!==fr)return JSON.parse(f);var m=f.substring(xa),d=f.substring(mi,xa),b;if(d===bi&&ha.test(m)){var _=m.match(ha);b=_[1],m=m.substring(_[0].length)}var g=Sa(m);switch(d){case gi:return g;case bi:return c([g],{type:b});case da:return new Int8Array(g);case pa:return new Uint8Array(g);case ma:return new Uint8ClampedArray(g);case ga:return new Int16Array(g);case _a:return new Uint16Array(g);case ba:return new Int32Array(g);case va:return new Uint32Array(g);case ya:return new Float32Array(g);case wa:return new Float64Array(g);default:throw new Error("Unkown type: "+d)}}var vi={serialize:Pc,deserialize:Tc,stringToBuffer:Sa,bufferToString:_i};function Ea(f,m,d,b){f.executeSql("CREATE TABLE IF NOT EXISTS "+m.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],d,b)}function Ic(f){var m=this,d={db:null};if(f)for(var b in f)d[b]=typeof f[b]!="string"?f[b].toString():f[b];var _=new h(function(g,A){try{d.db=openDatabase(d.name,String(d.version),d.description,d.size)}catch(k){return A(k)}d.db.transaction(function(k){Ea(k,d,function(){m._dbInfo=d,g()},function(O,R){A(R)})},A)});return d.serializer=vi,_}function ft(f,m,d,b,_,g){f.executeSql(d,b,_,function(A,k){k.code===k.SYNTAX_ERR?A.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[m.storeName],function(O,R){R.rows.length?g(O,k):Ea(O,m,function(){O.executeSql(d,b,_,g)},g)},g):g(A,k)},g)}function Mc(f,m){var d=this;f=y(f);var b=new h(function(_,g){d.ready().then(function(){var A=d._dbInfo;A.db.transaction(function(k){ft(k,A,"SELECT * FROM "+A.storeName+" WHERE key = ? LIMIT 1",[f],function(O,R){var $=R.rows.length?R.rows.item(0).value:null;$&&($=A.serializer.deserialize($)),_($)},function(O,R){g(R)})})}).catch(g)});return p(b,m),b}function Nc(f,m){var d=this,b=new h(function(_,g){d.ready().then(function(){var A=d._dbInfo;A.db.transaction(function(k){ft(k,A,"SELECT * FROM "+A.storeName,[],function(O,R){for(var $=R.rows,M=$.length,z=0;z<M;z++){var J=$.item(z),Y=J.value;if(Y&&(Y=A.serializer.deserialize(Y)),Y=f(Y,J.key,z+1),Y!==void 0){_(Y);return}}_()},function(O,R){g(R)})})}).catch(g)});return p(b,m),b}function ka(f,m,d,b){var _=this;f=y(f);var g=new h(function(A,k){_.ready().then(function(){m===void 0&&(m=null);var O=m,R=_._dbInfo;R.serializer.serialize(m,function($,M){M?k(M):R.db.transaction(function(z){ft(z,R,"INSERT OR REPLACE INTO "+R.storeName+" (key, value) VALUES (?, ?)",[f,$],function(){A(O)},function(J,Y){k(Y)})},function(z){if(z.code===z.QUOTA_ERR){if(b>0){A(ka.apply(_,[f,O,d,b-1]));return}k(z)}})})}).catch(k)});return p(g,d),g}function Lc(f,m,d){return ka.apply(this,[f,m,d,1])}function Dc(f,m){var d=this;f=y(f);var b=new h(function(_,g){d.ready().then(function(){var A=d._dbInfo;A.db.transaction(function(k){ft(k,A,"DELETE FROM "+A.storeName+" WHERE key = ?",[f],function(){_()},function(O,R){g(R)})})}).catch(g)});return p(b,m),b}function Bc(f){var m=this,d=new h(function(b,_){m.ready().then(function(){var g=m._dbInfo;g.db.transaction(function(A){ft(A,g,"DELETE FROM "+g.storeName,[],function(){b()},function(k,O){_(O)})})}).catch(_)});return p(d,f),d}function jc(f){var m=this,d=new h(function(b,_){m.ready().then(function(){var g=m._dbInfo;g.db.transaction(function(A){ft(A,g,"SELECT COUNT(key) as c FROM "+g.storeName,[],function(k,O){var R=O.rows.item(0).c;b(R)},function(k,O){_(O)})})}).catch(_)});return p(d,f),d}function Fc(f,m){var d=this,b=new h(function(_,g){d.ready().then(function(){var A=d._dbInfo;A.db.transaction(function(k){ft(k,A,"SELECT key FROM "+A.storeName+" WHERE id = ? LIMIT 1",[f+1],function(O,R){var $=R.rows.length?R.rows.item(0).key:null;_($)},function(O,R){g(R)})})}).catch(g)});return p(b,m),b}function Uc(f){var m=this,d=new h(function(b,_){m.ready().then(function(){var g=m._dbInfo;g.db.transaction(function(A){ft(A,g,"SELECT key FROM "+g.storeName,[],function(k,O){for(var R=[],$=0;$<O.rows.length;$++)R.push(O.rows.item($).key);b(R)},function(k,O){_(O)})})}).catch(_)});return p(d,f),d}function zc(f){return new h(function(m,d){f.transaction(function(b){b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(_,g){for(var A=[],k=0;k<g.rows.length;k++)A.push(g.rows.item(k).name);m({db:f,storeNames:A})},function(_,g){d(g)})},function(b){d(b)})})}function Vc(f,m){m=w.apply(this,arguments);var d=this.config();f=typeof f!="function"&&f||{},f.name||(f.name=f.name||d.name,f.storeName=f.storeName||d.storeName);var b=this,_;return f.name?_=new h(function(g){var A;f.name===d.name?A=b._dbInfo.db:A=openDatabase(f.name,"","",0),f.storeName?g({db:A,storeNames:[f.storeName]}):g(zc(A))}).then(function(g){return new h(function(A,k){g.db.transaction(function(O){function R(J){return new h(function(Y,ae){O.executeSql("DROP TABLE IF EXISTS "+J,[],function(){Y()},function(ie,ke){ae(ke)})})}for(var $=[],M=0,z=g.storeNames.length;M<z;M++)$.push(R(g.storeNames[M]));h.all($).then(function(){A()}).catch(function(J){k(J)})},function(O){k(O)})})}):_=h.reject("Invalid arguments"),p(_,m),_}var Hc={_driver:"webSQLStorage",_initStorage:Ic,_support:Rc(),iterate:Nc,getItem:Mc,setItem:Lc,removeItem:Dc,clear:Bc,length:jc,key:Fc,keys:Uc,dropInstance:Vc};function Wc(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ca(f,m){var d=f.name+"/";return f.storeName!==m.storeName&&(d+=f.storeName+"/"),d}function qc(){var f="_localforage_support_test";try{return localStorage.setItem(f,!0),localStorage.removeItem(f),!1}catch{return!0}}function Kc(){return!qc()||localStorage.length>0}function Gc(f){var m=this,d={};if(f)for(var b in f)d[b]=f[b];return d.keyPrefix=Ca(f,m._defaultConfig),Kc()?(m._dbInfo=d,d.serializer=vi,h.resolve()):h.reject()}function Xc(f){var m=this,d=m.ready().then(function(){for(var b=m._dbInfo.keyPrefix,_=localStorage.length-1;_>=0;_--){var g=localStorage.key(_);g.indexOf(b)===0&&localStorage.removeItem(g)}});return p(d,f),d}function Jc(f,m){var d=this;f=y(f);var b=d.ready().then(function(){var _=d._dbInfo,g=localStorage.getItem(_.keyPrefix+f);return g&&(g=_.serializer.deserialize(g)),g});return p(b,m),b}function Yc(f,m){var d=this,b=d.ready().then(function(){for(var _=d._dbInfo,g=_.keyPrefix,A=g.length,k=localStorage.length,O=1,R=0;R<k;R++){var $=localStorage.key(R);if($.indexOf(g)===0){var M=localStorage.getItem($);if(M&&(M=_.serializer.deserialize(M)),M=f(M,$.substring(A),O++),M!==void 0)return M}}});return p(b,m),b}function Zc(f,m){var d=this,b=d.ready().then(function(){var _=d._dbInfo,g;try{g=localStorage.key(f)}catch{g=null}return g&&(g=g.substring(_.keyPrefix.length)),g});return p(b,m),b}function Qc(f){var m=this,d=m.ready().then(function(){for(var b=m._dbInfo,_=localStorage.length,g=[],A=0;A<_;A++){var k=localStorage.key(A);k.indexOf(b.keyPrefix)===0&&g.push(k.substring(b.keyPrefix.length))}return g});return p(d,f),d}function ef(f){var m=this,d=m.keys().then(function(b){return b.length});return p(d,f),d}function tf(f,m){var d=this;f=y(f);var b=d.ready().then(function(){var _=d._dbInfo;localStorage.removeItem(_.keyPrefix+f)});return p(b,m),b}function nf(f,m,d){var b=this;f=y(f);var _=b.ready().then(function(){m===void 0&&(m=null);var g=m;return new h(function(A,k){var O=b._dbInfo;O.serializer.serialize(m,function(R,$){if($)k($);else try{localStorage.setItem(O.keyPrefix+f,R),A(g)}catch(M){(M.name==="QuotaExceededError"||M.name==="NS_ERROR_DOM_QUOTA_REACHED")&&k(M),k(M)}})})});return p(_,d),_}function rf(f,m){if(m=w.apply(this,arguments),f=typeof f!="function"&&f||{},!f.name){var d=this.config();f.name=f.name||d.name,f.storeName=f.storeName||d.storeName}var b=this,_;return f.name?_=new h(function(g){f.storeName?g(Ca(f,b._defaultConfig)):g(f.name+"/")}).then(function(g){for(var A=localStorage.length-1;A>=0;A--){var k=localStorage.key(A);k.indexOf(g)===0&&localStorage.removeItem(k)}}):_=h.reject("Invalid arguments"),p(_,m),_}var sf={_driver:"localStorageWrapper",_initStorage:Gc,_support:Wc(),iterate:Yc,getItem:Jc,setItem:nf,removeItem:tf,clear:Xc,length:ef,key:Zc,keys:Qc,dropInstance:rf},af=function(m,d){return m===d||typeof m=="number"&&typeof d=="number"&&isNaN(m)&&isNaN(d)},of=function(m,d){for(var b=m.length,_=0;_<b;){if(af(m[_],d))return!0;_++}return!1},Oa=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},vn={},Ra={},Ht={INDEXEDDB:Oc,WEBSQL:Hc,LOCALSTORAGE:sf},lf=[Ht.INDEXEDDB._driver,Ht.WEBSQL._driver,Ht.LOCALSTORAGE._driver],hr=["dropInstance"],yi=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(hr),uf={description:"",driver:lf.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function cf(f,m){f[m]=function(){var d=arguments;return f.ready().then(function(){return f[m].apply(f,d)})}}function wi(){for(var f=1;f<arguments.length;f++){var m=arguments[f];if(m)for(var d in m)m.hasOwnProperty(d)&&(Oa(m[d])?arguments[0][d]=m[d].slice():arguments[0][d]=m[d])}return arguments[0]}var ff=function(){function f(m){a(this,f);for(var d in Ht)if(Ht.hasOwnProperty(d)){var b=Ht[d],_=b._driver;this[d]=_,vn[_]||this.defineDriver(b)}this._defaultConfig=wi({},uf),this._config=wi({},this._defaultConfig,m),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return f.prototype.config=function(d){if((typeof d>"u"?"undefined":s(d))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in d){if(b==="storeName"&&(d[b]=d[b].replace(/\W/g,"_")),b==="version"&&typeof d[b]!="number")return new Error("Database version must be a number.");this._config[b]=d[b]}return"driver"in d&&d.driver?this.setDriver(this._config.driver):!0}else return typeof d=="string"?this._config[d]:this._config},f.prototype.defineDriver=function(d,b,_){var g=new h(function(A,k){try{var O=d._driver,R=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!d._driver){k(R);return}for(var $=yi.concat("_initStorage"),M=0,z=$.length;M<z;M++){var J=$[M],Y=!of(hr,J);if((Y||d[J])&&typeof d[J]!="function"){k(R);return}}var ae=function(){for(var yn=function(pf){return function(){var mf=new Error("Method "+pf+" is not implemented by the current driver"),$a=h.reject(mf);return p($a,arguments[arguments.length-1]),$a}},xi=0,df=hr.length;xi<df;xi++){var Ai=hr[xi];d[Ai]||(d[Ai]=yn(Ai))}};ae();var ie=function(yn){vn[O]&&console.info("Redefining LocalForage driver: "+O),vn[O]=d,Ra[O]=yn,A()};"_support"in d?d._support&&typeof d._support=="function"?d._support().then(ie,k):ie(!!d._support):ie(!0)}catch(ke){k(ke)}});return v(g,b,_),g},f.prototype.driver=function(){return this._driver||null},f.prototype.getDriver=function(d,b,_){var g=vn[d]?h.resolve(vn[d]):h.reject(new Error("Driver not found."));return v(g,b,_),g},f.prototype.getSerializer=function(d){var b=h.resolve(vi);return v(b,d),b},f.prototype.ready=function(d){var b=this,_=b._driverSet.then(function(){return b._ready===null&&(b._ready=b._initDriver()),b._ready});return v(_,d,d),_},f.prototype.setDriver=function(d,b,_){var g=this;Oa(d)||(d=[d]);var A=this._getSupportedDrivers(d);function k(){g._config.driver=g.driver()}function O(M){return g._extend(M),k(),g._ready=g._initStorage(g._config),g._ready}function R(M){return function(){var z=0;function J(){for(;z<M.length;){var Y=M[z];return z++,g._dbInfo=null,g._ready=null,g.getDriver(Y).then(O).catch(J)}k();var ae=new Error("No available storage method found.");return g._driverSet=h.reject(ae),g._driverSet}return J()}}var $=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=$.then(function(){var M=A[0];return g._dbInfo=null,g._ready=null,g.getDriver(M).then(function(z){g._driver=z._driver,k(),g._wrapLibraryMethodsWithReady(),g._initDriver=R(A)})}).catch(function(){k();var M=new Error("No available storage method found.");return g._driverSet=h.reject(M),g._driverSet}),v(this._driverSet,b,_),this._driverSet},f.prototype.supports=function(d){return!!Ra[d]},f.prototype._extend=function(d){wi(this,d)},f.prototype._getSupportedDrivers=function(d){for(var b=[],_=0,g=d.length;_<g;_++){var A=d[_];this.supports(A)&&b.push(A)}return b},f.prototype._wrapLibraryMethodsWithReady=function(){for(var d=0,b=yi.length;d<b;d++)cf(this,yi[d])},f.prototype.createInstance=function(d){return new f(d)},f}(),hf=new ff;n.exports=hf},{3:3}]},{},[4])(4)})}(Ci)),Ci.exports}var gd=md();const bd=pd(gd),At=bd.createInstance({name:"remembrain"}),Cs="history",gt=ai({chats:[]});xs(()=>gt.chats.length,()=>{At.setItem(Cs,Rl(gt.chats))});At.getItem(Cs).then(r=>{r&&Ft(()=>{gt.chats=r})});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Or=globalThis,Os=Or.ShadowRoot&&(Or.ShadyCSS===void 0||Or.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Fl=Symbol(),Ya=new WeakMap;let _d=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==Fl)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Os&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=Ya.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Ya.set(t,e))}return e}toString(){return this.cssText}};const vd=r=>new _d(typeof r=="string"?r:r+"",void 0,Fl),yd=(r,e)=>{if(Os)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),i=Or.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=t.cssText,r.appendChild(n)}},Za=Os?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return vd(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:wd,defineProperty:xd,getOwnPropertyDescriptor:Ad,getOwnPropertyNames:Sd,getOwnPropertySymbols:Ed,getPrototypeOf:kd}=Object,vt=globalThis,Qa=vt.trustedTypes,Cd=Qa?Qa.emptyScript:"",Oi=vt.reactiveElementPolyfillSupport,Tn=(r,e)=>r,zr={toAttribute(r,e){switch(e){case Boolean:r=r?Cd:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},Rs=(r,e)=>!wd(r,e),eo={attribute:!0,type:String,converter:zr,reflect:!1,hasChanged:Rs};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),vt.litPropertyMetadata??(vt.litPropertyMetadata=new WeakMap);class Jt extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=eo){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);i!==void 0&&xd(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:s}=Ad(this.prototype,e)??{get(){return this[t]},set(a){this[t]=a}};return{get(){return i==null?void 0:i.call(this)},set(a){const o=i==null?void 0:i.call(this);s.call(this,a),this.requestUpdate(e,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??eo}static _$Ei(){if(this.hasOwnProperty(Tn("elementProperties")))return;const e=kd(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Tn("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Tn("properties"))){const t=this.properties,n=[...Sd(t),...Ed(t)];for(const i of n)this.createProperty(i,t[i])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,i]of t)this.elementProperties.set(n,i)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const i=this._$Eu(t,n);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const i of n)t.unshift(Za(i))}else e!==void 0&&t.push(Za(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return yd(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EC(e,t){var s;const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(i!==void 0&&n.reflect===!0){const a=(((s=n.converter)==null?void 0:s.toAttribute)!==void 0?n.converter:zr).toAttribute(t,n.type);this._$Em=e,a==null?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){var s;const n=this.constructor,i=n._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const a=n.getPropertyOptions(i),o=typeof a.converter=="function"?{fromAttribute:a.converter}:((s=a.converter)==null?void 0:s.fromAttribute)!==void 0?a.converter:zr;this._$Em=i,this[i]=o.fromAttribute(t,a.type),this._$Em=null}}requestUpdate(e,t,n){if(e!==void 0){if(n??(n=this.constructor.getPropertyOptions(e)),!(n.hasChanged??Rs)(this[e],t))return;this.P(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,n){this._$AL.has(e)||this._$AL.set(e,t),n.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[s,a]of this._$Ep)this[s]=a;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,a]of i)a.wrapped!==!0||this._$AL.has(s)||this[s]===void 0||this.P(s,this[s],a)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$EO)==null||n.forEach(i=>{var s;return(s=i.hostUpdate)==null?void 0:s.call(i)}),this.update(t)):this._$EU()}catch(i){throw e=!1,this._$EU(),i}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(n=>{var i;return(i=n.hostUpdated)==null?void 0:i.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}}Jt.elementStyles=[],Jt.shadowRootOptions={mode:"open"},Jt[Tn("elementProperties")]=new Map,Jt[Tn("finalized")]=new Map,Oi==null||Oi({ReactiveElement:Jt}),(vt.reactiveElementVersions??(vt.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const In=globalThis,Vr=In.trustedTypes,to=Vr?Vr.createPolicy("lit-html",{createHTML:r=>r}):void 0,Ul="$lit$",dt=`lit$${Math.random().toFixed(9).slice(2)}$`,zl="?"+dt,Od=`<${zl}>`,Nt=document,zn=()=>Nt.createComment(""),Vn=r=>r===null||typeof r!="object"&&typeof r!="function",$s=Array.isArray,Rd=r=>$s(r)||typeof(r==null?void 0:r[Symbol.iterator])=="function",Ri=`[ 	
\f\r]`,wn=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,no=/-->/g,ro=/>/g,Ct=RegExp(`>|${Ri}(?:([^\\s"'>=/]+)(${Ri}*=${Ri}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),io=/'/g,so=/"/g,Vl=/^(?:script|style|textarea|title)$/i,$d=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),G=$d(1),Lt=Symbol.for("lit-noChange"),oe=Symbol.for("lit-nothing"),ao=new WeakMap,Rt=Nt.createTreeWalker(Nt,129);function Hl(r,e){if(!$s(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return to!==void 0?to.createHTML(e):e}const Pd=(r,e)=>{const t=r.length-1,n=[];let i,s=e===2?"<svg>":e===3?"<math>":"",a=wn;for(let o=0;o<t;o++){const l=r[o];let u,c,h=-1,p=0;for(;p<l.length&&(a.lastIndex=p,c=a.exec(l),c!==null);)p=a.lastIndex,a===wn?c[1]==="!--"?a=no:c[1]!==void 0?a=ro:c[2]!==void 0?(Vl.test(c[2])&&(i=RegExp("</"+c[2],"g")),a=Ct):c[3]!==void 0&&(a=Ct):a===Ct?c[0]===">"?(a=i??wn,h=-1):c[1]===void 0?h=-2:(h=a.lastIndex-c[2].length,u=c[1],a=c[3]===void 0?Ct:c[3]==='"'?so:io):a===so||a===io?a=Ct:a===no||a===ro?a=wn:(a=Ct,i=void 0);const v=a===Ct&&r[o+1].startsWith("/>")?" ":"";s+=a===wn?l+Od:h>=0?(n.push(u),l.slice(0,h)+Ul+l.slice(h)+dt+v):l+dt+(h===-2?o:v)}return[Hl(r,s+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Hn{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let s=0,a=0;const o=e.length-1,l=this.parts,[u,c]=Pd(e,t);if(this.el=Hn.createElement(u,n),Rt.currentNode=this.el.content,t===2||t===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=Rt.nextNode())!==null&&l.length<o;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(Ul)){const p=c[a++],v=i.getAttribute(h).split(dt),y=/([.?@])?(.*)/.exec(p);l.push({type:1,index:s,name:y[2],strings:v,ctor:y[1]==="."?Id:y[1]==="?"?Md:y[1]==="@"?Nd:oi}),i.removeAttribute(h)}else h.startsWith(dt)&&(l.push({type:6,index:s}),i.removeAttribute(h));if(Vl.test(i.tagName)){const h=i.textContent.split(dt),p=h.length-1;if(p>0){i.textContent=Vr?Vr.emptyScript:"";for(let v=0;v<p;v++)i.append(h[v],zn()),Rt.nextNode(),l.push({type:2,index:++s});i.append(h[p],zn())}}}else if(i.nodeType===8)if(i.data===zl)l.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(dt,h+1))!==-1;)l.push({type:7,index:s}),h+=dt.length-1}s++}}static createElement(e,t){const n=Nt.createElement("template");return n.innerHTML=e,n}}function fn(r,e,t=r,n){var a,o;if(e===Lt)return e;let i=n!==void 0?(a=t._$Co)==null?void 0:a[n]:t._$Cl;const s=Vn(e)?void 0:e._$litDirective$;return(i==null?void 0:i.constructor)!==s&&((o=i==null?void 0:i._$AO)==null||o.call(i,!1),s===void 0?i=void 0:(i=new s(r),i._$AT(r,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=i:t._$Cl=i),i!==void 0&&(e=fn(r,i._$AS(r,e.values),i,n)),e}class Td{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=((e==null?void 0:e.creationScope)??Nt).importNode(t,!0);Rt.currentNode=i;let s=Rt.nextNode(),a=0,o=0,l=n[0];for(;l!==void 0;){if(a===l.index){let u;l.type===2?u=new nr(s,s.nextSibling,this,e):l.type===1?u=new l.ctor(s,l.name,l.strings,this,e):l.type===6&&(u=new Ld(s,this,e)),this._$AV.push(u),l=n[++o]}a!==(l==null?void 0:l.index)&&(s=Rt.nextNode(),a++)}return Rt.currentNode=Nt,i}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class nr{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=oe,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=(i==null?void 0:i.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=fn(this,e,t),Vn(e)?e===oe||e==null||e===""?(this._$AH!==oe&&this._$AR(),this._$AH=oe):e!==this._$AH&&e!==Lt&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Rd(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==oe&&Vn(this._$AH)?this._$AA.nextSibling.data=e:this.T(Nt.createTextNode(e)),this._$AH=e}$(e){var s;const{values:t,_$litType$:n}=e,i=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Hn.createElement(Hl(n.h,n.h[0]),this.options)),n);if(((s=this._$AH)==null?void 0:s._$AD)===i)this._$AH.p(t);else{const a=new Td(i,this),o=a.u(this.options);a.p(t),this.T(o),this._$AH=a}}_$AC(e){let t=ao.get(e.strings);return t===void 0&&ao.set(e.strings,t=new Hn(e)),t}k(e){$s(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const s of e)i===t.length?t.push(n=new nr(this.O(zn()),this.O(zn()),this,this.options)):n=t[i],n._$AI(s),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class oi{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,s){this.type=1,this._$AH=oe,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=oe}_$AI(e,t=this,n,i){const s=this.strings;let a=!1;if(s===void 0)e=fn(this,e,t,0),a=!Vn(e)||e!==this._$AH&&e!==Lt,a&&(this._$AH=e);else{const o=e;let l,u;for(e=s[0],l=0;l<s.length-1;l++)u=fn(this,o[n+l],t,l),u===Lt&&(u=this._$AH[l]),a||(a=!Vn(u)||u!==this._$AH[l]),u===oe?e=oe:e!==oe&&(e+=(u??"")+s[l+1]),this._$AH[l]=u}a&&!i&&this.j(e)}j(e){e===oe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Id extends oi{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===oe?void 0:e}}class Md extends oi{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==oe)}}class Nd extends oi{constructor(e,t,n,i,s){super(e,t,n,i,s),this.type=5}_$AI(e,t=this){if((e=fn(this,e,t,0)??oe)===Lt)return;const n=this._$AH,i=e===oe&&n!==oe||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,s=e!==oe&&(n===oe||i);i&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class Ld{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){fn(this,e)}}const $i=In.litHtmlPolyfillSupport;$i==null||$i(Hn,nr),(In.litHtmlVersions??(In.litHtmlVersions=[])).push("3.2.1");const Dd=(r,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let i=n._$litPart$;if(i===void 0){const s=(t==null?void 0:t.renderBefore)??null;n._$litPart$=i=new nr(e.insertBefore(zn(),s),s,void 0,t??{})}return i._$AI(r),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let le=class extends Jt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Dd(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Lt}};var Vo;le._$litElement$=!0,le.finalized=!0,(Vo=globalThis.litElementHydrateSupport)==null||Vo.call(globalThis,{LitElement:le});const Pi=globalThis.litElementPolyfillSupport;Pi==null||Pi({LitElement:le});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");let Bd=class extends le{constructor(){super(...arguments),this.router=new xf(this,[{path:"/",render:()=>G`<x-homepage></x-homepage>`},{path:"/chat",render:()=>{const e=jl();return history.pushState({},"",`/chat/${e}`),G`<x-chat></x-chat>`}},{path:"/chat/:id?",enter:async({id:e})=>{const n=(await At.getItem(Cs)).find(i=>i.id===e);return se.id=e,se.title=(n==null?void 0:n.title)??"Untitled Conversation",se.messages=(n==null?void 0:n.messages)??[],!0},render:({id:e})=>G`<x-chat></x-chat>`},{path:"/settings",render:()=>G`<x-settings-general></x-settings-general>`},{path:"/settings/integrations",render:()=>G`<x-settings-integrations></x-settings-integrations>`},{path:"/knowledgebase",enter:async()=>(await Ho(()=>import("./x-knowledgebase-CY8J5oDz.js"),[]),!0),render:()=>G`<x-knowledgebase></x-knowledgebase>`}])}createRenderRoot(){return this}render(){return G` <div class="h-dvh flex flex-col">
      <!-- Navbar -->
      <x-navbar></x-navbar>
      <div class="flex-1 flex flex-row  overflow-hidden">
        <!-- Left Sidebar -->
        <input type="checkbox" id="drawer-toggle" class="hidden peer/sidebar" />
        <x-sidebar
          class="w-[35%] md:w-[30%] lg:w-[25%] peer-checked/sidebar:w-0 transition-all"
        ></x-sidebar>
        <!-- Router area -->
        <div class="flex flex-1 *:w-full overflow-y-scroll">
          ${this.router.outlet()}
        </div>
      </div>
    </div>`}};customElements.define("x-router",Bd);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jd={CHILD:2},Fd=r=>(...e)=>({_$litDirective$:r,values:e});class Ud{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class ts extends Ud{constructor(e){if(super(e),this.it=oe,e.type!==jd.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===oe||e==null)return this._t=void 0,this.it=e;if(e===Lt)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.it)return this._t;this.it=e;const t=[e];return t.raw=t,this._t={_$litType$:this.constructor.resultType,strings:t,values:[]}}}ts.directiveName="unsafeHTML",ts.resultType=1;const zd=Fd(ts);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const We=r=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(r,e)}):customElements.define(r,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Vd={attribute:!0,type:String,converter:zr,reflect:!1,hasChanged:Rs},Hd=(r=Vd,e,t)=>{const{kind:n,metadata:i}=t;let s=globalThis.litPropertyMetadata.get(i);if(s===void 0&&globalThis.litPropertyMetadata.set(i,s=new Map),s.set(t.name,r),n==="accessor"){const{name:a}=t;return{set(o){const l=e.get.call(this);e.set.call(this,o),this.requestUpdate(a,l,r)},init(o){return o!==void 0&&this.P(a,void 0,r),o}}}if(n==="setter"){const{name:a}=t;return function(o){const l=this[a];e.call(this,o),this.requestUpdate(a,l,r)}}throw Error("Unsupported decorator location: "+n)};function rr(r){return(e,t)=>typeof t=="object"?Hd(r,e,t):((n,i,s)=>{const a=i.hasOwnProperty(s);return i.constructor.createProperty(s,a?{...n,wrapped:!0}:n),a?Object.getOwnPropertyDescriptor(i,s):void 0})(r,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Wl(r){return rr({...r,state:!0,attribute:!1})}const ns="RFC3986",rs={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},Wd="RFC1738",qd=Array.isArray,Ke=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),Ti=1024,Kd=(r,e,t,n,i)=>{if(r.length===0)return r;let s=r;if(typeof r=="symbol"?s=Symbol.prototype.toString.call(r):typeof r!="string"&&(s=String(r)),t==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<s.length;o+=Ti){const l=s.length>=Ti?s.slice(o,o+Ti):s,u=[];for(let c=0;c<l.length;++c){let h=l.charCodeAt(c);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||i===Wd&&(h===40||h===41)){u[u.length]=l.charAt(c);continue}if(h<128){u[u.length]=Ke[h];continue}if(h<2048){u[u.length]=Ke[192|h>>6]+Ke[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Ke[224|h>>12]+Ke[128|h>>6&63]+Ke[128|h&63];continue}c+=1,h=65536+((h&1023)<<10|l.charCodeAt(c)&1023),u[u.length]=Ke[240|h>>18]+Ke[128|h>>12&63]+Ke[128|h>>6&63]+Ke[128|h&63]}a+=u.join("")}return a};function Gd(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function oo(r,e){if(qd(r)){const t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}const Xd=Object.prototype.hasOwnProperty,ql={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Xe=Array.isArray,Jd=Array.prototype.push,Kl=function(r,e){Jd.apply(r,Xe(e)?e:[e])},Yd=Date.prototype.toISOString,fe={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Kd,encodeValuesOnly:!1,format:ns,formatter:rs[ns],indices:!1,serializeDate(r){return Yd.call(r)},skipNulls:!1,strictNullHandling:!1};function Zd(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const Ii={};function Gl(r,e,t,n,i,s,a,o,l,u,c,h,p,v,y,w,x,B){let C=r,L=B,I=0,S=!1;for(;(L=L.get(Ii))!==void 0&&!S;){const V=L.get(r);if(I+=1,typeof V<"u"){if(V===I)throw new RangeError("Cyclic object value");S=!0}typeof L.get(Ii)>"u"&&(I=0)}if(typeof u=="function"?C=u(e,C):C instanceof Date?C=p==null?void 0:p(C):t==="comma"&&Xe(C)&&(C=oo(C,function(V){return V instanceof Date?p==null?void 0:p(V):V})),C===null){if(s)return l&&!w?l(e,fe.encoder,x,"key",v):e;C=""}if(Zd(C)||Gd(C)){if(l){const V=w?e:l(e,fe.encoder,x,"key",v);return[(y==null?void 0:y(V))+"="+(y==null?void 0:y(l(C,fe.encoder,x,"value",v)))]}return[(y==null?void 0:y(e))+"="+(y==null?void 0:y(String(C)))]}const P=[];if(typeof C>"u")return P;let E;if(t==="comma"&&Xe(C))w&&l&&(C=oo(C,l)),E=[{value:C.length>0?C.join(",")||null:void 0}];else if(Xe(u))E=u;else{const V=Object.keys(C);E=c?V.sort(c):V}const D=o?String(e).replace(/\./g,"%2E"):String(e),U=n&&Xe(C)&&C.length===1?D+"[]":D;if(i&&Xe(C)&&C.length===0)return U+"[]";for(let V=0;V<E.length;++V){const F=E[V],ue=typeof F=="object"&&typeof F.value<"u"?F.value:C[F];if(a&&ue===null)continue;const ye=h&&o?F.replace(/\./g,"%2E"):F,Et=Xe(C)?typeof t=="function"?t(U,ye):U:U+(h?"."+ye:"["+ye+"]");B.set(r,I);const kt=new WeakMap;kt.set(Ii,B),Kl(P,Gl(ue,Et,t,n,i,s,a,o,t==="comma"&&w&&Xe(C)?null:l,u,c,h,p,v,y,w,x,kt))}return P}function Qd(r=fe){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||fe.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=ns;if(typeof r.format<"u"){if(!Xd.call(rs,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const n=rs[t];let i=fe.filter;(typeof r.filter=="function"||Xe(r.filter))&&(i=r.filter);let s;if(r.arrayFormat&&r.arrayFormat in ql?s=r.arrayFormat:"indices"in r?s=r.indices?"indices":"repeat":s=fe.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:fe.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:fe.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:fe.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:fe.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?fe.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:fe.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:fe.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:fe.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:fe.encodeValuesOnly,filter:i,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:fe.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:fe.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:fe.strictNullHandling}}function ep(r,e={}){let t=r;const n=Qd(e);let i,s;typeof n.filter=="function"?(s=n.filter,t=s("",t)):Xe(n.filter)&&(s=n.filter,i=s);const a=[];if(typeof t!="object"||t===null)return"";const o=ql[n.arrayFormat],l=o==="comma"&&n.commaRoundTrip;i||(i=Object.keys(t)),n.sort&&i.sort(n.sort);const u=new WeakMap;for(let p=0;p<i.length;++p){const v=i[p];n.skipNulls&&t[v]===null||Kl(a,Gl(t[v],v,o,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}const c=a.join(n.delimiter);let h=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),c.length>0?h+c:""}const Yt="4.82.0";let lo=!1,Mn,Xl,Jl,is,Yl,Zl,Ql,eu,tu;function tp(r,e={auto:!1}){if(lo)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(Mn)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${Mn}'\``);lo=e.auto,Mn=r.kind,Xl=r.fetch,Jl=r.FormData,is=r.File,Yl=r.ReadableStream,Zl=r.getMultipartRequestOptions,Ql=r.getDefaultAgent,eu=r.fileFromPath,tu=r.isFsReadStream}class np{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function rp({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,i,s;try{t=fetch,n=Request,i=Response,s=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new np(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Mn||tp(rp(),{auto:!0});class H extends Error{}class me extends H{constructor(e,t,n,i){super(`${me.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["x-request-id"],this.error=t;const s=t;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,t,n){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new li({message:n,cause:as(t)});const s=t==null?void 0:t.error;return e===400?new nu(e,s,n,i):e===401?new ru(e,s,n,i):e===403?new iu(e,s,n,i):e===404?new su(e,s,n,i):e===409?new au(e,s,n,i):e===422?new ou(e,s,n,i):e===429?new lu(e,s,n,i):e>=500?new uu(e,s,n,i):new me(e,s,n,i)}}class Be extends me{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class li extends me{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ps extends li{constructor({message:e}={}){super({message:e??"Request timed out."})}}class nu extends me{}class ru extends me{}class iu extends me{}class su extends me{}class au extends me{}class ou extends me{}class lu extends me{}class uu extends me{}class cu extends H{constructor(){super("Could not parse response content as the length limit was reached")}}class fu extends H{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Dt{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=Dt.NEWLINE_CHARS.has(t[t.length-1]||"");let i=t.split(Dt.NEWLINE_REGEXP);return n&&i.pop(),i.length===1&&!n?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),n||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new H(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new H(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new H("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Dt.NEWLINE_CHARS=new Set([`
`,"\r"]);Dt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function hu(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Ye{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const a of ip(e,t))if(!s){if(a.data.startsWith("[DONE]")){s=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new me(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new me(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}s=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{s||t.abort()}}return new Ye(i,t)}static fromReadableStream(e,t){let n=!1;async function*i(){const a=new Dt,o=hu(e);for await(const l of o)for(const u of a.decode(l))yield u;for(const l of a.flush())yield l}async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of i())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new Ye(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=s=>({next:()=>{if(s.length===0){const a=n.next();e.push(a),t.push(a)}return s.shift()}});return[new Ye(()=>i(e),this.controller),new Ye(()=>i(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Yl({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await t.next();if(a)return i.close();const o=n.encode(JSON.stringify(s)+`
`);i.enqueue(o)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)==null?void 0:i.call(t))}})}}async function*ip(r,e){if(!r.body)throw e.abort(),new H("Attempted to iterate over a response with no body");const t=new op,n=new Dt,i=hu(r.body);for await(const s of sp(i))for(const a of n.decode(s)){const o=t.decode(a);o&&(yield o)}for(const s of n.flush()){const a=t.decode(s);a&&(yield a)}}async function*sp(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let s;for(;(s=ap(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}function ap(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class op{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=lp(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function lp(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}const du=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",pu=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&ui(r),ui=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",up=r=>pu(r)||du(r)||tu(r);async function mu(r,e,t){var i;if(r=await r,pu(r))return r;if(du(r)){const s=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=ui(s)?[await s.arrayBuffer()]:[s];return new is(a,e,t)}const n=await cp(r);if(e||(e=hp(r)??"unknown_file"),!(t!=null&&t.type)){const s=(i=n[0])==null?void 0:i.type;typeof s=="string"&&(t={...t,type:s})}return new is(n,e,t)}async function cp(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(ui(r))e.push(await r.arrayBuffer());else if(dp(r))for await(const n of r)e.push(n);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t=r==null?void 0:r.constructor)==null?void 0:t.name}; props: ${fp(r)}`);return e}function fp(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function hp(r){var e;return Mi(r.name)||Mi(r.filename)||((e=Mi(r.path))==null?void 0:e.split(/[\\/]/).pop())}const Mi=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},dp=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",uo=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",hn=async r=>{const e=await pp(r.body);return Zl(e,r)},pp=async r=>{const e=new Jl;return await Promise.all(Object.entries(r||{}).map(([t,n])=>ss(e,t,n))),e},ss=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(up(t)){const n=await mu(t);r.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>ss(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,i])=>ss(r,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var rn={},mp=function(r,e,t,n,i){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},gp=function(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},vr;async function gu(r){const{response:e}=r;if(r.options.stream)return sn("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):Ye.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const s=await e.json();return sn("response",e.status,e.url,e.headers,s),bu(s,e)}const i=await e.text();return sn("response",e.status,e.url,e.headers,i),i}function bu(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class ci extends Promise{constructor(e,t=gu){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ci(this.responsePromise,async t=>bu(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class bp{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=Ni("maxRetries",t),this.timeout=Ni("timeout",n),this.httpAgent=i,this.fetch=s??Xl}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ap(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Cp()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async i=>{const s=i&&ui(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:t,...i,body:s}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var w;const{method:n,path:i,query:s,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:uo(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),u=this.buildURL(i,s);"timeout"in e&&Ni("timeout",e.timeout);const c=e.timeout??this.timeout,h=e.httpAgent??this.httpAgent??Ql(u),p=c+1e3;typeof((w=h==null?void 0:h.options)==null?void 0:w.timeout)=="number"&&p>(h.options.timeout??0)&&(h.options.timeout=p),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const v=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:n,...o&&{body:o},headers:v,...h&&{agent:h},signal:e.signal??null},url:u,timeout:c}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:i}){const s={};n&&(s["content-length"]=n);const a=this.defaultHeaders(e);return po(s,a),po(s,t),uo(e.body)&&Mn!=="node"&&delete s["content-type"],go(a,"x-stainless-retry-count")===void 0&&go(t,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(i)),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,i){return me.generate(e,t,n,i)}request(e,t=null){return new ci(this.makeRequest(e,t))}async makeRequest(e,t){var h,p;const n=await e,i=n.maxRetries??this.maxRetries;t==null&&(t=i),await this.prepareOptions(n);const{req:s,url:a,timeout:o}=this.buildRequest(n,{retryCount:i-t});if(await this.prepareRequest(s,{url:a,options:n}),sn("request",a,n,s.headers),(h=n.signal)!=null&&h.aborted)throw new Be;const l=new AbortController,u=await this.fetchWithTimeout(a,s,o,l).catch(as);if(u instanceof Error){if((p=n.signal)!=null&&p.aborted)throw new Be;if(t)return this.retryRequest(n,t);throw u.name==="AbortError"?new Ps:new li({cause:u})}const c=vp(u.headers);if(!u.ok){if(t&&this.shouldRetry(u)){const C=`retrying, ${t} attempts remaining`;return sn(`response (error; ${C})`,u.status,a,c),this.retryRequest(n,t,c)}const v=await u.text().catch(C=>as(C).message),y=Sp(v),w=y?void 0:v;throw sn(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,u.status,a,c,w),this.makeStatusError(u.status,y,w,c)}return{response:u,options:n,controller:l}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new _p(this,n,e)}buildURL(e,t){const n=kp(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return vu(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new H(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,i){const{signal:s,...a}=t||{};s&&s.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),n),l={signal:i.signal,...a};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let i;const s=n==null?void 0:n["retry-after-ms"];if(s){const o=parseFloat(s);Number.isNaN(o)||(i=o)}const a=n==null?void 0:n["retry-after"];if(a&&!i){const o=parseFloat(a);Number.isNaN(o)?i=Date.parse(a)-Date.now():i=o*1e3}if(!(i&&0<=i&&i<60*1e3)){const o=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,o)}return await ir(i),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,a=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Yt}`}}class _u{constructor(e,t,n,i){vr.set(this,void 0),mp(this,vr,e),this.options=i,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new H("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[i,s]of n)e.url.searchParams.set(i,s);t.query=void 0,t.path=e.url.toString()}return await gp(this,vr,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(vr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class _p extends ci{constructor(e,t,n){super(t,async i=>new n(e,i.response,await gu(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const vp=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),yp={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ve=r=>typeof r=="object"&&r!==null&&!vu(r)&&Object.keys(r).every(e=>yu(yp,e)),wp=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yt,"X-Stainless-OS":fo(Deno.build.os),"X-Stainless-Arch":co(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yt,"X-Stainless-OS":fo(process.platform),"X-Stainless-Arch":co(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=xp();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xp(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,s=n[2]||0,a=n[3]||0;return{browser:e,version:`${i}.${s}.${a}`}}}return null}const co=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",fo=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let ho;const Ap=()=>ho??(ho=wp()),Sp=r=>{try{return JSON.parse(r)}catch{return}},Ep=/^[a-z][a-z0-9+.-]*:/i,kp=r=>Ep.test(r),ir=r=>new Promise(e=>setTimeout(e,r)),Ni=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new H(`${r} must be an integer`);if(e<0)throw new H(`${r} must be a positive integer`);return e},as=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},yr=r=>{var e,t,n,i;if(typeof process<"u")return((e=rn==null?void 0:rn[r])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,r))==null?void 0:i.trim()};function vu(r){if(!r)return!0;for(const e in r)return!1;return!0}function yu(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function po(r,e){for(const t in e){if(!yu(e,t))continue;const n=t.toLowerCase();if(!n)continue;const i=e[t];i===null?delete r[n]:i!==void 0&&(r[n]=i)}}const mo=new Set(["authorization","api-key"]);function sn(r,...e){if(typeof process<"u"&&(rn==null?void 0:rn.DEBUG)==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const s={...n,headers:{...n.headers}};for(const a in n.headers)mo.has(a.toLowerCase())&&(s.headers[a]="REDACTED");return s}let i=null;for(const s in n)mo.has(s.toLowerCase())&&(i??(i={...n}),i[s]="REDACTED");return i??n});console.log(`OpenAI:DEBUG:${r}`,...t)}}const Cp=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),Op=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Rp=r=>typeof(r==null?void 0:r.get)=="function",go=(r,e)=>{var n;const t=e.toLowerCase();if(Rp(r)){const i=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(s,a,o)=>a+o.toUpperCase());for(const s of[e,t,e.toUpperCase(),i]){const a=r.get(s);if(a)return a}}for(const[i,s]of Object.entries(r))if(i.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};function Li(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class $p extends _u{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class qe extends _u{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class X{constructor(e){this._client=e}}let wu=class extends X{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Ts=class extends X{constructor(){super(...arguments),this.completions=new wu(this._client)}};Ts.Completions=wu;class xu extends X{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Au extends X{create(e,t){return this._client.post("/audio/transcriptions",hn({body:e,...t}))}}class Su extends X{create(e,t){return this._client.post("/audio/translations",hn({body:e,...t}))}}class sr extends X{constructor(){super(...arguments),this.transcriptions=new Au(this._client),this.translations=new Su(this._client),this.speech=new xu(this._client)}}sr.Transcriptions=Au;sr.Translations=Su;sr.Speech=xu;class Is extends X{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return ve(e)?this.list({},e):this._client.getAPIList("/batches",Ms,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Ms extends qe{}Is.BatchesPage=Ms;class Ns extends X{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return ve(e)?this.list({},e):this._client.getAPIList("/assistants",Ls,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ls extends qe{}Ns.AssistantsPage=Ls;function bo(r){return typeof r.parse=="function"}const an=r=>(r==null?void 0:r.role)==="assistant",Eu=r=>(r==null?void 0:r.role)==="function",ku=r=>(r==null?void 0:r.role)==="tool";var Ne=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},re=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},os,Rr,$r,Sn,En,Pr,kn,it,Cn,Hr,Wr,Zt,Cu;class Ou{constructor(){os.add(this),this.controller=new AbortController,Rr.set(this,void 0),$r.set(this,()=>{}),Sn.set(this,()=>{}),En.set(this,void 0),Pr.set(this,()=>{}),kn.set(this,()=>{}),it.set(this,{}),Cn.set(this,!1),Hr.set(this,!1),Wr.set(this,!1),Zt.set(this,!1),Ne(this,Rr,new Promise((e,t)=>{Ne(this,$r,e,"f"),Ne(this,Sn,t,"f")}),"f"),Ne(this,En,new Promise((e,t)=>{Ne(this,Pr,e,"f"),Ne(this,kn,t,"f")}),"f"),re(this,Rr,"f").catch(()=>{}),re(this,En,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},re(this,os,"m",Cu).bind(this))},0)}_connected(){this.ended||(re(this,$r,"f").call(this),this._emit("connect"))}get ended(){return re(this,Cn,"f")}get errored(){return re(this,Hr,"f")}get aborted(){return re(this,Wr,"f")}abort(){this.controller.abort()}on(e,t){return(re(this,it,"f")[e]||(re(this,it,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=re(this,it,"f")[e];if(!n)return this;const i=n.findIndex(s=>s.listener===t);return i>=0&&n.splice(i,1),this}once(e,t){return(re(this,it,"f")[e]||(re(this,it,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{Ne(this,Zt,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){Ne(this,Zt,!0,"f"),await re(this,En,"f")}_emit(e,...t){if(re(this,Cn,"f"))return;e==="end"&&(Ne(this,Cn,!0,"f"),re(this,Pr,"f").call(this));const n=re(this,it,"f")[e];if(n&&(re(this,it,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...t))),e==="abort"){const i=t[0];!re(this,Zt,"f")&&!(n!=null&&n.length)&&Promise.reject(i),re(this,Sn,"f").call(this,i),re(this,kn,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=t[0];!re(this,Zt,"f")&&!(n!=null&&n.length)&&Promise.reject(i),re(this,Sn,"f").call(this,i),re(this,kn,"f").call(this,i),this._emit("end")}}_emitFinal(){}}Rr=new WeakMap,$r=new WeakMap,Sn=new WeakMap,En=new WeakMap,Pr=new WeakMap,kn=new WeakMap,it=new WeakMap,Cn=new WeakMap,Hr=new WeakMap,Wr=new WeakMap,Zt=new WeakMap,os=new WeakSet,Cu=function(e){if(Ne(this,Hr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Be),e instanceof Be)return Ne(this,Wr,!0,"f"),this._emit("abort",e);if(e instanceof H)return this._emit("error",e);if(e instanceof Error){const t=new H(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new H(String(e)))};function Ru(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function ar(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function Pp(r,e){return!e||!$u(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:Ds(r,e)}function Ds(r,e){const t=r.choices.map(n=>{var i;if(n.finish_reason==="length")throw new cu;if(n.finish_reason==="content_filter")throw new fu;return{...n,message:{...n.message,tool_calls:((i=n.message.tool_calls)==null?void 0:i.map(s=>Ip(e,s)))??[],parsed:n.message.content&&!n.message.refusal?Tp(e,n.message.content):null}}});return{...r,choices:t}}function Tp(r,e){var t,n;return((t=r.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=r.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function Ip(r,e){var n;const t=(n=r.tools)==null?void 0:n.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:ar(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Mp(r,e){var n;if(!r)return!1;const t=(n=r.tools)==null?void 0:n.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return ar(t)||(t==null?void 0:t.function.strict)||!1}function $u(r){var e;return Ru(r.response_format)?!0:((e=r.tools)==null?void 0:e.some(t=>ar(t)||t.type==="function"&&t.function.strict===!0))??!1}function Np(r){for(const e of r??[]){if(e.type!=="function")throw new H(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new H(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var _e=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ge,ls,qr,us,cs,fs,Pu,hs;const _o=10;class Tu extends Ou{constructor(){super(...arguments),ge.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Eu(e)||ku(e))&&e.content)this._emit("functionCallResult",e.content);else if(an(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(an(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new H("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),_e(this,ge,"m",ls).call(this)}async finalMessage(){return await this.done(),_e(this,ge,"m",qr).call(this)}async finalFunctionCall(){return await this.done(),_e(this,ge,"m",us).call(this)}async finalFunctionCallResult(){return await this.done(),_e(this,ge,"m",cs).call(this)}async totalUsage(){return await this.done(),_e(this,ge,"m",fs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=_e(this,ge,"m",qr).call(this);t&&this._emit("finalMessage",t);const n=_e(this,ge,"m",ls).call(this);n&&this._emit("finalContent",n);const i=_e(this,ge,"m",us).call(this);i&&this._emit("finalFunctionCall",i);const s=_e(this,ge,"m",cs).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",_e(this,ge,"m",fs).call(this))}async _createChatCompletion(e,t,n){const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),_e(this,ge,"m",Pu).call(this,t);const s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Ds(s,t))}async _runChatCompletion(e,t,n){for(const i of t.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var p;const i="function",{function_call:s="auto",stream:a,...o}=t,l=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:u=_o}=n||{},c={};for(const v of t.functions)c[v.name||v.function.name]=v;const h=t.functions.map(v=>({name:v.name||v.function.name,parameters:v.parameters,description:v.description}));for(const v of t.messages)this._addMessage(v,!1);for(let v=0;v<u;++v){const w=(p=(await this._createChatCompletion(e,{...o,function_call:s,functions:h,messages:[...this.messages]},n)).choices[0])==null?void 0:p.message;if(!w)throw new H("missing message in ChatCompletion response");if(!w.function_call)return;const{name:x,arguments:B}=w.function_call,C=c[x];if(C){if(l&&l!==x){const P=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,name:x,content:P});continue}}else{const P=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:x,content:P});continue}let L;try{L=bo(C)?await C.parse(B):B}catch(P){this._addMessage({role:i,name:x,content:P instanceof Error?P.message:String(P)});continue}const I=await C.function(L,this),S=_e(this,ge,"m",hs).call(this,I);if(this._addMessage({role:i,name:x,content:S}),l)return}}async _runTools(e,t,n){var v,y,w;const i="tool",{tool_choice:s="auto",stream:a,...o}=t,l=typeof s!="string"&&((v=s==null?void 0:s.function)==null?void 0:v.name),{maxChatCompletions:u=_o}=n||{},c=t.tools.map(x=>{if(ar(x)){if(!x.$callback)throw new H("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),h={};for(const x of c)x.type==="function"&&(h[x.function.name||x.function.function.name]=x.function);const p="tools"in t?c.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of t.messages)this._addMessage(x,!1);for(let x=0;x<u;++x){const C=(y=(await this._createChatCompletion(e,{...o,tool_choice:s,tools:p,messages:[...this.messages]},n)).choices[0])==null?void 0:y.message;if(!C)throw new H("missing message in ChatCompletion response");if(!((w=C.tool_calls)!=null&&w.length))return;for(const L of C.tool_calls){if(L.type!=="function")continue;const I=L.id,{name:S,arguments:P}=L.function,E=h[S];if(E){if(l&&l!==S){const F=`Invalid tool_call: ${JSON.stringify(S)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,tool_call_id:I,content:F});continue}}else{const F=`Invalid tool_call: ${JSON.stringify(S)}. Available options are: ${Object.keys(h).map(ue=>JSON.stringify(ue)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:I,content:F});continue}let D;try{D=bo(E)?await E.parse(P):P}catch(F){const ue=F instanceof Error?F.message:String(F);this._addMessage({role:i,tool_call_id:I,content:ue});continue}const U=await E.function(D,this),V=_e(this,ge,"m",hs).call(this,U);if(this._addMessage({role:i,tool_call_id:I,content:V}),l)return}}}}ge=new WeakSet,ls=function(){return _e(this,ge,"m",qr).call(this).content??null},qr=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(an(t)){const{function_call:n,...i}=t,s={...i,content:t.content??null,refusal:t.refusal??null};return n&&(s.function_call=n),s}}throw new H("stream ended without producing a ChatCompletionMessage with role=assistant")},us=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const i=this.messages[n];if(an(i)&&(i!=null&&i.function_call))return i.function_call;if(an(i)&&((e=i==null?void 0:i.tool_calls)!=null&&e.length))return(t=i.tool_calls.at(-1))==null?void 0:t.function}},cs=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Eu(t)&&t.content!=null||ku(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var i;return n.role==="assistant"&&((i=n.tool_calls)==null?void 0:i.some(s=>s.type==="function"&&s.id===t.tool_call_id))}))return t.content}},fs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Pu=function(e){if(e.n!=null&&e.n>1)throw new H("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},hs=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Wn extends Tu{static runFunctions(e,t,n){const i=new Wn,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,t,s)),i}static runTools(e,t,n){const i=new Wn,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,s)),i}_addMessage(e,t=!0){super._addMessage(e,t),an(e)&&e.content&&this._emit("content",e.content)}}const Iu=1,Mu=2,Nu=4,Lu=8,Du=16,Bu=32,ju=64,Fu=128,Uu=256,Lp=Fu|Uu,Dp=Du|Bu|Lp|ju,Bp=Iu|Mu|Dp,jp=Nu|Lu,Fp=Bp|jp,he={STR:Iu,NUM:Mu,ARR:Nu,OBJ:Lu,NULL:Du,BOOL:Bu,NAN:ju,INFINITY:Fu,MINUS_INFINITY:Uu,ALL:Fp};class Up extends Error{}class zp extends Error{}function Vp(r,e=he.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return Hp(r.trim(),e)}const Hp=(r,e)=>{const t=r.length;let n=0;const i=p=>{throw new Up(`${p} at position ${n}`)},s=p=>{throw new zp(`${p} at position ${n}`)},a=()=>(h(),n>=t&&i("Unexpected end of input"),r[n]==='"'?o():r[n]==="{"?l():r[n]==="["?u():r.substring(n,n+4)==="null"||he.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||he.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||he.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||he.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||he.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||he.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):c()),o=()=>{const p=n;let v=!1;for(n++;n<t&&(r[n]!=='"'||v&&r[n-1]==="\\");)v=r[n]==="\\"?!v:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(p,++n-Number(v)))}catch(y){s(String(y))}else if(he.STR&e)try{return JSON.parse(r.substring(p,n-Number(v))+'"')}catch{return JSON.parse(r.substring(p,r.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},l=()=>{n++,h();const p={};try{for(;r[n]!=="}";){if(h(),n>=t&&he.OBJ&e)return p;const v=o();h(),n++;try{const y=a();Object.defineProperty(p,v,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(he.OBJ&e)return p;throw y}h(),r[n]===","&&n++}}catch{if(he.OBJ&e)return p;i("Expected '}' at end of object")}return n++,p},u=()=>{n++;const p=[];try{for(;r[n]!=="]";)p.push(a()),h(),r[n]===","&&n++}catch{if(he.ARR&e)return p;i("Expected ']' at end of array")}return n++,p},c=()=>{if(n===0){r==="-"&&he.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(r)}catch(v){if(he.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}s(String(v))}}const p=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(he.NUM&e)&&i("Unterminated number literal");try{return JSON.parse(r.substring(p,n))}catch{r.substring(p,n)==="-"&&he.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(r.substring(p,r.lastIndexOf("e")))}catch(y){s(String(y))}}},h=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return a()},vo=r=>Vp(r,he.ALL^he.NUM);var qt=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ee=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ce,rt,Kt,ht,Di,wr,Bi,ji,Fi,xr,Ui,yo;class qn extends Tu{constructor(e){super(),ce.add(this),rt.set(this,void 0),Kt.set(this,void 0),ht.set(this,void 0),qt(this,rt,e,"f"),qt(this,Kt,[],"f")}get currentChatCompletionSnapshot(){return ee(this,ht,"f")}static fromReadableStream(e){const t=new qn(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const i=new qn(t);return i._run(()=>i._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,t,n){var a;super._createChatCompletion;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),ee(this,ce,"m",Di).call(this);const s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of s)ee(this,ce,"m",Bi).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new Be;return this._addChatCompletion(ee(this,ce,"m",xr).call(this))}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ee(this,ce,"m",Di).call(this),this._connected();const i=Ye.fromReadableStream(e,this.controller);let s;for await(const o of i)s&&s!==o.id&&this._addChatCompletion(ee(this,ce,"m",xr).call(this)),ee(this,ce,"m",Bi).call(this,o),s=o.id;if((a=i.controller.signal)!=null&&a.aborted)throw new Be;return this._addChatCompletion(ee(this,ce,"m",xr).call(this))}[(rt=new WeakMap,Kt=new WeakMap,ht=new WeakMap,ce=new WeakSet,Di=function(){this.ended||qt(this,ht,void 0,"f")},wr=function(t){let n=ee(this,Kt,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ee(this,Kt,"f")[t.index]=n,n)},Bi=function(t){var i,s,a,o,l,u,c,h,p,v,y,w,x,B,C;if(this.ended)return;const n=ee(this,ce,"m",yo).call(this,t);this._emit("chunk",t,n);for(const L of t.choices){const I=n.choices[L.index];L.delta.content!=null&&((i=I.message)==null?void 0:i.role)==="assistant"&&((s=I.message)!=null&&s.content)&&(this._emit("content",L.delta.content,I.message.content),this._emit("content.delta",{delta:L.delta.content,snapshot:I.message.content,parsed:I.message.parsed})),L.delta.refusal!=null&&((a=I.message)==null?void 0:a.role)==="assistant"&&((o=I.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:L.delta.refusal,snapshot:I.message.refusal}),((l=L.logprobs)==null?void 0:l.content)!=null&&((u=I.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=L.logprobs)==null?void 0:c.content,snapshot:((h=I.logprobs)==null?void 0:h.content)??[]}),((p=L.logprobs)==null?void 0:p.refusal)!=null&&((v=I.message)==null?void 0:v.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(y=L.logprobs)==null?void 0:y.refusal,snapshot:((w=I.logprobs)==null?void 0:w.refusal)??[]});const S=ee(this,ce,"m",wr).call(this,I);I.finish_reason&&(ee(this,ce,"m",Fi).call(this,I),S.current_tool_call_index!=null&&ee(this,ce,"m",ji).call(this,I,S.current_tool_call_index));for(const P of L.delta.tool_calls??[])S.current_tool_call_index!==P.index&&(ee(this,ce,"m",Fi).call(this,I),S.current_tool_call_index!=null&&ee(this,ce,"m",ji).call(this,I,S.current_tool_call_index)),S.current_tool_call_index=P.index;for(const P of L.delta.tool_calls??[]){const E=(x=I.message.tool_calls)==null?void 0:x[P.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(B=E.function)==null?void 0:B.name,index:P.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((C=P.function)==null?void 0:C.arguments)??""}):(E==null||E.type,void 0))}}},ji=function(t,n){var a,o,l;if(ee(this,ce,"m",wr).call(this,t).done_tool_calls.has(n))return;const s=(a=t.message.tool_calls)==null?void 0:a[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const u=(l=(o=ee(this,rt,"f"))==null?void 0:o.tools)==null?void 0:l.find(c=>c.type==="function"&&c.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:ar(u)?u.$parseRaw(s.function.arguments):u!=null&&u.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Fi=function(t){var i,s;const n=ee(this,ce,"m",wr).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const a=ee(this,ce,"m",Ui).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(i=t.logprobs)!=null&&i.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(s=t.logprobs)!=null&&s.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},xr=function(){if(this.ended)throw new H("stream has ended, this shouldn't happen");const t=ee(this,ht,"f");if(!t)throw new H("request ended without sending any chunks");return qt(this,ht,void 0,"f"),qt(this,Kt,[],"f"),Wp(t,ee(this,rt,"f"))},Ui=function(){var n;const t=(n=ee(this,rt,"f"))==null?void 0:n.response_format;return Ru(t)?t:null},yo=function(t){var n,i,s,a;let o=ee(this,ht,"f");const{choices:l,...u}=t;o?Object.assign(o,u):o=qt(this,ht,{...u,choices:[]},"f");for(const{delta:c,finish_reason:h,index:p,logprobs:v=null,...y}of t.choices){let w=o.choices[p];if(w||(w=o.choices[p]={finish_reason:h,index:p,message:{},logprobs:v,...y}),v)if(!w.logprobs)w.logprobs=Object.assign({},v);else{const{content:P,refusal:E,...D}=v;Object.assign(w.logprobs,D),P&&((n=w.logprobs).content??(n.content=[]),w.logprobs.content.push(...P)),E&&((i=w.logprobs).refusal??(i.refusal=[]),w.logprobs.refusal.push(...E))}if(h&&(w.finish_reason=h,ee(this,rt,"f")&&$u(ee(this,rt,"f")))){if(h==="length")throw new cu;if(h==="content_filter")throw new fu}if(Object.assign(w,y),!c)continue;const{content:x,refusal:B,function_call:C,role:L,tool_calls:I,...S}=c;if(Object.assign(w.message,S),B&&(w.message.refusal=(w.message.refusal||"")+B),L&&(w.message.role=L),C&&(w.message.function_call?(C.name&&(w.message.function_call.name=C.name),C.arguments&&((s=w.message.function_call).arguments??(s.arguments=""),w.message.function_call.arguments+=C.arguments)):w.message.function_call=C),x&&(w.message.content=(w.message.content||"")+x,!w.message.refusal&&ee(this,ce,"m",Ui).call(this)&&(w.message.parsed=vo(w.message.content))),I){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:P,id:E,type:D,function:U,...V}of I){const F=(a=w.message.tool_calls)[P]??(a[P]={});Object.assign(F,V),E&&(F.id=E),D&&(F.type=D),U&&(F.function??(F.function={name:U.name??"",arguments:""})),U!=null&&U.name&&(F.function.name=U.name),U!=null&&U.arguments&&(F.function.arguments+=U.arguments,Mp(ee(this,rt,"f"),F)&&(F.function.parsed_arguments=vo(F.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ye(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Wp(r,e){const{id:t,choices:n,created:i,model:s,system_fingerprint:a,...o}=r,l={...o,id:t,choices:n.map(({message:u,finish_reason:c,index:h,logprobs:p,...v})=>{if(!c)throw new H(`missing finish_reason for choice ${h}`);const{content:y=null,function_call:w,tool_calls:x,...B}=u,C=u.role;if(!C)throw new H(`missing role for choice ${h}`);if(w){const{arguments:L,name:I}=w;if(L==null)throw new H(`missing function_call.arguments for choice ${h}`);if(!I)throw new H(`missing function_call.name for choice ${h}`);return{...v,message:{content:y,function_call:{arguments:L,name:I},role:C,refusal:u.refusal??null},finish_reason:c,index:h,logprobs:p}}return x?{...v,index:h,finish_reason:c,logprobs:p,message:{...B,role:C,content:y,refusal:u.refusal??null,tool_calls:x.map((L,I)=>{const{function:S,type:P,id:E,...D}=L,{arguments:U,name:V,...F}=S||{};if(E==null)throw new H(`missing choices[${h}].tool_calls[${I}].id
${Ar(r)}`);if(P==null)throw new H(`missing choices[${h}].tool_calls[${I}].type
${Ar(r)}`);if(V==null)throw new H(`missing choices[${h}].tool_calls[${I}].function.name
${Ar(r)}`);if(U==null)throw new H(`missing choices[${h}].tool_calls[${I}].function.arguments
${Ar(r)}`);return{...D,id:E,type:P,function:{...F,name:V,arguments:U}}})}}:{...v,message:{...B,content:y,role:C,refusal:u.refusal??null},finish_reason:c,index:h,logprobs:p}}),created:i,model:s,object:"chat.completion",...a?{system_fingerprint:a}:{}};return Pp(l,e)}function Ar(r){return JSON.stringify(r)}class on extends qn{static fromReadableStream(e){const t=new on(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const i=new on(null),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,t,s)),i}static runTools(e,t,n){const i=new on(t),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,s)),i}}let zu=class extends X{parse(e,t){return Np(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Ds(n,e))}runFunctions(e,t){return e.stream?on.runFunctions(this._client,e,t):Wn.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?on.runTools(this._client,e,t):Wn.runTools(this._client,e,t)}stream(e,t){return qn.createChatCompletion(this._client,e,t)}};class ds extends X{constructor(){super(...arguments),this.completions=new zu(this._client)}}(function(r){r.Completions=zu})(ds||(ds={}));class Vu extends X{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Bs extends X{constructor(){super(...arguments),this.sessions=new Vu(this._client)}}Bs.Sessions=Vu;var N=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},we=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},de,ps,Je,Tr,Le,$t,nn,Ot,Kr,xe,Ir,Mr,Nn,On,Rn,wo,xo,Ao,So,Eo,ko,Co;class je extends Ou{constructor(){super(...arguments),de.add(this),ps.set(this,[]),Je.set(this,{}),Tr.set(this,{}),Le.set(this,void 0),$t.set(this,void 0),nn.set(this,void 0),Ot.set(this,void 0),Kr.set(this,void 0),xe.set(this,void 0),Ir.set(this,void 0),Mr.set(this,void 0),Nn.set(this,void 0)}[(ps=new WeakMap,Je=new WeakMap,Tr=new WeakMap,Le=new WeakMap,$t=new WeakMap,nn=new WeakMap,Ot=new WeakMap,Kr=new WeakMap,xe=new WeakMap,Ir=new WeakMap,Mr=new WeakMap,Nn=new WeakMap,de=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new je;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var s;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=Ye.fromReadableStream(e,this.controller);for await(const a of i)N(this,de,"m",On).call(this,a);if((s=i.controller.signal)!=null&&s.aborted)throw new Be;return this._addRun(N(this,de,"m",Rn).call(this))}toReadableStream(){return new Ye(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,i,s){const a=new je;return a._run(()=>a._runToolAssistantStream(e,t,n,i,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,n,i,s){var u;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...i,stream:!0},l=await e.submitToolOutputs(t,n,o,{...s,signal:this.controller.signal});this._connected();for await(const c of l)N(this,de,"m",On).call(this,c);if((u=l.controller.signal)!=null&&u.aborted)throw new Be;return this._addRun(N(this,de,"m",Rn).call(this))}static createThreadAssistantStream(e,t,n){const i=new je;return i._run(()=>i._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,t,n,i){const s=new je;return s._run(()=>s._runAssistantStream(e,t,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return N(this,Ir,"f")}currentRun(){return N(this,Mr,"f")}currentMessageSnapshot(){return N(this,Le,"f")}currentRunStepSnapshot(){return N(this,Nn,"f")}async finalRunSteps(){return await this.done(),Object.values(N(this,Je,"f"))}async finalMessages(){return await this.done(),Object.values(N(this,Tr,"f"))}async finalRun(){if(await this.done(),!N(this,$t,"f"))throw Error("Final run was not received.");return N(this,$t,"f")}async _createThreadAssistantStream(e,t,n){var o;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...t,stream:!0},a=await e.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const l of a)N(this,de,"m",On).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Be;return this._addRun(N(this,de,"m",Rn).call(this))}async _createAssistantStream(e,t,n,i){var l;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},o=await e.create(t,a,{...i,signal:this.controller.signal});this._connected();for await(const u of o)N(this,de,"m",On).call(this,u);if((l=o.controller.signal)!=null&&l.aborted)throw new Be;return this._addRun(N(this,de,"m",Rn).call(this))}static accumulateDelta(e,t){for(const[n,i]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=i;continue}let s=e[n];if(s==null){e[n]=i;continue}if(n==="index"||n==="type"){e[n]=i;continue}if(typeof s=="string"&&typeof i=="string")s+=i;else if(typeof s=="number"&&typeof i=="number")s+=i;else if(Li(s)&&Li(i))s=this.accumulateDelta(s,i);else if(Array.isArray(s)&&Array.isArray(i)){if(s.every(a=>typeof a=="string"||typeof a=="number")){s.push(...i);continue}for(const a of i){if(!Li(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=s[o];l==null?s.push(a):s[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${i}, accValue: ${s}`);e[n]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,i){return await this._createAssistantStream(t,e,n,i)}async _runToolAssistantStream(e,t,n,i,s){return await this._createToolAssistantStream(n,e,t,i,s)}}On=function(e){if(!this.ended)switch(we(this,Ir,e,"f"),N(this,de,"m",Ao).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":N(this,de,"m",Co).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":N(this,de,"m",xo).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":N(this,de,"m",wo).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Rn=function(){if(this.ended)throw new H("stream has ended, this shouldn't happen");if(!N(this,$t,"f"))throw Error("Final run has not been received");return N(this,$t,"f")},wo=function(e){const[t,n]=N(this,de,"m",Eo).call(this,e,N(this,Le,"f"));we(this,Le,t,"f"),N(this,Tr,"f")[t.id]=t;for(const i of n){const s=t.content[i.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let s=i.text,a=t.content[i.index];if(a&&a.type=="text")this._emit("textDelta",s,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=N(this,nn,"f")){if(N(this,Ot,"f"))switch(N(this,Ot,"f").type){case"text":this._emit("textDone",N(this,Ot,"f").text,N(this,Le,"f"));break;case"image_file":this._emit("imageFileDone",N(this,Ot,"f").image_file,N(this,Le,"f"));break}we(this,nn,i.index,"f")}we(this,Ot,t.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(N(this,nn,"f")!==void 0){const i=e.data.content[N(this,nn,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,N(this,Le,"f"));break;case"text":this._emit("textDone",i.text,N(this,Le,"f"));break}}N(this,Le,"f")&&this._emit("messageDone",e.data),we(this,Le,void 0,"f")}},xo=function(e){const t=N(this,de,"m",So).call(this,e);switch(we(this,Nn,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of n.step_details.tool_calls)s.index==N(this,Kr,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(N(this,xe,"f")&&this._emit("toolCallDone",N(this,xe,"f")),we(this,Kr,s.index,"f"),we(this,xe,t.step_details.tool_calls[s.index],"f"),N(this,xe,"f")&&this._emit("toolCallCreated",N(this,xe,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":we(this,Nn,void 0,"f"),e.data.step_details.type=="tool_calls"&&N(this,xe,"f")&&(this._emit("toolCallDone",N(this,xe,"f")),we(this,xe,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Ao=function(e){N(this,ps,"f").push(e),this._emit("event",e)},So=function(e){switch(e.event){case"thread.run.step.created":return N(this,Je,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=N(this,Je,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const i=je.accumulateDelta(t,n.delta);N(this,Je,"f")[e.data.id]=i}return N(this,Je,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":N(this,Je,"f")[e.data.id]=e.data;break}if(N(this,Je,"f")[e.data.id])return N(this,Je,"f")[e.data.id];throw new Error("No snapshot available")},Eo=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const s of i.delta.content)if(s.index in t.content){let a=t.content[s.index];t.content[s.index]=N(this,de,"m",ko).call(this,s,a)}else t.content[s.index]=s,n.push(s);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ko=function(e,t){return je.accumulateDelta(t,e)},Co=function(e){switch(we(this,Mr,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":we(this,$t,e.data,"f"),N(this,xe,"f")&&(this._emit("toolCallDone",N(this,xe,"f")),we(this,xe,void 0,"f"));break}};class js extends X{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,i){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t={},n){return ve(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Fs,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Fs extends qe{}js.MessagesPage=Fs;class Us extends X{retrieve(e,t,n,i={},s){return ve(i)?this.retrieve(e,t,n,{},i):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:i,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t,n={},i){return ve(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,zs,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class zs extends qe{}Us.RunStepsPage=zs;class or extends X{constructor(){super(...arguments),this.steps=new Us(this._client)}create(e,t,n){const{include:i,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:i},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,i){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t={},n){return ve(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Vs,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(e,i.id,n)}createAndStream(e,t,n){return je.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...i}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await ir(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return je.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,i){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,i){const s=await this.submitToolOutputs(e,t,n,i);return await this.poll(e,s.id,i)}submitToolOutputsStream(e,t,n,i){return je.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,i)}}class Vs extends qe{}or.RunsPage=Vs;or.Steps=Us;or.RunStepsPage=zs;class gn extends X{constructor(){super(...arguments),this.runs=new or(this._client),this.messages=new js(this._client)}create(e={},t){return ve(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return je.createThreadAssistantStream(e,this._client.beta.threads,t)}}gn.Runs=or;gn.RunsPage=Vs;gn.Messages=js;gn.MessagesPage=Fs;const qp=async r=>{const e=await Promise.allSettled(r),t=e.filter(i=>i.status==="rejected");if(t.length){for(const i of t)console.error(i.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const i of e)i.status==="fulfilled"&&n.push(i.value);return n};let Hs=class extends X{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return ve(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,fi,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(e,i.id,n)}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(e,t,{...n,headers:i}).withResponse(),a=s.data;switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=s.response.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await ir(o);break;case"failed":case"completed":return a}}}async upload(e,t,n){const i=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:i.id},n)}async uploadAndPoll(e,t,n){const i=await this.upload(e,t,n);return await this.poll(e,i.id,n)}};class fi extends qe{}Hs.VectorStoreFilesPage=fi;class Hu extends X{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t);return await this.poll(e,i.id,n)}listFiles(e,t,n={},i){return ve(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,fi,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,t,{...n,headers:i}).withResponse();switch(s.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await ir(o);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},i){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(i==null?void 0:i.maxConcurrency)??5,a=Math.min(s,t.length),o=this._client,l=t.values(),u=[...n];async function c(p){for(let v of p){const y=await o.files.create({file:v,purpose:"assistants"},i);u.push(y.id)}}const h=Array(a).fill(l).map(c);return await qp(h),await this.createAndPoll(e,{file_ids:u})}}class bn extends X{constructor(){super(...arguments),this.files=new Hs(this._client),this.fileBatches=new Hu(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return ve(e)?this.list({},e):this._client.getAPIList("/vector_stores",Ws,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ws extends qe{}bn.VectorStoresPage=Ws;bn.Files=Hs;bn.VectorStoreFilesPage=fi;bn.FileBatches=Hu;class St extends X{constructor(){super(...arguments),this.realtime=new Bs(this._client),this.vectorStores=new bn(this._client),this.chat=new ds(this._client),this.assistants=new Ns(this._client),this.threads=new gn(this._client)}}St.Realtime=Bs;St.VectorStores=bn;St.VectorStoresPage=Ws;St.Assistants=Ns;St.AssistantsPage=Ls;St.Threads=gn;class Wu extends X{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class qu extends X{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class qs extends X{create(e,t){return this._client.post("/files",hn({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return ve(e)?this.list({},e):this._client.getAPIList("/files",Ks,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),s=Date.now();let a=await this.retrieve(e);for(;!a.status||!i.has(a.status);)if(await ir(t),a=await this.retrieve(e),Date.now()-s>n)throw new Ps({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class Ks extends qe{}qs.FileObjectsPage=Ks;class Gs extends X{list(e,t={},n){return ve(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Xs,{query:t,...n})}}class Xs extends qe{}Gs.FineTuningJobCheckpointsPage=Xs;class _n extends X{constructor(){super(...arguments),this.checkpoints=new Gs(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return ve(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Js,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return ve(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Ys,{query:t,...n})}}class Js extends qe{}class Ys extends qe{}_n.FineTuningJobsPage=Js;_n.FineTuningJobEventsPage=Ys;_n.Checkpoints=Gs;_n.FineTuningJobCheckpointsPage=Xs;class lr extends X{constructor(){super(...arguments),this.jobs=new _n(this._client)}}lr.Jobs=_n;lr.FineTuningJobsPage=Js;lr.FineTuningJobEventsPage=Ys;class Ku extends X{createVariation(e,t){return this._client.post("/images/variations",hn({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",hn({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Zs extends X{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Qs,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Qs extends $p{}Zs.ModelsPage=Qs;class Gu extends X{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Xu extends X{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,hn({body:t,...n}))}}class ea extends X{constructor(){super(...arguments),this.parts=new Xu(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}ea.Parts=Xu;var Ju;class q extends bp{constructor({baseURL:e=yr("OPENAI_BASE_URL"),apiKey:t=yr("OPENAI_API_KEY"),organization:n=yr("OPENAI_ORG_ID")??null,project:i=yr("OPENAI_PROJECT_ID")??null,...s}={}){if(t===void 0)throw new H("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:n,project:i,...s,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Op())throw new H(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Wu(this),this.chat=new Ts(this),this.embeddings=new qu(this),this.files=new qs(this),this.images=new Ku(this),this.audio=new sr(this),this.moderations=new Gu(this),this.models=new Zs(this),this.fineTuning=new lr(this),this.beta=new St(this),this.batches=new Is(this),this.uploads=new ea(this),this._options=a,this.apiKey=t,this.organization=n,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return ep(e,{arrayFormat:"brackets"})}}Ju=q;q.OpenAI=Ju;q.DEFAULT_TIMEOUT=6e5;q.OpenAIError=H;q.APIError=me;q.APIConnectionError=li;q.APIConnectionTimeoutError=Ps;q.APIUserAbortError=Be;q.NotFoundError=su;q.ConflictError=au;q.RateLimitError=lu;q.BadRequestError=nu;q.AuthenticationError=ru;q.InternalServerError=uu;q.PermissionDeniedError=iu;q.UnprocessableEntityError=ou;q.toFile=mu;q.fileFromPath=eu;q.Completions=Wu;q.Chat=Ts;q.Embeddings=qu;q.Files=qs;q.FileObjectsPage=Ks;q.Images=Ku;q.Audio=sr;q.Moderations=Gu;q.Models=Zs;q.ModelsPage=Qs;q.FineTuning=lr;q.Beta=St;q.Batches=Is;q.BatchesPage=Ms;q.Uploads=ea;function Kp(r,e){return new q({apiKey:r,baseURL:e,dangerouslyAllowBrowser:!0})}const Yu="integrations";kl({useProxies:"never"});const Me=ai({integrations:[{name:"OpenAI",baseURL:"https://api.openai.com/v1",model:"gpt-4o",apiKey:"",embeddingModel:"text-embedding-3-small"},{name:"Hugging Face",baseURL:"https://api-inference.huggingface.co/models",apiKey:"",model:"gpt2",embeddingModel:"sentence-transformers/paraphrase-MiniLM-L6-v2"},{name:"Ollama",baseURL:"http://localhost:11434/v1",model:"llama3.2",embeddingModel:"nomic-embed-text"},{name:"Deepseek",baseURL:"http://api.deepseek.com/v1",apiKey:"",model:"deepseek",embeddingModel:"deepseek"}]});At.getItem(Yu).then(r=>{r&&Ft(()=>{Me.integrations=r.integrations})});xs(()=>Me.integrations,()=>{At.setItem(Yu,Rl(Me))});const Gt=Symbol("LitMobxRenderReaction"),Oo=Symbol("LitMobxRequestUpdate");function Gp(r,e){var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=()=>{this.requestUpdate()}}connectedCallback(){super.connectedCallback();const s=this.constructor.name||this.nodeName;this[Gt]=new e(`${s}.update()`,this[Oo]),this.hasUpdated&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),this[Gt]&&(this[Gt].dispose(),this[Gt]=void 0)}update(s){this[Gt]?this[Gt].track(super.update.bind(this,s)):super.update(s)}},t=Oo,n}function Xp(r){return Gp(r,tt)}class ur extends Xp(le){}function ta(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let zt=ta();function Zu(r){zt=r}const Ln={exec:()=>null};function Q(r,e=""){let t=typeof r=="string"?r:r.source;const n={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(be.caret,"$1"),t=t.replace(i,a),n},getRegex:()=>new RegExp(t,e)};return n}const be={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},Jp=/^(?:[ \t]*(?:\n|$))+/,Yp=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Zp=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,cr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Qp=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Qu=/(?:[*+-]|\d{1,9}[.)])/,ec=Q(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Qu).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),na=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,em=/^[^\n]+/,ra=/(?!\s*\])(?:\\.|[^\[\]\\])+/,tm=Q(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ra).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),nm=Q(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Qu).getRegex(),hi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ia=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,rm=Q("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ia).replace("tag",hi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),tc=Q(na).replace("hr",cr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex(),im=Q(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",tc).getRegex(),sa={blockquote:im,code:Yp,def:tm,fences:Zp,heading:Qp,hr:cr,html:rm,lheading:ec,list:nm,newline:Jp,paragraph:tc,table:Ln,text:em},Ro=Q("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",cr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex(),sm={...sa,table:Ro,paragraph:Q(na).replace("hr",cr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ro).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex()},am={...sa,html:Q(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ia).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ln,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Q(na).replace("hr",cr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ec).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},om=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,lm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,nc=/^( {2,}|\\)\n(?!\s*$)/,um=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,di=/[\p{P}\p{S}]/u,aa=/[\s\p{P}\p{S}]/u,rc=/[^\s\p{P}\p{S}]/u,cm=Q(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,aa).getRegex(),ic=/(?!~)[\p{P}\p{S}]/u,fm=/(?!~)[\s\p{P}\p{S}]/u,hm=/(?:[^\s\p{P}\p{S}]|~)/u,dm=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,sc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,pm=Q(sc,"u").replace(/punct/g,di).getRegex(),mm=Q(sc,"u").replace(/punct/g,ic).getRegex(),ac="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",gm=Q(ac,"gu").replace(/notPunctSpace/g,rc).replace(/punctSpace/g,aa).replace(/punct/g,di).getRegex(),bm=Q(ac,"gu").replace(/notPunctSpace/g,hm).replace(/punctSpace/g,fm).replace(/punct/g,ic).getRegex(),_m=Q("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,rc).replace(/punctSpace/g,aa).replace(/punct/g,di).getRegex(),vm=Q(/\\(punct)/,"gu").replace(/punct/g,di).getRegex(),ym=Q(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),wm=Q(ia).replace("(?:-->|$)","-->").getRegex(),xm=Q("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",wm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Gr=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Am=Q(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Gr).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),oc=Q(/^!?\[(label)\]\[(ref)\]/).replace("label",Gr).replace("ref",ra).getRegex(),lc=Q(/^!?\[(ref)\](?:\[\])?/).replace("ref",ra).getRegex(),Sm=Q("reflink|nolink(?!\\()","g").replace("reflink",oc).replace("nolink",lc).getRegex(),oa={_backpedal:Ln,anyPunctuation:vm,autolink:ym,blockSkip:dm,br:nc,code:lm,del:Ln,emStrongLDelim:pm,emStrongRDelimAst:gm,emStrongRDelimUnd:_m,escape:om,link:Am,nolink:lc,punctuation:cm,reflink:oc,reflinkSearch:Sm,tag:xm,text:um,url:Ln},Em={...oa,link:Q(/^!?\[(label)\]\((.*?)\)/).replace("label",Gr).getRegex(),reflink:Q(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Gr).getRegex()},ms={...oa,emStrongRDelimAst:bm,emStrongLDelim:mm,url:Q(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},km={...ms,br:Q(nc).replace("{2,}","*").getRegex(),text:Q(ms.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Sr={normal:sa,gfm:sm,pedantic:am},xn={normal:oa,gfm:ms,breaks:km,pedantic:Em},Cm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$o=r=>Cm[r];function Ge(r,e){if(e){if(be.escapeTest.test(r))return r.replace(be.escapeReplace,$o)}else if(be.escapeTestNoEncode.test(r))return r.replace(be.escapeReplaceNoEncode,$o);return r}function Po(r){try{r=encodeURI(r).replace(be.percentDecode,"%")}catch{return null}return r}function To(r,e){var s;const t=r.replace(be.findPipe,(a,o,l)=>{let u=!1,c=o;for(;--c>=0&&l[c]==="\\";)u=!u;return u?"|":" |"}),n=t.split(be.splitPipe);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!((s=n.at(-1))!=null&&s.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(be.slashPipe,"|");return n}function An(r,e,t){const n=r.length;if(n===0)return"";let i=0;for(;i<n&&r.charAt(n-i-1)===e;)i++;return r.slice(0,n-i)}function Om(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<r.length;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])t++;else if(r[n]===e[1]&&(t--,t<0))return n;return-1}function Io(r,e,t,n,i){const s=e.href,a=e.title||null,o=r[1].replace(i.other.outputLinkReplace,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;const l={type:"link",raw:t,href:s,title:a,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,l}return{type:"image",raw:t,href:s,title:a,text:o}}function Rm(r,e,t){const n=r.match(t.other.indentCodeCompensation);if(n===null)return e;const i=n[1];return e.split(`
`).map(s=>{const a=s.match(t.other.beginningSpace);if(a===null)return s;const[o]=a;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}class Xr{constructor(e){te(this,"options");te(this,"rules");te(this,"lexer");this.options=e||zt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:An(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],i=Rm(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const i=An(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:An(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=An(t[0],`
`).split(`
`),i="",s="";const a=[];for(;n.length>0;){let o=!1;const l=[];let u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))l.push(n[u]),o=!0;else if(!o)l.push(n[u]);else break;n=n.slice(u);const c=l.join(`
`),h=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${c}`:c,s=s?`${s}
${h}`:h;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,a,!0),this.lexer.state.top=p,n.length===0)break;const v=a.at(-1);if((v==null?void 0:v.type)==="code")break;if((v==null?void 0:v.type)==="blockquote"){const y=v,w=y.raw+`
`+n.join(`
`),x=this.blockquote(w);a[a.length-1]=x,i=i.substring(0,i.length-y.raw.length)+x.raw,s=s.substring(0,s.length-y.text.length)+x.text;break}else if((v==null?void 0:v.type)==="list"){const y=v,w=y.raw+`
`+n.join(`
`),x=this.list(w);a[a.length-1]=x,i=i.substring(0,i.length-v.raw.length)+x.raw,s=s.substring(0,s.length-y.raw.length)+x.raw,n=w.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:a,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const i=n.length>1,s={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");const a=this.rules.other.listItemRegex(n);let o=!1;for(;e;){let u=!1,c="",h="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let p=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,C=>" ".repeat(3*C.length)),v=e.split(`
`,1)[0],y=!p.trim(),w=0;if(this.options.pedantic?(w=2,h=p.trimStart()):y?w=t[1].length+1:(w=t[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,h=p.slice(w),w+=t[1].length),y&&this.rules.other.blankLine.test(v)&&(c+=v+`
`,e=e.substring(v.length+1),u=!0),!u){const C=this.rules.other.nextBulletRegex(w),L=this.rules.other.hrRegex(w),I=this.rules.other.fencesBeginRegex(w),S=this.rules.other.headingBeginRegex(w),P=this.rules.other.htmlBeginRegex(w);for(;e;){const E=e.split(`
`,1)[0];let D;if(v=E,this.options.pedantic?(v=v.replace(this.rules.other.listReplaceNesting,"  "),D=v):D=v.replace(this.rules.other.tabCharGlobal,"    "),I.test(v)||S.test(v)||P.test(v)||C.test(v)||L.test(v))break;if(D.search(this.rules.other.nonSpaceChar)>=w||!v.trim())h+=`
`+D.slice(w);else{if(y||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||I.test(p)||S.test(p)||L.test(p))break;h+=`
`+v}!y&&!v.trim()&&(y=!0),c+=E+`
`,e=e.substring(E.length+1),p=D.slice(w)}}s.loose||(o?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let x=null,B;this.options.gfm&&(x=this.rules.other.listIsTask.exec(h),x&&(B=x[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!x,checked:B,loose:!1,text:h,tokens:[]}),s.raw+=c}const l=s.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let u=0;u<s.items.length;u++)if(this.lexer.state.top=!1,s.items[u].tokens=this.lexer.blockTokens(s.items[u].text,[]),!s.loose){const c=s.items[u].tokens.filter(p=>p.type==="space"),h=c.length>0&&c.some(p=>this.rules.other.anyLine.test(p.raw));s.loose=h}if(s.loose)for(let u=0;u<s.items.length;u++)s.items[u].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:s}}}table(e){var o;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=To(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(o=t[3])!=null&&o.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(const l of i)this.rules.other.tableAlignRight.test(l)?a.align.push("right"):this.rules.other.tableAlignCenter.test(l)?a.align.push("center"):this.rules.other.tableAlignLeft.test(l)?a.align.push("left"):a.align.push(null);for(let l=0;l<n.length;l++)a.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:a.align[l]});for(const l of s)a.rows.push(To(l,a.header.length).map((u,c)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:a.align[c]})));return a}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const a=An(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{const a=Om(t[2],"()");if(a>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const a=this.rules.other.pedanticHrefTitle.exec(i);a&&(i=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Io(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[i.toLowerCase()];if(!s){const a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return Io(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const a=[...i[0]].length-1;let o,l,u=a,c=0;const h=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+a);(i=h.exec(t))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(l=[...o].length,i[3]||i[4]){u+=l;continue}else if((i[5]||i[6])&&a%3&&!((a+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const p=[...i[0]][0].length,v=e.slice(0,a+i.index+p+l);if(Math.min(a,l)%2){const w=v.slice(1,-1);return{type:"em",raw:v,text:w,tokens:this.lexer.inlineTokens(w)}}const y=v.slice(2,-2);return{type:"strong",raw:v,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=t[0],s="mailto:"+i;else{let a;do a=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(a!==t[0]);i=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}}class Te{constructor(e){te(this,"tokens");te(this,"options");te(this,"state");te(this,"tokenizer");te(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||zt,this.options.tokenizer=this.options.tokenizer||new Xr,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:be,block:Sr.normal,inline:xn.normal};this.options.pedantic?(t.block=Sr.pedantic,t.inline=xn.pedantic):this.options.gfm&&(t.block=Sr.gfm,this.options.breaks?t.inline=xn.breaks:t.inline=xn.gfm),this.tokenizer.rules=t}static get rules(){return{block:Sr,inline:xn}}static lex(e,t){return new Te(t).lex(e)}static lexInline(e,t){return new Te(t).inlineTokens(e)}lex(e){e=e.replace(be.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var i,s,a;for(this.options.pedantic&&(e=e.replace(be.tabCharGlobal,"    ").replace(be.spaceLine,""));e;){let o;if((s=(i=this.options.extensions)==null?void 0:i.block)!=null&&s.some(u=>(o=u.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);const u=t.at(-1);o.raw.length===1&&u!==void 0?u.raw+=`
`:t.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);const u=t.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.at(-1).src=u.text):t.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);const u=t.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.raw,this.inlineQueue.at(-1).src=u.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),t.push(o);continue}let l=e;if((a=this.options.extensions)!=null&&a.startBlock){let u=1/0;const c=e.slice(1);let h;this.options.extensions.startBlock.forEach(p=>{h=p.call({lexer:this},c),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(l=e.substring(0,u+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const u=t.at(-1);n&&(u==null?void 0:u.type)==="paragraph"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):t.push(o),n=l.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);const u=t.at(-1);(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):t.push(o);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var o,l,u;let n=e,i=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)c.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s=!1,a="";for(;e;){s||(a=""),s=!1;let c;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(p=>(c=p.call({lexer:this},e,t))?(e=e.substring(c.raw.length),t.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);const p=t.at(-1);c.type==="text"&&(p==null?void 0:p.type)==="text"?(p.raw+=c.raw,p.text+=c.text):t.push(c);continue}if(c=this.tokenizer.emStrong(e,n,a)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),t.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),t.push(c);continue}let h=e;if((u=this.options.extensions)!=null&&u.startInline){let p=1/0;const v=e.slice(1);let y;this.options.extensions.startInline.forEach(w=>{y=w.call({lexer:this},v),typeof y=="number"&&y>=0&&(p=Math.min(p,y))}),p<1/0&&p>=0&&(h=e.substring(0,p+1))}if(c=this.tokenizer.inlineText(h)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(a=c.raw.slice(-1)),s=!0;const p=t.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=c.raw,p.text+=c.text):t.push(c);continue}if(e){const p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return t}}class Jr{constructor(e){te(this,"options");te(this,"parser");this.options=e||zt}space(e){return""}code({text:e,lang:t,escaped:n}){var a;const i=(a=(t||"").match(be.notSpaceStart))==null?void 0:a[0],s=e.replace(be.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Ge(i)+'">'+(n?s:Ge(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Ge(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let i="";for(let o=0;o<e.items.length;o++){const l=e.items[o];i+=this.listitem(l)}const s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+i+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+Ge(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let i="";for(let s=0;s<e.rows.length;s++){const a=e.rows[s];n="";for(let o=0;o<a.length;o++)n+=this.tablecell(a[o]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ge(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const i=this.parser.parseInline(n),s=Po(e);if(s===null)return i;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+Ge(t)+'"'),a+=">"+i+"</a>",a}image({href:e,title:t,text:n}){const i=Po(e);if(i===null)return Ge(n);e=i;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${Ge(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ge(e.text)}}class la{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Ie{constructor(e){te(this,"options");te(this,"renderer");te(this,"textRenderer");this.options=e||zt,this.options.renderer=this.options.renderer||new Jr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new la}static parse(e,t){return new Ie(t).parse(e)}static parseInline(e,t){return new Ie(t).parseInline(e)}parse(e,t=!0){var i,s;let n="";for(let a=0;a<e.length;a++){const o=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){const u=o,c=this.options.extensions.renderers[u.type].call({parser:this},u);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)){n+=c||"";continue}}const l=o;switch(l.type){case"space":{n+=this.renderer.space(l);continue}case"hr":{n+=this.renderer.hr(l);continue}case"heading":{n+=this.renderer.heading(l);continue}case"code":{n+=this.renderer.code(l);continue}case"table":{n+=this.renderer.table(l);continue}case"blockquote":{n+=this.renderer.blockquote(l);continue}case"list":{n+=this.renderer.list(l);continue}case"html":{n+=this.renderer.html(l);continue}case"paragraph":{n+=this.renderer.paragraph(l);continue}case"text":{let u=l,c=this.renderer.text(u);for(;a+1<e.length&&e[a+1].type==="text";)u=e[++a],c+=`
`+this.renderer.text(u);t?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}parseInline(e,t=this.renderer){var i,s;let n="";for(let a=0;a<e.length;a++){const o=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){const u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){n+=u||"";continue}}const l=o;switch(l.type){case"escape":{n+=t.text(l);break}case"html":{n+=t.html(l);break}case"link":{n+=t.link(l);break}case"image":{n+=t.image(l);break}case"strong":{n+=t.strong(l);break}case"em":{n+=t.em(l);break}case"codespan":{n+=t.codespan(l);break}case"br":{n+=t.br(l);break}case"del":{n+=t.del(l);break}case"text":{n+=t.text(l);break}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}}class Dn{constructor(e){te(this,"options");te(this,"block");this.options=e||zt}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Te.lex:Te.lexInline}provideParser(){return this.block?Ie.parse:Ie.parseInline}}te(Dn,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class $m{constructor(...e){te(this,"defaults",ta());te(this,"options",this.setOptions);te(this,"parse",this.parseMarkdown(!0));te(this,"parseInline",this.parseMarkdown(!1));te(this,"Parser",Ie);te(this,"Renderer",Jr);te(this,"TextRenderer",la);te(this,"Lexer",Te);te(this,"Tokenizer",Xr);te(this,"Hooks",Dn);this.use(...e)}walkTokens(e,t){var i,s;let n=[];for(const a of e)switch(n=n.concat(t.call(this,a)),a.type){case"table":{const o=a;for(const l of o.header)n=n.concat(this.walkTokens(l.tokens,t));for(const l of o.rows)for(const u of l)n=n.concat(this.walkTokens(u.tokens,t));break}case"list":{const o=a;n=n.concat(this.walkTokens(o.items,t));break}default:{const o=a;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{const u=o[l].flat(1/0);n=n.concat(this.walkTokens(u,t))}):o.tokens&&(n=n.concat(this.walkTokens(o.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const a=t.renderers[s.name];a?t.renderers[s.name]=function(...o){let l=s.renderer.apply(this,o);return l===!1&&(l=a.apply(this,o)),l}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),n.renderer){const s=this.defaults.renderer||new Jr(this.defaults);for(const a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;const o=a,l=n.renderer[o],u=s[o];s[o]=(...c)=>{let h=l.apply(s,c);return h===!1&&(h=u.apply(s,c)),h||""}}i.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new Xr(this.defaults);for(const a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;const o=a,l=n.tokenizer[o],u=s[o];s[o]=(...c)=>{let h=l.apply(s,c);return h===!1&&(h=u.apply(s,c)),h}}i.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new Dn;for(const a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;const o=a,l=n.hooks[o],u=s[o];Dn.passThroughHooks.has(a)?s[o]=c=>{if(this.defaults.async)return Promise.resolve(l.call(s,c)).then(p=>u.call(s,p));const h=l.call(s,c);return u.call(s,h)}:s[o]=(...c)=>{let h=l.apply(s,c);return h===!1&&(h=u.apply(s,c)),h}}i.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,a=n.walkTokens;i.walkTokens=function(o){let l=[];return l.push(a.call(this,o)),s&&(l=l.concat(s.call(this,o))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Te.lex(e,t??this.defaults)}parser(e,t){return Ie.parse(e,t??this.defaults)}parseMarkdown(e){return(n,i)=>{const s={...i},a={...this.defaults,...s},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&s.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=e);const l=a.hooks?a.hooks.provideLexer():e?Te.lex:Te.lexInline,u=a.hooks?a.hooks.provideParser():e?Ie.parse:Ie.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(c=>l(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>u(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));let c=l(n,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let h=u(c,a);return a.hooks&&(h=a.hooks.postprocess(h)),h}catch(c){return o(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Ge(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}}const Bt=new $m;function Z(r,e){return Bt.parse(r,e)}Z.options=Z.setOptions=function(r){return Bt.setOptions(r),Z.defaults=Bt.defaults,Zu(Z.defaults),Z};Z.getDefaults=ta;Z.defaults=zt;Z.use=function(...r){return Bt.use(...r),Z.defaults=Bt.defaults,Zu(Z.defaults),Z};Z.walkTokens=function(r,e){return Bt.walkTokens(r,e)};Z.parseInline=Bt.parseInline;Z.Parser=Ie;Z.parser=Ie.parse;Z.Renderer=Jr;Z.TextRenderer=la;Z.Lexer=Te;Z.lexer=Te.lex;Z.Tokenizer=Xr;Z.Hooks=Dn;Z.parse=Z;Z.options;Z.setOptions;Z.use;Z.walkTokens;Z.parseInline;const Pm=Z;Ie.parse;Te.lex;var Tm=Object.defineProperty,Im=Object.getOwnPropertyDescriptor,uc=(r,e,t,n)=>{for(var i=n>1?void 0:n?Im(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Tm(e,t,i),i};let gs=class extends ur{constructor(){super(...arguments),this.id=""}createRenderRoot(){return this}firstUpdated(e){}async prompt(e){var o,l,u,c;console.log(e.detail),Bl(e.detail);const t=((o=Me.integrations.find(h=>h.selected))==null?void 0:o.apiKey)??"ollama",n=((l=Me.integrations.find(h=>h.selected))==null?void 0:l.baseURL)??"http://127.0.0.1:11434/v1",i=((u=Me.integrations.find(h=>h.selected))==null?void 0:u.model)??"llama3.2",a=await Kp(t,n).chat.completions.create({messages:se.messages,model:i,stream:!0});for await(const h of a)dd(((c=h.choices[0].delta)==null?void 0:c.content)??"");Ft(()=>{let h=!1;gt.chats=gt.chats.map(p=>(p.id===se.id&&(p.messages=se.messages,h=!0),p)),h||(gt.chats=[...gt.chats,{id:se.id,title:"Untitled Conversation",messages:se.messages}])})}render(){return G` <div class="flex-1 flex flex-col h-full overflow-hidden">
      <!-- Chat Messages -->
      <div class="flex-1 overflow-y-auto p-4 text-xs">
        ${se.messages.map(e=>G` <div
            class="chat ${e.role==="assistant"?"chat-start":"chat-end"}"
          >
            <div class="chat-bubble bg-gray-700 text-gray-100">
              ${zd(Pm(e.content))}
            </div>
          </div>`)}
      </div>

      <!-- Message Input Area -->
      <x-prompt @submit="${this.prompt}"></x-prompt>
    </div>`}};uc([rr({type:String})],gs.prototype,"id",2);gs=uc([We("x-chat")],gs);let Mm=class extends le{createRenderRoot(){return this}startNewChat(e){const t=jl();Bl(e.detail),window.location.href=`/chat/${t}`}firstUpdated(e){}render(){return G`<div class="flex flex-col w-full items-center justify-center">
      <dotlottie-player
        src="https://lottie.host/abb6b1b2-0821-439d-a438-0684acbfb013/qTEczEobzl.lottie"
        background="transparent"
        speed="1"
        style="width: 300px; height: 300px"
        loop
        autoplay
      ></dotlottie-player>
      <x-prompt @submit="${this.startNewChat}"></x-prompt>
    </div>`}};customElements.define("x-homepage",Mm);const cc="general-settings";function fc(r){document.documentElement.dataset.theme=`remembrain-${r}`}const Pt=ai({theme:"dark"});At.getItem(cc).then(r=>{r&&Ft(()=>{Pt.theme=r.theme,fc(r.theme)})});xs(()=>[Pt.theme],()=>{At.setItem(cc,Pt),fc(Pt.theme)});let Nm=class extends ur{createRenderRoot(){return this}changeTheme(e){Ft(()=>{Pt.theme=e})}purgeDB(){confirm("Are you sure you want to delete all data?")&&At.dropInstance()}render(){return G`<div class="">
      <h1 class="text-xl">General Settings</h1>
      <div class="border-1 border-primary p-2 mb-3">
        <h2 class="text-lg">Theme</h2>
        <div class="join">
          <label
            @click="${()=>this.changeTheme("light")}"
            for="lighttheme-checkbox"
            class="btn join-item ${Pt.theme==="light"?"btn-primary":""}"
            >Light</label
          >
          <label
            @click="${()=>this.changeTheme("dark")}"
            for="darktheme-checkbox"
            class="btn join-item ${Pt.theme==="dark"?"btn-primary":""}"
            >Dark</label
          >
        </div>
      </div>
      <div class="border-1 border-primary p-2 mb-3">
        <h2 class="text-lg">Delete all data</h2>
        <button class="btn btn-error" @click="${this.purgeDB}">Delete</button>
      </div>
    </div>`}};customElements.define("x-settings-general",Nm);var Lm=Object.defineProperty,Dm=Object.getOwnPropertyDescriptor,hc=(r,e,t,n)=>{for(var i=n>1?void 0:n?Dm(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Lm(e,t,i),i};let bs=class extends ur{constructor(){super(...arguments),this.integrations=[]}createRenderRoot(){return this}addIntegration(){const e=this.querySelector("select").value;this.integrations=[...this.integrations,e],console.log("Adding integration",e)}updateIntegration(e,t,n){console.log("Updating integration",e,t,n),Ft(()=>{Me.integrations=Me.integrations.map((i,s)=>s===e?{...i,[t]:n}:i)})}render(){return G`<div
      class="[&_h1]:text-xl [&_h1]:mt-2 [&_h1]:mb-2 p-3 [&_.form-control]:flex [&_.form-control_label]:flex-1 [&_.form-control_label]:border-b-1 [&_.form-control_label]:border-dashed [&_.form-control_label]:border-b-neutral"
    >
      <h1>AI Settings</h1>
      ${Me.integrations.map((e,t)=>G`<div
          class="[&_h2]:text-lg [&_h2]:border-b-1 [&_h2]:border-b-primary *:mt-2 *:mb-3 pb-10"
        >
          <h2>${e.name}</h2>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Base URL</span>
            </label>
            <input
              type="text"
              class="input input-bordered "
              .value=${e.baseURL}
              @input=${n=>this.updateIntegration(t,"baseURL",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">API Key</span>
            </label>
            <input
              type="password"
              class="input input-bordered "
              .value=${e.apiKey}
              placeholder="sk-***"
              @input=${n=>this.updateIntegration(t,"apiKey",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Model</span>
            </label>
            <input
              type="text"
              class="input input-bordered settingfield"
              .value=${e.model}
              @input=${n=>this.updateIntegration(t,"model",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Embedding Model</span>
            </label>
            <input
              type="text"
              class="input input-bordered "
              .value=${e.embeddingModel}
              @input=${n=>this.updateIntegration(t,"embeddingModel",n.target.value)}
            />
          </div>
        </div> `)}
    </div>`}};hc([Wl()],bs.prototype,"integrations",2);bs=hc([We("x-settings-integrations")],bs);var Bm=Object.getOwnPropertyDescriptor,ut=(r,e,t,n)=>{for(var i=n>1?void 0:n?Bm(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(i)||i);return i};let Mo=class extends le{createRenderRoot(){return this}render(){return G`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        fill-rule="evenodd"
        d="M9 2.221V7H4.221a2 2 0 0 1 .365-.5L8.5 2.586A2 2 0 0 1 9 2.22ZM11 2v5a2 2 0 0 1-2 2H4v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-7Z"
        clip-rule="evenodd"
      />
    </svg>`}};Mo=ut([We("icon-file")],Mo);let No=class extends le{createRenderRoot(){return this}render(){return G`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m4.988 19.012 5.41-5.41m2.366-6.424 4.058 4.058-2.03 5.41L5.3 20 4 18.701l3.355-9.494 5.41-2.029Zm4.626 4.625L12.197 6.61 14.807 4 20 9.194l-2.61 2.61Z"
      />
    </svg> `}};No=ut([We("icon-pen")],No);let Lo=class extends le{createRenderRoot(){return this}render(){return G`<svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="size-6 inline-block"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"
      />
    </svg>`}};Lo=ut([We("icon-stack")],Lo);let Do=class extends le{createRenderRoot(){return this}render(){return G`
      <svg
        class="w-6 h-6  dark:text-white inline-block"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 7.757v8.486M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
        />
      </svg>
    `}};Do=ut([We("icon-plus")],Do);let Bo=class extends le{createRenderRoot(){return this}render(){return G` <svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        fill-rule="evenodd"
        d="M9 7V2.221a2 2 0 0 0-.5.365L4.586 6.5a2 2 0 0 0-.365.5H9Zm2 0V2h7a2 2 0 0 1 2 2v6.41A7.5 7.5 0 1 0 10.5 22H6a2 2 0 0 1-2-2V9h5a2 2 0 0 0 2-2Z"
        clip-rule="evenodd"
      />
      <path
        fill-rule="evenodd"
        d="M9 16a6 6 0 1 1 12 0 6 6 0 0 1-12 0Zm6-3a1 1 0 0 1 1 1v1h1a1 1 0 1 1 0 2h-1v1a1 1 0 1 1-2 0v-1h-1a1 1 0 1 1 0-2h1v-1a1 1 0 0 1 1-1Z"
        clip-rule="evenodd"
      />
    </svg>`}};Bo=ut([We("icon-plus-file")],Bo);let jo=class extends le{createRenderRoot(){return this}render(){return G` <svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M14 8H4m8 3.5v5M9.5 14h5M4 6v13a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1h-5.032a1 1 0 0 1-.768-.36l-1.9-2.28a1 1 0 0 0-.768-.36H5a1 1 0 0 0-1 1Z"
      />
    </svg>`}};jo=ut([We("icon-plus-folder")],jo);let Fo=class extends le{createRenderRoot(){return this}render(){return G`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
      />
    </svg> `}};Fo=ut([We("icon-edit")],Fo);let Uo=class extends le{createRenderRoot(){return this}render(){return G`
      <svg
        class="w-6 h-6  dark:text-white inline-block"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
        />
      </svg>
    `}};Uo=ut([We("icon-trash")],Uo);let zo=class extends le{createRenderRoot(){return this}render(){return G`<svg
      xmlns="http://www.w3.org/2000/svg"
      width="1280"
      height="314.982"
      fill="#0f0f0f"
      viewBox="0 0 338.667 83.339"
      id="openai"
      class="dark:text-white"
    >
      <path
        stroke="currentColor"
        d="M200.154 32.427v.028c-.169 0-.339.028-.508.028s-.339-.028-.508-.028c-10.075 0-16.312 6.294-16.312 16.397v4.967c0 9.736 6.322 15.776 16.453 15.776a4.38 4.38 0 0 0 .621-.028c.141 0 .254.028.395.028 6.801 0 11.543-2.483 14.562-7.62l-6.011-3.472c-2.004 2.963-4.685 5.193-8.523 5.193-5.136 0-8.212-3.161-8.212-8.495V53.79h23.819v-5.87c0-9.426-6.18-15.494-15.776-15.494zm-.508 5.786c4.685.226 7.507 3.33 7.507 8.438v1.411h-15.07v-.819c0-5.644 2.681-8.805 7.563-9.031zm-36.998-5.758c-4.487 0-8.353 1.863-10.385 4.967l-.508.79v-4.911h-8.523v47.667h8.946v-16.65l.508.762c1.919 2.85 5.673 4.543 10.047 4.543h.226.197c7.366 0 14.788-4.798 14.788-15.55v-6.039c0-7.733-4.572-15.55-14.845-15.55l-.056-.028h-.197zm-2.088 6.717c5.193.085 8.41 3.612 8.41 9.257v5.192c0 5.644-3.246 9.144-8.495 9.257-4.882-.085-8.297-3.81-8.297-9.116v-5.334c0-5.362 3.443-9.144 8.382-9.257zm115.934-18.485l-17.215 48.09h9.68l3.302-10.301h18.795v.113l3.302 10.216h9.68l-17.243-48.09h-1.016l-.028-.028zm5.137 8.269l7.196 22.719h-14.45zm57.035-1.496v-6.773h-29.52v6.773h10.357v34.487h-10.357v6.773h29.52v-6.773h-10.357V27.46zm-97.139 4.996h-.254-.141c-4.995 0-8.551 1.693-10.301 4.939l-.536.988v-5.08h-8.523v35.446h8.946v-21.11c0-4.967 2.681-7.817 7.309-7.902 4.431.085 6.971 2.879 6.971 7.705v21.307h8.946V45.917c0-8.438-4.628-13.462-12.389-13.462zM114.473 19.699c-13.18 0-21.392 8.213-21.392 21.449v7.14c0 13.236 8.184 21.448 21.392 21.448h.198.197c13.18 0 21.392-8.212 21.392-21.448v-7.14c0-13.236-8.212-21.449-21.392-21.449h-.197zm.198 7.169c7.846.085 12.361 5.108 12.361 13.8v8.128c0 8.692-4.515 13.716-12.361 13.8-7.846-.085-12.362-5.108-12.362-13.8v-8.128c0-8.692 4.516-13.716 12.362-13.8zM36.751.001c-9.116 0-17.215 5.87-20.038 14.534A20.83 20.83 0 0 0 2.828 24.61C-1.744 32.512-.7 42.446 5.425 49.219 3.534 54.892 4.183 61.1 7.203 66.237c4.544 7.93 13.687 11.994 22.634 10.103a20.78 20.78 0 0 0 15.635 6.999c9.116 0 17.215-5.87 20.038-14.534 5.87-1.214 10.922-4.883 13.857-10.075 4.6-7.902 3.556-17.836-2.568-24.609v-.028a20.76 20.76 0 0 0-1.778-17.046C70.476 9.145 61.332 5.08 52.414 6.971A20.86 20.86 0 0 0 36.751.001zm0 5.419l-.028.028c3.669 0 7.197 1.27 10.019 3.613-.113.056-.339.197-.508.282L29.64 18.91c-.847.48-1.355 1.383-1.355 2.371v22.464l-7.14-4.12v-18.57A15.63 15.63 0 0 1 36.751 5.419zm19.99 6.54a15.62 15.62 0 0 1 13.566 7.825c1.806 3.161 2.483 6.858 1.862 10.442-.113-.085-.338-.197-.48-.282l-16.594-9.596a2.78 2.78 0 0 0-2.737 0L32.913 31.581V23.34l16.058-9.285a15.54 15.54 0 0 1 7.77-2.096zm-41.043 8.53v19.727c0 .988.508 1.863 1.355 2.371l19.416 11.204L29.3 57.94l-16.03-9.257a15.63 15.63 0 0 1-5.7-21.336 15.65 15.65 0 0 1 8.128-6.858zm37.196 4.882l16.058 9.257c7.479 4.318 10.018 13.857 5.7 21.336l.028.028c-1.834 3.161-4.713 5.588-8.128 6.83V43.095c0-.988-.508-1.891-1.355-2.37L45.753 29.492zm-11.797 6.802l8.185 4.741v9.454l-8.185 4.741-8.184-4.741v-9.454zm12.869 7.451l7.14 4.12v18.542c0 8.636-6.999 15.635-15.606 15.635v-.028c-3.641 0-7.197-1.27-9.991-3.612.113-.056.367-.198.508-.283l16.594-9.567c.847-.48 1.383-1.383 1.354-2.371zM49.309 51.76V60l-16.058 9.257c-7.479 4.29-17.018 1.75-21.336-5.701h.028c-1.834-3.133-2.484-6.858-1.863-10.442.113.085.339.197.48.282l16.594 9.596a2.78 2.78 0 0 0 2.737 0z"
      ></path>
    </svg>`}};zo=ut([We("icon-openai")],zo);var jm=Object.defineProperty,Fm=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&jm(e,t,i),i};let dc=class extends le{constructor(){super(...arguments),this.type="openai"}createRenderRoot(){return this}render(){return G`<div class="p-4 border">
      <h1>Integration setting</h1>
      ${this.type==="openai"?G`<icon-openai></icon-openai>`:""}
    </div>`}};Fm([rr({type:String})],dc.prototype,"type");customElements.define("x-integration-setting",dc);let Um=class extends le{createRenderRoot(){return this}render(){return G`<h1 class="font-bold text-2xl inline-block">
      Remembr<span
        class="bg-linear-to-r from-cyan-500 to-blue-400 bg-clip-text text-transparent"
        >AI</span
      >n
    </h1>`}};customElements.define("x-logo",Um);let zm=class extends le{createRenderRoot(){return this}newChat(){const e=Math.random().toString(36).substring(7);window.location.href=`/chat/${e}`}render(){return G`<nav class="border-b border-gray-700">
      <div class="flex items-center justify-between h-16 px-4">
        <label
          for="drawer-toggle"
          class="p-2 rounded-md text-gray-400 hover:text-gray-200 hover:bg-gray-700 cursor-pointer"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            ></path>
          </svg>
        </label>
        <a href="/">
          <h1 class="text-2xl font-bold font-[Permanent_Marker]">
            Remembr<span
              class="bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-secondary)] bg-clip-text text-transparent"
              >AI</span
            >n
          </h1></a
        >

        <div class="">
          <a href="/chat" class="btn btn-primary btn-sm">
            <svg
              class="w-6 h-6 text-gray-800 dark:text-white"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
              />
            </svg>
            <span class="dark:text-white">New Chat</span>
          </a>
        </div>
      </div>
    </nav>`}};customElements.define("x-navbar",zm);async function Vm({allowedExtensions:r=["pdf","txt","md"]}){const e=document.createElement("input");return e.type="file",e.multiple=!0,e.accept=r.map(t=>`.${t}`).join(","),e.click(),new Promise(t=>{e.onchange=n=>{const s=n.target.files;if(!s)return t([]);t(Array.from(s))}})}Array.prototype.find||(Array.prototype.find=function(r){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof r!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),t=e.length>>>0,n=arguments[1],i,s=0;s<t;s++)if(i=e[s],r.call(n,i,s,e))return i});if(window&&typeof window.CustomEvent!="function"){let r=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};typeof window.Event<"u"&&(r.prototype=window.Event.prototype),window.CustomEvent=r}class Yr{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,t){e.shouldDeactivate(t)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let n=this;e.commandEvent=!1,Yr.keys().forEach(i=>{i.key===t.keyCode&&(e.commandEvent=!0,e.callbacks()[i.value.toLowerCase()](t,n))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let n=e.tribute;if(n.menu&&n.menu.contains(t.target)){let i=t.target;for(t.preventDefault(),t.stopPropagation();i.nodeName.toLowerCase()!=="li";)if(i=i.parentNode,!i||i===n.menu)throw new Error("cannot find the <li> container for the click");n.selectItemAtIndex(i.getAttribute("data-index"),t),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout(()=>n.hideMenu()))}keyup(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{let n=e.getKeyCode(e,this,t);if(isNaN(n)||!n)return;let i=e.tribute.triggers().find(s=>s.charCodeAt(0)===n);typeof i<"u"&&e.callbacks().triggerChar(t,this,i)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let t=!1;return Yr.keys().forEach(n=>{e.keyCode===n.key&&(t=!0)}),!t}return!1}getKeyCode(e,t,n){let i=e.tribute,s=i.range.getTriggerInfo(!1,i.hasTrailingSpace,!0,i.allowSpaces,i.autocompleteMode);return s?s.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,n)=>{let i=this.tribute;i.current.trigger=n;let s=i.collection.find(a=>a.trigger===n);i.current.collection=s,i.current.mentionText.length>=i.current.collection.menuShowMinLength&&i.inputEvent&&i.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,i=this.tribute.menuSelected;n>i&&i>0?(this.tribute.menuSelected--,this.setActiveLi()):i===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,i=this.tribute.menuSelected;n>i?(this.tribute.menuSelected++,this.setActiveLi()):n===i&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll("li"),n=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let i=0;i<n;i++){let s=t[i];if(i===this.tribute.menuSelected){s.classList.add(this.tribute.current.collection.selectClass);let a=s.getBoundingClientRect(),o=this.tribute.menu.getBoundingClientRect();if(a.bottom>o.bottom){let l=a.bottom-o.bottom;this.tribute.menu.scrollTop+=l}else if(a.top<o.top){let l=o.top-a.top;this.tribute.menu.scrollTop-=l}}else s.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let n=e.getBoundingClientRect().height;if(t){let i=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(i.marginTop)+parseFloat(i.marginBottom)}return n}}class Hm{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.showMenuFor(this.tribute.current.element,!1)},300,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.range.positionMenuAtCaret(!0)},300,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,t,n){var i;return()=>{var s=this,a=arguments,o=()=>{i=null,n||e.apply(s,a)},l=n&&!i;clearTimeout(i),i=setTimeout(o,t),l&&e.apply(s,a)}}}class Wm{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,n,i=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof i<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(t.element)?n=this.getContentEditableCaretPosition(i.mentionPosition):n=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,i.mentionPosition),this.tribute.menu.style.cssText=`top: ${n.top}px;
                                     left: ${n.left}px;
                                     right: ${n.right}px;
                                     bottom: ${n.bottom}px;
                                     position: absolute;
                                     display: block;`,n.left==="auto"&&(this.tribute.menu.style.left="auto"),n.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView(),window.setTimeout(()=>{let s={width:this.tribute.menu.offsetWidth,height:this.tribute.menu.offsetHeight},a=this.isMenuOffScreen(n,s),o=window.innerWidth>s.width&&(a.left||a.right),l=window.innerHeight>s.height&&(a.top||a.bottom);(o||l)&&(this.tribute.menu.style.cssText="display: none",this.positionMenuAtCaret(e))},0)}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,n){let i,s=e;if(t)for(var a=0;a<t.length;a++){if(s=s.childNodes[t[a]],s===void 0)return;for(;s.length<n;)n-=s.length,s=s.nextSibling;s.childNodes.length===0&&!s.length&&(s=s.previousSibling)}let o=this.getWindowSelection();i=this.getDocument().createRange(),i.setStart(s,n),i.setEnd(s,n),i.collapse(!0);try{o.removeAllRanges()}catch{}o.addRange(i),e.focus()}replaceTriggerText(e,t,n,i,s){let a=this.getTriggerInfo(!0,n,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(a!==void 0){let o=this.tribute.current,l=new CustomEvent("tribute-replaced",{detail:{item:s,instance:o,context:a,event:i}});if(this.isContentEditable(o.element)){let u=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:"";e+=u;let c=a.mentionPosition+a.mentionText.length;this.tribute.autocompleteMode||(c+=a.mentionTriggerChar.length),this.pasteHtml(e,a.mentionPosition,c)}else{let u=this.tribute.current.element,c=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=c;let h=a.mentionPosition,p=a.mentionPosition+a.mentionText.length+c.length;this.tribute.autocompleteMode||(p+=a.mentionTriggerChar.length-1),u.value=u.value.substring(0,h)+e+u.value.substring(p,u.value.length),u.selectionStart=h+e.length,u.selectionEnd=h+e.length}o.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),o.element.dispatchEvent(l)}}pasteHtml(e,t,n){let i,s;s=this.getWindowSelection(),i=this.getDocument().createRange(),i.setStart(s.anchorNode,t),i.setEnd(s.anchorNode,n),i.deleteContents();let a=this.getDocument().createElement("div");a.innerHTML=e;let o=this.getDocument().createDocumentFragment(),l,u;for(;l=a.firstChild;)u=o.appendChild(l);i.insertNode(o),u&&(i=i.cloneRange(),i.setStartAfter(u),i.collapse(!0),s.removeAllRanges(),s.addRange(i))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),n=t.anchorNode,i=[],s;if(n!=null){let a,o=n.contentEditable;for(;n!==null&&o!=="true";)a=this.getNodePositionInParent(n),i.push(a),n=n.parentNode,n!==null&&(o=n.contentEditable);return i.reverse(),s=t.getRangeAt(0).startOffset,{selected:n,path:i,offset:s}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t="";if(this.isContentEditable(e.element)){let n=this.getWindowSelection().anchorNode;if(n!=null){let i=n.textContent,s=this.getWindowSelection().getRangeAt(0).startOffset;i&&s>=0&&(t=i.substring(0,s))}}else{let n=this.tribute.current.element;if(n){let i=n.selectionStart;n.value&&i>=0&&(t=n.value.substring(0,i))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g," ");let t=e.split(/\s+/),n=t.length-1;return t[n].trim()}getTriggerInfo(e,t,n,i,s){let a=this.tribute.current,o,l,u;if(!this.isContentEditable(a.element))o=this.tribute.current.element;else{let p=this.getContentEditableSelectedPath(a);p&&(o=p.selected,l=p.path,u=p.offset)}let c=this.getTextPrecedingCurrentSelection(),h=this.getLastWordInText(c);if(s)return{mentionPosition:c.length-h.length,mentionText:h,mentionSelectedElement:o,mentionSelectedPath:l,mentionSelectedOffset:u};if(c!=null){let p=-1,v;if(this.tribute.collection.forEach(y=>{let w=y.trigger,x=y.requireLeadingSpace?this.lastIndexWithLeadingSpace(c,w):c.lastIndexOf(w);x>p&&(p=x,v=w,n=y.requireLeadingSpace)}),p>=0&&(p===0||!n||/[\xA0\s]/g.test(c.substring(p-1,p)))){let y=c.substring(p+v.length,c.length);v=c.substring(p,p+v.length);let w=y.substring(0,1),x=y.length>0&&(w===" "||w==="");t&&(y=y.trim());let B=i?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=B.test(y),!x&&(e||!B.test(y)))return{mentionPosition:p,mentionText:y,mentionSelectedElement:o,mentionSelectedPath:l,mentionSelectedOffset:u,mentionTriggerChar:v}}}}lastIndexWithLeadingSpace(e,t){let n=e.split("").reverse().join(""),i=-1;for(let s=0,a=e.length;s<a;s++){let o=s===e.length-1,l=/\s/.test(n[s+1]),u=!0;for(let c=t.length-1;c>=0;c--)if(t[c]!==n[s-c]){u=!1;break}if(u&&(o||l)){i=e.length-1-s;break}}return i}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,t){let n=window.innerWidth,i=window.innerHeight,s=document.documentElement,a=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),o=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),l=typeof e.top=="number"?e.top:o+i-e.bottom-t.height,u=typeof e.right=="number"?e.right:e.left+t.width,c=typeof e.bottom=="number"?e.bottom:e.top+t.height,h=typeof e.left=="number"?e.left:a+n-e.right-t.width;return{top:l<Math.floor(o),right:u>Math.ceil(a+n),bottom:c>Math.ceil(o+i),left:h<Math.floor(a)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,t,n){let i=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],s=window.mozInnerScreenX!==null,a=this.getDocument().createElement("div");a.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(a);let o=a.style,l=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",i.forEach(P=>{o[P]=l[P]}),s?(o.width=`${parseInt(l.width)-2}px`,e.scrollHeight>parseInt(l.height)&&(o.overflowY="scroll")):o.overflow="hidden",a.textContent=e.value.substring(0,t),e.nodeName==="INPUT"&&(a.textContent=a.textContent.replace(/\s/g,""));let u=this.getDocument().createElement("span");u.textContent=e.value.substring(t)||".",a.appendChild(u);let c=e.getBoundingClientRect(),h=document.documentElement,p=(window.pageXOffset||h.scrollLeft)-(h.clientLeft||0),v=(window.pageYOffset||h.scrollTop)-(h.clientTop||0),y=0,w=0;this.menuContainerIsBody&&(y=c.top,w=c.left);let x={top:y+v+u.offsetTop+parseInt(l.borderTopWidth)+parseInt(l.fontSize)-e.scrollTop,left:w+p+u.offsetLeft+parseInt(l.borderLeftWidth)},B=window.innerWidth,C=window.innerHeight,L=this.getMenuDimensions(),I=this.isMenuOffScreen(x,L);I.right&&(x.right=B-x.left,x.left="auto");let S=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(I.bottom){let P=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),E=S-(C-P.top);x.bottom=E+(C-c.top-u.offsetTop),x.top="auto"}return I=this.isMenuOffScreen(x,L),I.left&&(x.left=B>L.width?p+B-L.width:p,delete x.right),I.top&&(x.top=C>L.height?v+C-L.height:v,delete x.bottom),this.getDocument().body.removeChild(a),x}getContentEditableCaretPosition(e){let t,n=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(n.anchorNode,e),t.setEnd(n.anchorNode,e),t.collapse(!1);let i=t.getBoundingClientRect(),s=document.documentElement,a=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),o=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),l=i.left,u=i.top,c={left:l+a,top:u+i.height+o},h=window.innerWidth,p=window.innerHeight,v=this.getMenuDimensions(),y=this.isMenuOffScreen(c,v);y.right&&(c.left="auto",c.right=h-i.left-a);let w=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(y.bottom){let x=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),B=w-(p-x.top);c.top="auto",c.bottom=B+(p-i.top)}return y=this.isMenuOffScreen(c,v),y.left&&(c.left=h>v.width?a+h-v.width:a,delete c.right),y.top&&(c.top=p>v.height?o+p-v.height:o,delete c.bottom),this.menuContainerIsBody||(c.left=c.left?c.left-this.tribute.menuContainer.offsetLeft:c.left,c.top=c.top?c.top-this.tribute.menuContainer.offsetTop:c.top),c}scrollIntoView(e){let t=20,n,i=100,s=this.menu;if(typeof s>"u")return;for(;n===void 0||n.height===0;)if(n=s.getBoundingClientRect(),n.height===0&&(s=s.childNodes[0],s===void 0||!s.getBoundingClientRect))return;let a=n.top,o=a+n.height;if(a<0)window.scrollTo(0,window.pageYOffset+n.top-t);else if(o>window.innerHeight){let l=window.pageYOffset+n.top-t;l-window.pageYOffset>i&&(l=window.pageYOffset+i);let u=window.pageYOffset-(window.innerHeight-o);u>l&&(u=l),window.scrollTo(0,u)}}}class qm{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(n=>this.test(e,n))}test(e,t){return this.match(e,t)!==null}match(e,t,n){n=n||{},t.length;let i=n.pre||"",s=n.post||"",a=n.caseSensitive&&t||t.toLowerCase();if(n.skip)return{rendered:t,score:0};e=n.caseSensitive&&e||e.toLowerCase();let o=this.traverse(a,e,0,0,[]);return o?{rendered:this.render(t,o.cache,i,s),score:o.score}:null}traverse(e,t,n,i,s){if(t.length===i)return{score:this.calculateScore(s),cache:s.slice()};if(e.length===n||t.length-i>e.length-n)return;let a=t[i],o=e.indexOf(a,n),l,u;for(;o>-1;){if(s.push(o),u=this.traverse(e,t,o+1,i+1,s),s.pop(),!u)return l;(!l||l.score<u.score)&&(l=u),o=e.indexOf(a,o+1)}return l}calculateScore(e){let t=0,n=1;return e.forEach((i,s)=>{s>0&&(e[s-1]+1===i?n+=n+1:n=1),t+=n}),t}render(e,t,n,i){var s=e.substring(0,t[0]);return t.forEach((a,o)=>{s+=n+e[a]+i+e.substring(a+1,t[o+1]?t[o+1]:e.length)}),s}filter(e,t,n){return n=n||{},t.reduce((i,s,a,o)=>{let l=s;n.extract&&(l=n.extract(s),l||(l=""));let u=this.match(e,l,n);return u!=null&&(i[i.length]={string:u.rendered,score:u.score,index:a,original:s}),i},[]).sort((i,s)=>{let a=s.score-i.score;return a||i.index-s.index})}}class pt{constructor({values:e=null,iframe:t=null,selectClass:n="highlight",containerClass:i="tribute-container",itemClass:s="",trigger:a="@",autocompleteMode:o=!1,selectTemplate:l=null,menuItemTemplate:u=null,lookup:c="key",fillAttr:h="value",collection:p=null,menuContainer:v=null,noMatchTemplate:y=null,requireLeadingSpace:w=!0,allowSpaces:x=!1,replaceTextSuffix:B=null,positionMenu:C=!0,spaceSelectsMatch:L=!1,searchOpts:I={},menuItemLimit:S=null,menuShowMinLength:P=0}){if(this.autocompleteMode=o,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=v,this.allowSpaces=x,this.replaceTextSuffix=B,this.positionMenu=C,this.hasTrailingSpace=!1,this.spaceSelectsMatch=L,this.autocompleteMode&&(a="",x=!1),e)this.collection=[{trigger:a,iframe:t,selectClass:n,containerClass:i,itemClass:s,selectTemplate:(l||pt.defaultSelectTemplate).bind(this),menuItemTemplate:(u||pt.defaultMenuItemTemplate).bind(this),noMatchTemplate:(E=>typeof E=="string"?E.trim()===""?null:E:typeof E=="function"?E.bind(this):y||(function(){return"<li>No Match Found!</li>"}).bind(this))(y),lookup:c,fillAttr:h,values:e,requireLeadingSpace:w,searchOpts:I,menuItemLimit:S,menuShowMinLength:P}];else if(p)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=p.map(E=>({trigger:E.trigger||a,iframe:E.iframe||t,selectClass:E.selectClass||n,containerClass:E.containerClass||i,itemClass:E.itemClass||s,selectTemplate:(E.selectTemplate||pt.defaultSelectTemplate).bind(this),menuItemTemplate:(E.menuItemTemplate||pt.defaultMenuItemTemplate).bind(this),noMatchTemplate:(D=>typeof D=="string"?D.trim()===""?null:D:typeof D=="function"?D.bind(this):y||(function(){return"<li>No Match Found!</li>"}).bind(this))(y),lookup:E.lookup||c,fillAttr:E.fillAttr||h,values:E.values,requireLeadingSpace:E.requireLeadingSpace,searchOpts:E.searchOpts||I,menuItemLimit:E.menuItemLimit||S,menuShowMinLength:E.menuShowMinLength||P}));else throw new Error("[Tribute] No collection specified.");new Wm(this),new Yr(this),new Hm(this),new qm(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(pt.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let t=this.range.getDocument().createElement("div"),n=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(n),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const n=i=>{if(!this.isActive)return;let s=this.search.filter(this.current.mentionText,i,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:l=>{if(typeof this.current.collection.lookup=="string")return l[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(l,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(s=s.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=s;let a=this.menu.querySelector("ul");if(this.range.positionMenuAtCaret(t),!s.length){let l=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(l),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():typeof this.current.collection.noMatchTemplate=="function"?a.innerHTML=this.current.collection.noMatchTemplate():a.innerHTML=this.current.collection.noMatchTemplate;return}a.innerHTML="";let o=this.range.getDocument().createDocumentFragment();s.forEach((l,u)=>{let c=this.range.getDocument().createElement("li");c.setAttribute("data-index",u),c.className=this.current.collection.itemClass,c.addEventListener("mousemove",h=>{let[p,v]=this._findLiTarget(h.target);h.movementY!==0&&this.events.setActiveLi(v)}),this.menuSelected===u&&c.classList.add(this.current.collection.selectClass),c.innerHTML=this.current.collection.menuItemTemplate(l),o.appendChild(c)}),a.appendChild(o)};typeof this.current.collection.values=="function"?this.current.collection.values(this.current.mentionText,n):n(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(typeof document.body.createTextRange<"u"){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}}insertTextAtCursor(e){var t,n;t=window.getSelection(),n=t.getRangeAt(0),n.deleteContents();var i=document.createTextNode(e);n.insertNode(i),n.selectNodeContents(i),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}insertAtCaret(e,t){var n=e.scrollTop,i=e.selectionStart,s=e.value.substring(0,i),a=e.value.substring(e.selectionEnd,e.value.length);e.value=s+t+a,i=i+t.length,e.selectionStart=i,e.selectionEnd=i,e.focus(),e.scrollTop=n}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let n=this.current.filteredItems[e],i=this.current.collection.selectTemplate(n);i!==null&&this.replaceText(i,t,n)}replaceText(e,t,n){this.range.replaceTriggerText(e,!0,!0,t,n)}_append(e,t,n){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");n?e.values=t:e.values=e.values.concat(t)}append(e,t,n){let i=parseInt(e);if(typeof i!="number")throw new Error("please provide an index for the collection to update.");let s=this.collection[i];this._append(s,t,n)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}var Km=Object.defineProperty,Gm=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&Km(e,t,i),i};let pc=class extends ur{constructor(){super(...arguments),this.files=[]}createRenderRoot(){return this}async attach(){const e=await Vm({});this.files=e}selectIntegration(e){const t=e.target;Ft(()=>{Me.integrations=Me.integrations.map(n=>n.name===t.value?{...n,selected:!0}:{...n,selected:!1})})}submit(){const e=this.querySelector("#message-input");this.dispatchEvent(new CustomEvent("submit",{detail:e.innerText})),this.querySelector("#message-input").innerHTML=""}keydown(e){e.key==="Enter"&&e.metaKey&&this.submit()}firstUpdated(e){super.firstUpdated(e);const t=new pt({selectClass:"text-primary",itemClass:"",containerClass:"card bg-black text-primary-content p-2",values:async function(i,s){console.log(`Searching for ${i}`),await new Promise(a=>setTimeout(a,1e3)),s([{key:"Phil",value:"Phil"},{key:"Bob",value:"Bob"},{key:"Alice",value:"Alice"},{key:"Dave",value:"Dave"}])}}),n=new pt({trigger:"/",selectClass:"text-primary",itemClass:"",containerClass:"card bg-black text-primary-content p-2",values:async function(i,s){console.log(`Command select for ${i}`),await new Promise(a=>setTimeout(a,1e3)),s([{key:"Command 1",value:""},{key:"Command 2",value:""}])}});t.attach(this.querySelector("#message-input")),n.attach(this.querySelector("#message-input"))}render(){return G`<div class="border-t border-gray-700 p-4">
      <div class="relative">
        <div
          id="message-input"
          class="text-xs empty:before:content-[attr(data-placeholder)] w-full max-h-36 p-4 pr-10 resize-none overflow-y-scroll rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-800 text-gray-100"
          contenteditable="true"
          data-placeholder="Type your message here..."
          @keydown="${this.keydown}"
          autofocus
        ></div>

        <div class="grid grid-cols-5 mt-2">
          <!-- Option Buttons -->
          <div class="col-span-4 align-center flex *:mr-1">
            <button class="btn btn-sm" @click="${this.attach}">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="size-6 dark:text-white"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"
                />
              </svg>
              <span class="hidden md:inline-block"> Attach </span>${this.files.length>0?`(${this.files.length})`:""}
            </button>
            <input type="checkbox" id="web" class="hidden peer/web" />
            <label
              for="web"
              class="btn btn-sm peer-checked/web:btn-primary hidden because_this_functionality_is_not_implemented_yet"
            >
              <svg
                class="w-6 h-6 text-gray-800 dark:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-width="2"
                  d="M4.37 7.657c2.063.528 2.396 2.806 3.202 3.87 1.07 1.413 2.075 1.228 3.192 2.644 1.805 2.289 1.312 5.705 1.312 6.705M20 15h-1a4 4 0 0 0-4 4v1M8.587 3.992c0 .822.112 1.886 1.515 2.58 1.402.693 2.918.351 2.918 2.334 0 .276 0 2.008 1.972 2.008 2.026.031 2.026-1.678 2.026-2.008 0-.65.527-.9 1.177-.9H20M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
                />
              </svg>
              <span class="hidden md:inline-block"> Search Web </span>
            </label>
            <select
              @input=${this.selectIntegration}
              class="select select-primary select-sm w-32"
            >
              <option disabled selected>Model</option>
              ${Me.integrations.map(e=>G`<option .selected="${e.selected}">
                    ${e.name}
                  </option>`)}
            </select>
          </div>
          <div class="col-span-1 flex justify-end">
            <button role="button" @click="${this.submit}" class="btn btn-sm">
              <svg
                class="w-6 h-6 text-gray-800 dark:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="m12 18-7 3 7-18 7 18-7-3Zm0 0v-5"
                />
              </svg>
              Send
            </button>
          </div>
        </div>
      </div>
    </div>`}};Gm([rr({type:Array})],pc.prototype,"files");customElements.define("x-prompt",pc);function Xm(r){let e=0,t=!1;window.addEventListener("keydown",n=>{r.compare(n)&&(e=setTimeout(()=>{r.callback(),t=!0},r.time))}),window.addEventListener("keyup",n=>{r.compare(n)&&(clearTimeout(e),t&&r.cancel&&(t=!1,r.cancel()))})}var Jm=Object.defineProperty,mc=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&Jm(e,t,i),i};let ua=class extends le{constructor(){super(...arguments),this.keys=[["Meta"]],this.metaDown=!1}createRenderRoot(){return this}firstUpdated(e){super.firstUpdated(e);const t=document.querySelectorAll("x-shortcut-tip");if(t.length>1){console.warn("Shortcut tip already mounted!");const i=Array.from(t).map(s=>s.parentElement);console.log("Mounted parents:",i);return}const n=this.querySelector("dialog");Xm({compare:i=>i.code==="MetaLeft",time:1e3,callback:()=>{n==null||n.showModal()},cancel:()=>{n==null||n.close()}})}render(){return G`
      <dialog id="my_modal_3" class="modal">
        <div class="modal-box">
          <form method="dialog">
            <button
              class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2"
            >
              
            </button>
          </form>
          <div>
            <div class="overflow-x-auto">
              <table class="table table-xs">
                <thead>
                  <tr>
                    <th></th>
                    <th>Name</th>
                    <th>Hotkey</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>Show this screen</td>
                    <td><kbd class="kbd">K</kbd></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </dialog>
    `}};mc([rr({type:Array})],ua.prototype,"keys");mc([Wl()],ua.prototype,"metaDown");customElements.define("x-shortcut-tip",ua);class Ym extends ur{createRenderRoot(){return this}render(){return G`<div class=" overflow-y-scroll h-full">
      <div class="p-4 border-b border-gray-700">
        <h2 class="text-xl font-bold font-[Permanent_marker]">Menu</h2>
      </div>

      <!-- Accordion Menu -->

      <!-- Chats Section -->
      <details class="group border-b border-gray-700 marker:content-none" open>
        <summary
          class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
        >
          <span class="font-medium font-[Permanent_marker]">Chats</span>
          <svg
            class="w-5 h-5 transition-transform duration-200 group-open:rotate-180"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </summary>
        <div
          class="p-2 *:block text-sm *:btn *:hover *:hover:btn-primary *:text-left *:mb-1"
        >
          ${gt.chats.map(e=>G`<a href="/chat/${e.id}" class="p-2">
                ${e.messages[0].content.slice(0,22)}
              </a>`)}
        </div>
      </details>
      <!-- Knowledgebase section -->

      <a
        href="/knowledgebase"
        class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
      >
        <span class="font-medium font-[permanent_marker]">Knowledgebase</span>
      </a>

      <!-- Settings Section -->
      <details class="group marker:content-none">
        <summary
          class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
        >
          <span class="font-medium font-[Permanent_marker]">Settings</span>
          <svg
            class="w-5 h-5 transition-transform duration-200 group-open:rotate-180"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </summary>
        <div
          class="p-2 text-sm *:block *:btn *:hover *:hover:btn-primary *:text-left *:mb-1"
        >
          <a href="/settings" class="block p-2"> General Settings </a>
          <a href="/settings/integrations" class="block p-2">
            AI Configuration
          </a>
        </div>
      </details>
    </div>`}}customElements.define("x-sidebar",Ym);globalThis.URLPattern||Ho(()=>import("./index-BuwMbGsw.js"),[]);export{ur as M,q as O,xs as a,Wl as b,At as d,Vm as f,pd as g,ai as m,rr as n,Ft as r,Rl as t,G as x};
