(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Sc="modulepreload",Ec=function(r){return"/remembrain-demo/"+r},ta={},lo=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(u=>{if(u=Ec(u),u in ta)return;ta[u]=!0;const f=u.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":Sc,f||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),f)return new Promise((_,b)=>{h.addEventListener("load",_),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const na=new WeakMap,ra=r=>{if((t=>t.pattern!==void 0)(r))return r.pattern;let e=na.get(r);return e===void 0&&na.set(r,e=new URLPattern({pathname:r.path})),e};let xc=class{constructor(e,t,n){this.routes=[],this.o=[],this.t={},this.i=i=>{if(i.routes===this)return;const s=i.routes;this.o.push(s),s.h=this,i.stopImmediatePropagation(),i.onDisconnect=()=>{var o;(o=this.o)==null||o.splice(this.o.indexOf(s)>>>0,1)};const a=ia(this.t);a!==void 0&&s.goto(a)},(this.l=e).addController(this),this.routes=[...t],this.fallback=n==null?void 0:n.fallback}link(e){var t;if(e!=null&&e.startsWith("/"))return e;if(e!=null&&e.startsWith("."))throw Error("Not implemented");return e??(e=this.u),(((t=this.h)==null?void 0:t.link())??"")+e}async goto(e){let t;if(this.routes.length===0&&this.fallback===void 0)t=e,this.u="",this.t={0:t};else{const n=this.p(e);if(n===void 0)throw Error("No route found for "+e);const i=ra(n).exec({pathname:e}),s=(i==null?void 0:i.pathname.groups)??{};if(t=ia(s),typeof n.enter=="function"&&await n.enter(s)===!1)return;this.v=n,this.t=s,this.u=t===void 0?e:e.substring(0,e.length-t.length)}if(t!==void 0)for(const n of this.o)n.goto(t);this.l.requestUpdate()}outlet(){var e,t;return(t=(e=this.v)==null?void 0:e.render)==null?void 0:t.call(e,this.t)}get params(){return this.t}p(e){const t=this.routes.find(n=>ra(n).test({pathname:e}));return t||this.fallback===void 0?t:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(Ai.eventName,this.i);const e=new Ai(this);this.l.dispatchEvent(e),this._=e.onDisconnect}hostDisconnected(){var e;(e=this._)==null||e.call(this),this.h=void 0}};const ia=r=>{let e;for(const t of Object.keys(r))/\d+/.test(t)&&(e===void 0||t>e)&&(e=t);return e&&r[e]};let Ai=class uo extends Event{constructor(e){super(uo.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=e}};Ai.eventName="lit-routes-connected";/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Cc=location.origin||location.protocol+"//"+location.host;let Oc=class extends xc{constructor(){super(...arguments),this.m=e=>{const t=e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey;if(e.defaultPrevented||t)return;const n=e.composedPath().find(a=>a.tagName==="A");if(n===void 0||n.target!==""||n.hasAttribute("download")||n.getAttribute("rel")==="external")return;const i=n.href;if(i===""||i.startsWith("mailto:"))return;const s=window.location;n.origin===Cc&&(e.preventDefault(),i!==s.href&&(window.history.pushState({},"",i),this.goto(n.pathname)))},this.R=e=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}};function K(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];throw new Error(typeof r=="number"?"[MobX] minified error nr: "+r+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+r)}var Rc={};function kr(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:Rc}var co=Object.assign,yr=Object.getOwnPropertyDescriptor,Ke=Object.defineProperty,kn=Object.prototype,Si=[];Object.freeze(Si);var Gi={};Object.freeze(Gi);var Pc=typeof Proxy<"u",$c=Object.toString();function fo(){Pc||K("Proxy not available")}function ho(r){var e=!1;return function(){if(!e)return e=!0,r.apply(this,arguments)}}var Ht=function(){};function De(r){return typeof r=="function"}function xt(r){var e=typeof r;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Nr(r){return r!==null&&typeof r=="object"}function tt(r){if(!Nr(r))return!1;var e=Object.getPrototypeOf(r);if(e==null)return!0;var t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t.toString()===$c}function po(r){var e=r==null?void 0:r.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function Dr(r,e,t){Ke(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function mo(r,e,t){Ke(r,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function dt(r,e){var t="isMobX"+r;return e.prototype[t]=!0,function(n){return Nr(n)&&n[t]===!0}}function rn(r){return r!=null&&Object.prototype.toString.call(r)==="[object Map]"}function Tc(r){var e=Object.getPrototypeOf(r),t=Object.getPrototypeOf(e),n=Object.getPrototypeOf(t);return n===null}function Qe(r){return r!=null&&Object.prototype.toString.call(r)==="[object Set]"}var go=typeof Object.getOwnPropertySymbols<"u";function Ic(r){var e=Object.keys(r);if(!go)return e;var t=Object.getOwnPropertySymbols(r);return t.length?[].concat(e,t.filter(function(n){return kn.propertyIsEnumerable.call(r,n)})):e}var xn=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:go?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames;function _o(r){return r===null?null:typeof r=="object"?""+r:r}function ct(r,e){return kn.hasOwnProperty.call(r,e)}var Mc=Object.getOwnPropertyDescriptors||function(e){var t={};return xn(e).forEach(function(n){t[n]=yr(e,n)}),t};function be(r,e){return!!(r&e)}function ye(r,e,t){return t?r|=e:r&=~e,r}function sa(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function kc(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Dc(n.key),n)}}function sn(r,e,t){return e&&kc(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Wt(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=Lc(r))||e){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yt(){return Yt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Yt.apply(null,arguments)}function vo(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Ei(r,e)}function Ei(r,e){return Ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ei(r,e)}function Nc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Dc(r){var e=Nc(r,"string");return typeof e=="symbol"?e:e+""}function Lc(r,e){if(r){if(typeof r=="string")return sa(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?sa(r,e):void 0}}var Kt=Symbol("mobx-stored-annotations");function qe(r){function e(t,n){if(Dn(n))return r.decorate_20223_(t,n);Nn(t,n,r)}return Object.assign(e,r)}function Nn(r,e,t){ct(r,Kt)||Dr(r,Kt,Yt({},r[Kt])),Hc(t)||(r[Kt][e]=t)}function Dn(r){return typeof r=="object"&&typeof r.kind=="string"}var L=Symbol("mobx administration"),pt=function(){function r(t){t===void 0&&(t="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=z.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t}var e=r.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return No(this)},e.reportChanged=function(){xe(),Do(this),Ce()},e.toString=function(){return this.name_},sn(r,[{key:"isBeingObserved",get:function(){return be(this.flags_,r.isBeingObservedMask_)},set:function(n){this.flags_=ye(this.flags_,r.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return be(this.flags_,r.isPendingUnobservationMask_)},set:function(n){this.flags_=ye(this.flags_,r.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return be(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=ye(this.flags_,r.diffValueMask_,n===1)}}])}();pt.isBeingObservedMask_=1;pt.isPendingUnobservationMask_=2;pt.diffValueMask_=4;var Yi=dt("Atom",pt);function bo(r,e,t){e===void 0&&(e=Ht),t===void 0&&(t=Ht);var n=new pt(r);return e!==Ht&&Xf(n,e),t!==Ht&&Ho(n,t),n}function Bc(r,e){return nl(r,e)}function jc(r,e){return Object.is?Object.is(r,e):r===e?r!==0||1/r===1/e:r!==r&&e!==e}var Qt={structural:Bc,default:jc};function Ct(r,e,t){return ts(r)?r:Array.isArray(r)?fe.array(r,{name:t}):tt(r)?fe.object(r,void 0,{name:t}):rn(r)?fe.map(r,{name:t}):Qe(r)?fe.set(r,{name:t}):typeof r=="function"&&!On(r)&&!Rn(r)?po(r)?Zt(r):Cn(t,r):r}function Uc(r,e,t){if(r==null||Vn(r)||Fn(r)||mt(r)||Te(r))return r;if(Array.isArray(r))return fe.array(r,{name:t,deep:!1});if(tt(r))return fe.object(r,void 0,{name:t,deep:!1});if(rn(r))return fe.map(r,{name:t,deep:!1});if(Qe(r))return fe.set(r,{name:t,deep:!1})}function Lr(r){return r}function Fc(r,e){return nl(r,e)?e:r}var Vc="override";function Hc(r){return r.annotationType_===Vc}function Ln(r,e){return{annotationType_:r,options_:e,make_:Wc,extend_:Kc,decorate_20223_:qc}}function Wc(r,e,t,n){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(r,e,t,!1)===null?0:1;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if(On(t.value))return 1;var s=yo(r,this,e,t,!1);return Ke(n,e,s),2}function Kc(r,e,t,n){var i=yo(r,this,e,t);return r.defineProperty_(e,i,n)}function qc(r,e){var t=e.kind,n=e.name,i=e.addInitializer,s=this,a=function(f){var d,h,_,b;return Ot((d=(h=s.options_)==null?void 0:h.name)!=null?d:n.toString(),f,(_=(b=s.options_)==null?void 0:b.autoAction)!=null?_:!1)};if(t=="field")return function(u){var f,d=u;return On(d)||(d=a(d)),(f=s.options_)!=null&&f.bound&&(d=d.bind(this),d.isMobxAction=!0),d};if(t=="method"){var o;return On(r)||(r=a(r)),(o=this.options_)!=null&&o.bound&&i(function(){var u=this,f=u[n].bind(u);f.isMobxAction=!0,u[n]=f}),r}K("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+t+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function zc(r,e,t,n){e.annotationType_,n.value}function yo(r,e,t,n,i){var s,a,o,u,f,d,h;i===void 0&&(i=T.safeDescriptors),zc(r,e,t,n);var _=n.value;if((s=e.options_)!=null&&s.bound){var b;_=_.bind((b=r.proxy_)!=null?b:r.target_)}return{value:Ot((a=(o=e.options_)==null?void 0:o.name)!=null?a:t.toString(),_,(u=(f=e.options_)==null?void 0:f.autoAction)!=null?u:!1,(d=e.options_)!=null&&d.bound?(h=r.proxy_)!=null?h:r.target_:void 0),configurable:i?r.isPlainObject_:!0,enumerable:!1,writable:!i}}function wo(r,e){return{annotationType_:r,options_:e,make_:Xc,extend_:Jc,decorate_20223_:Gc}}function Xc(r,e,t,n){var i;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!ct(r.target_,e)||!Rn(r.target_[e]))&&this.extend_(r,e,t,!1)===null)return 0;if(Rn(t.value))return 1;var s=Ao(r,this,e,t,!1,!1);return Ke(n,e,s),2}function Jc(r,e,t,n){var i,s=Ao(r,this,e,t,(i=this.options_)==null?void 0:i.bound);return r.defineProperty_(e,s,n)}function Gc(r,e){var t,n=e.name,i=e.addInitializer;return Rn(r)||(r=Zt(r)),(t=this.options_)!=null&&t.bound&&i(function(){var s=this,a=s[n].bind(s);a.isMobXFlow=!0,s[n]=a}),r}function Yc(r,e,t,n){e.annotationType_,n.value}function Ao(r,e,t,n,i,s){s===void 0&&(s=T.safeDescriptors),Yc(r,e,t,n);var a=n.value;if(Rn(a)||(a=Zt(a)),i){var o;a=a.bind((o=r.proxy_)!=null?o:r.target_),a.isMobXFlow=!0}return{value:a,configurable:s?r.isPlainObject_:!0,enumerable:!1,writable:!s}}function Qi(r,e){return{annotationType_:r,options_:e,make_:Qc,extend_:Zc,decorate_20223_:ef}}function Qc(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function Zc(r,e,t,n){return tf(r,this,e,t),r.defineComputedProperty_(e,Yt({},this.options_,{get:t.get,set:t.set}),n)}function ef(r,e){var t=this,n=e.name,i=e.addInitializer;return i(function(){var s=an(this)[L],a=Yt({},t.options_,{get:r,context:this});a.name||(a.name="ObservableObject."+n.toString()),s.values_.set(n,new Le(a))}),function(){return this[L].getObservablePropValue_(n)}}function tf(r,e,t,n){e.annotationType_,n.get}function Br(r,e){return{annotationType_:r,options_:e,make_:nf,extend_:rf,decorate_20223_:sf}}function nf(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function rf(r,e,t,n){var i,s;return af(r,this),r.defineObservableProperty_(e,t.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:Ct,n)}function sf(r,e){var t=this,n=e.kind,i=e.name,s=new WeakSet;function a(o,u){var f,d,h=an(o)[L],_=new ft(u,(f=(d=t.options_)==null?void 0:d.enhancer)!=null?f:Ct,"ObservableObject."+i.toString(),!1);h.values_.set(i,_),s.add(o)}if(n=="accessor")return{get:function(){return s.has(this)||a(this,r.get.call(this)),this[L].getObservablePropValue_(i)},set:function(u){return s.has(this)||a(this,u),this[L].setObservablePropValue_(i,u)},init:function(u){return s.has(this)||a(this,u),u}}}function af(r,e,t,n){e.annotationType_}var of="true",lf=So();function So(r){return{annotationType_:of,options_:r,make_:uf,extend_:cf,decorate_20223_:ff}}function uf(r,e,t,n){var i,s;if(t.get)return jr.make_(r,e,t,n);if(t.set){var a=Ot(e.toString(),t.set);return n===r.target_?r.defineProperty_(e,{configurable:T.safeDescriptors?r.isPlainObject_:!0,set:a})===null?0:2:(Ke(n,e,{configurable:!0,set:a}),2)}if(n!==r.target_&&typeof t.value=="function"){var o;if(po(t.value)){var u,f=(u=this.options_)!=null&&u.autoBind?Zt.bound:Zt;return f.make_(r,e,t,n)}var d=(o=this.options_)!=null&&o.autoBind?Cn.bound:Cn;return d.make_(r,e,t,n)}var h=((i=this.options_)==null?void 0:i.deep)===!1?fe.ref:fe;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var _;t.value=t.value.bind((_=r.proxy_)!=null?_:r.target_)}return h.make_(r,e,t,n)}function cf(r,e,t,n){var i,s;if(t.get)return jr.extend_(r,e,t,n);if(t.set)return r.defineProperty_(e,{configurable:T.safeDescriptors?r.isPlainObject_:!0,set:Ot(e.toString(),t.set)},n);if(typeof t.value=="function"&&(i=this.options_)!=null&&i.autoBind){var a;t.value=t.value.bind((a=r.proxy_)!=null?a:r.target_)}var o=((s=this.options_)==null?void 0:s.deep)===!1?fe.ref:fe;return o.extend_(r,e,t,n)}function ff(r,e){K("'"+this.annotationType_+"' cannot be used as a decorator")}var hf="observable",df="observable.ref",pf="observable.shallow",mf="observable.struct",Eo={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Eo);function Zn(r){return r||Eo}var xi=Br(hf),gf=Br(df,{enhancer:Lr}),_f=Br(pf,{enhancer:Uc}),vf=Br(mf,{enhancer:Fc}),xo=qe(xi);function er(r){return r.deep===!0?Ct:r.deep===!1?Lr:yf(r.defaultDecorator)}function bf(r){var e;return r?(e=r.defaultDecorator)!=null?e:So(r):void 0}function yf(r){var e,t;return r&&(e=(t=r.options_)==null?void 0:t.enhancer)!=null?e:Ct}function Co(r,e,t){if(Dn(e))return xi.decorate_20223_(r,e);if(xt(e)){Nn(r,e,xi);return}return ts(r)?r:tt(r)?fe.object(r,e,t):Array.isArray(r)?fe.array(r,e):rn(r)?fe.map(r,e):Qe(r)?fe.set(r,e):typeof r=="object"&&r!==null?r:fe.box(r,e)}co(Co,xo);var wf={box:function(e,t){var n=Zn(t);return new ft(e,er(n),n.name,!0,n.equals)},array:function(e,t){var n=Zn(t);return(T.useProxies===!1||n.proxy===!1?mh:sh)(e,er(n),n.name)},map:function(e,t){var n=Zn(t);return new Go(e,er(n),n.name)},set:function(e,t){var n=Zn(t);return new Yo(e,er(n),n.name)},object:function(e,t,n){return It(function(){return qo(T.useProxies===!1||(n==null?void 0:n.proxy)===!1?an({},n):nh({},n),e,t)})},ref:qe(gf),shallow:qe(_f),deep:xo,struct:qe(vf)},fe=co(Co,wf),Oo="computed",Af="computed.struct",Ci=Qi(Oo),Sf=Qi(Af,{equals:Qt.structural}),jr=function(e,t){if(Dn(t))return Ci.decorate_20223_(e,t);if(xt(t))return Nn(e,t,Ci);if(tt(e))return qe(Qi(Oo,e));var n=tt(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new Le(n)};Object.assign(jr,Ci);jr.struct=qe(Sf);var aa,oa,wr=0,Ef=1,xf=(aa=(oa=yr(function(){},"name"))==null?void 0:oa.configurable)!=null?aa:!1,la={value:"action",configurable:!0,writable:!1,enumerable:!1};function Ot(r,e,t,n){t===void 0&&(t=!1);function i(){return Ro(r,t,e,n||this,arguments)}return i.isMobxAction=!0,i.toString=function(){return e.toString()},xf&&(la.value=r,Ke(i,"name",la)),i}function Ro(r,e,t,n,i){var s=Cf(r,e);try{return t.apply(n,i)}catch(a){throw s.error_=a,a}finally{Of(s)}}function Cf(r,e,t,n){var i=!1,s=0,a=T.trackingDerivation,o=!e||!a;xe();var u=T.allowStateChanges;o&&($t(),u=Ur(!0));var f=Zi(!0),d={runAsAction_:o,prevDerivation_:a,prevAllowStateChanges_:u,prevAllowStateReads_:f,notifySpy_:i,startTime_:s,actionId_:Ef++,parentActionId_:wr};return wr=d.actionId_,d}function Of(r){wr!==r.actionId_&&K(30),wr=r.parentActionId_,r.error_!==void 0&&(T.suppressReactionErrors=!0),Fr(r.prevAllowStateChanges_),bn(r.prevAllowStateReads_),Ce(),r.runAsAction_&&et(r.prevDerivation_),T.suppressReactionErrors=!1}function Rf(r,e){var t=Ur(r);try{return e()}finally{Fr(t)}}function Ur(r){var e=T.allowStateChanges;return T.allowStateChanges=r,e}function Fr(r){T.allowStateChanges=r}var ft=function(r){function e(n,i,s,a,o){var u;return s===void 0&&(s="ObservableValue"),o===void 0&&(o=Qt.default),u=r.call(this,s)||this,u.enhancer=void 0,u.name_=void 0,u.equals=void 0,u.hasUnreportedChange_=!1,u.interceptors_=void 0,u.changeListeners_=void 0,u.value_=void 0,u.dehancer=void 0,u.enhancer=i,u.name_=s,u.equals=o,u.value_=i(n,void 0,s),u}vo(e,r);var t=e.prototype;return t.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==T.UNCHANGED&&this.setNewValue_(i)},t.prepareNewValue_=function(i){if(Se(this)){var s=Ee(this,{object:this,type:ze,newValue:i});if(!s)return T.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?T.UNCHANGED:i},t.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),ke(this)&&Ne(this,{type:ze,object:this,newValue:i,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(i){return jn(this,i)},t.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:ze,newValue:this.value_,oldValue:void 0}),Un(this,i)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return _o(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},e}(pt),Pf=dt("ObservableValue",ft),Le=function(){function r(t){this.dependenciesState_=z.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=z.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Sr(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Ar.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||K(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=Ot("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?Qt.structural:Qt.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var e=r.prototype;return e.onBecomeStale_=function(){kf(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing&&K(32,this.name_,this.derivation),T.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Oi(this)&&(this.warnAboutUntrackedRead_(),xe(),this.value_=this.computeValue_(!1),Ce());else if(No(this),Oi(this)){var n=T.trackingContext;this.keepAlive_&&!n&&(T.trackingContext=this),this.trackAndCompute()&&Mf(this),T.trackingContext=n}var i=this.value_;if(cr(i))throw i.cause;return i},e.set=function(n){if(this.setter_){this.isRunningSetter&&K(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else K(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,i=this.dependenciesState_===z.NOT_TRACKING_,s=this.computeValue_(!0),a=i||cr(n)||cr(s)||!this.equals_(n,s);return a&&(this.value_=s),a},e.computeValue_=function(n){this.isComputing=!0;var i=Ur(!1),s;if(n)s=Po(this,this.derivation,this.scope_);else if(T.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(a){s=new Sr(a)}return Fr(i),this.isComputing=!1,s},e.suspend_=function(){this.keepAlive_||(Ri(this),this.value_=void 0)},e.observe_=function(n,i){var s=this,a=!0,o=void 0;return Hf(function(){var u=s.get();if(!a||i){var f=$t();n({observableKind:"computed",debugObjectName:s.name_,type:ze,object:s,newValue:u,oldValue:o}),et(f)}a=!1,o=u})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return _o(this.get())},e[Symbol.toPrimitive]=function(){return this.valueOf()},sn(r,[{key:"isComputing",get:function(){return be(this.flags_,r.isComputingMask_)},set:function(n){this.flags_=ye(this.flags_,r.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return be(this.flags_,r.isRunningSetterMask_)},set:function(n){this.flags_=ye(this.flags_,r.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return be(this.flags_,r.isBeingObservedMask_)},set:function(n){this.flags_=ye(this.flags_,r.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return be(this.flags_,r.isPendingUnobservationMask_)},set:function(n){this.flags_=ye(this.flags_,r.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return be(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=ye(this.flags_,r.diffValueMask_,n===1)}}])}();Le.isComputingMask_=1;Le.isRunningSetterMask_=2;Le.isBeingObservedMask_=4;Le.isPendingUnobservationMask_=8;Le.diffValueMask_=16;var Bn=dt("ComputedValue",Le),z;(function(r){r[r.NOT_TRACKING_=-1]="NOT_TRACKING_",r[r.UP_TO_DATE_=0]="UP_TO_DATE_",r[r.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",r[r.STALE_=2]="STALE_"})(z||(z={}));var Ar;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(Ar||(Ar={}));var Sr=function(e){this.cause=void 0,this.cause=e};function cr(r){return r instanceof Sr}function Oi(r){switch(r.dependenciesState_){case z.UP_TO_DATE_:return!1;case z.NOT_TRACKING_:case z.STALE_:return!0;case z.POSSIBLY_STALE_:{for(var e=Zi(!0),t=$t(),n=r.observing_,i=n.length,s=0;s<i;s++){var a=n[s];if(Bn(a)){if(T.disableErrorBoundaries)a.get();else try{a.get()}catch{return et(t),bn(e),!0}if(r.dependenciesState_===z.STALE_)return et(t),bn(e),!0}}return To(r),et(t),bn(e),!1}}}function Po(r,e,t){var n=Zi(!0);To(r),r.newObserving_=new Array(r.runId_===0?100:r.observing_.length),r.unboundDepsCount_=0,r.runId_=++T.runId;var i=T.trackingDerivation;T.trackingDerivation=r,T.inBatch++;var s;if(T.disableErrorBoundaries===!0)s=e.call(t);else try{s=e.call(t)}catch(a){s=new Sr(a)}return T.inBatch--,T.trackingDerivation=i,$f(r),bn(n),s}function $f(r){for(var e=r.observing_,t=r.observing_=r.newObserving_,n=z.UP_TO_DATE_,i=0,s=r.unboundDepsCount_,a=0;a<s;a++){var o=t[a];o.diffValue===0&&(o.diffValue=1,i!==a&&(t[i]=o),i++),o.dependenciesState_>n&&(n=o.dependenciesState_)}for(t.length=i,r.newObserving_=null,s=e.length;s--;){var u=e[s];u.diffValue===0&&Mo(u,r),u.diffValue=0}for(;i--;){var f=t[i];f.diffValue===1&&(f.diffValue=0,If(f,r))}n!==z.UP_TO_DATE_&&(r.dependenciesState_=n,r.onBecomeStale_())}function Ri(r){var e=r.observing_;r.observing_=[];for(var t=e.length;t--;)Mo(e[t],r);r.dependenciesState_=z.NOT_TRACKING_}function $o(r){var e=$t();try{return r()}finally{et(e)}}function $t(){var r=T.trackingDerivation;return T.trackingDerivation=null,r}function et(r){T.trackingDerivation=r}function Zi(r){var e=T.allowStateReads;return T.allowStateReads=r,e}function bn(r){T.allowStateReads=r}function To(r){if(r.dependenciesState_!==z.UP_TO_DATE_){r.dependenciesState_=z.UP_TO_DATE_;for(var e=r.observing_,t=e.length;t--;)e[t].lowestObserverState_=z.UP_TO_DATE_}}var fr=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},hr=!0,Io=!1,T=function(){var r=kr();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(hr=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new fr().version&&(hr=!1),hr?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new fr):(setTimeout(function(){Io||K(35)},1),new fr)}();function Tf(){if((T.pendingReactions.length||T.inBatch||T.isRunningReactions)&&K(36),Io=!0,hr){var r=kr();--r.__mobxInstanceCount===0&&(r.__mobxGlobals=void 0),T=new fr}}function If(r,e){r.observers_.add(e),r.lowestObserverState_>e.dependenciesState_&&(r.lowestObserverState_=e.dependenciesState_)}function Mo(r,e){r.observers_.delete(e),r.observers_.size===0&&ko(r)}function ko(r){r.isPendingUnobservation===!1&&(r.isPendingUnobservation=!0,T.pendingUnobservations.push(r))}function xe(){T.inBatch++}function Ce(){if(--T.inBatch===0){Lo();for(var r=T.pendingUnobservations,e=0;e<r.length;e++){var t=r[e];t.isPendingUnobservation=!1,t.observers_.size===0&&(t.isBeingObserved&&(t.isBeingObserved=!1,t.onBUO()),t instanceof Le&&t.suspend_())}T.pendingUnobservations=[]}}function No(r){var e=T.trackingDerivation;return e!==null?(e.runId_!==r.lastAccessedBy_&&(r.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=r,!r.isBeingObserved&&T.trackingContext&&(r.isBeingObserved=!0,r.onBO())),r.isBeingObserved):(r.observers_.size===0&&T.inBatch>0&&ko(r),!1)}function Do(r){r.lowestObserverState_!==z.STALE_&&(r.lowestObserverState_=z.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===z.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=z.STALE_}))}function Mf(r){r.lowestObserverState_!==z.STALE_&&(r.lowestObserverState_=z.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===z.POSSIBLY_STALE_?e.dependenciesState_=z.STALE_:e.dependenciesState_===z.UP_TO_DATE_&&(r.lowestObserverState_=z.UP_TO_DATE_)}))}function kf(r){r.lowestObserverState_===z.UP_TO_DATE_&&(r.lowestObserverState_=z.POSSIBLY_STALE_,r.observers_.forEach(function(e){e.dependenciesState_===z.UP_TO_DATE_&&(e.dependenciesState_=z.POSSIBLY_STALE_,e.onBecomeStale_())}))}var Xe=function(){function r(t,n,i,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=z.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=Ar.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=i,this.requiresObservable_=s}var e=r.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled||(this.isScheduled=!0,T.pendingReactions.push(this),Lo())},e.runReaction_=function(){if(!this.isDisposed){xe(),this.isScheduled=!1;var n=T.trackingContext;if(T.trackingContext=this,Oi(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}T.trackingContext=n,Ce()}},e.track=function(n){if(!this.isDisposed){xe(),this.isRunning=!0;var i=T.trackingContext;T.trackingContext=this;var s=Po(this,n,void 0);T.trackingContext=i,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Ri(this),cr(s)&&this.reportExceptionInDerivation_(s.cause),Ce()}},e.reportExceptionInDerivation_=function(n){var i=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(T.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";T.suppressReactionErrors||console.error(s,n),T.globalReactionErrorHandlers.forEach(function(a){return a(n,i)})},e.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(xe(),Ri(this),Ce()))},e.getDisposer_=function(n){var i=this,s=function a(){i.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",a)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[L]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},sn(r,[{key:"isDisposed",get:function(){return be(this.flags_,r.isDisposedMask_)},set:function(n){this.flags_=ye(this.flags_,r.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return be(this.flags_,r.isScheduledMask_)},set:function(n){this.flags_=ye(this.flags_,r.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return be(this.flags_,r.isTrackPendingMask_)},set:function(n){this.flags_=ye(this.flags_,r.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return be(this.flags_,r.isRunningMask_)},set:function(n){this.flags_=ye(this.flags_,r.isRunningMask_,n)}},{key:"diffValue",get:function(){return be(this.flags_,r.diffValueMask_)?1:0},set:function(n){this.flags_=ye(this.flags_,r.diffValueMask_,n===1)}}])}();Xe.isDisposedMask_=1;Xe.isScheduledMask_=2;Xe.isTrackPendingMask_=4;Xe.isRunningMask_=8;Xe.diffValueMask_=16;var Nf=100,Pi=function(e){return e()};function Lo(){T.inBatch>0||T.isRunningReactions||Pi(Df)}function Df(){T.isRunningReactions=!0;for(var r=T.pendingReactions,e=0;r.length>0;){++e===Nf&&(console.error("[mobx] cycle in reaction: "+r[0]),r.splice(0));for(var t=r.splice(0),n=0,i=t.length;n<i;n++)t[n].runReaction_()}T.isRunningReactions=!1}var Er=dt("Reaction",Xe);function Lf(r){var e=Pi;Pi=function(n){return r(function(){return e(n)})}}function yn(){return!1}function Bf(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Bo="action",jf="action.bound",jo="autoAction",Uf="autoAction.bound",Uo="<unnamed action>",$i=Ln(Bo),Ff=Ln(jf,{bound:!0}),Ti=Ln(jo,{autoAction:!0}),Vf=Ln(Uf,{autoAction:!0,bound:!0});function Fo(r){var e=function(n,i){if(De(n))return Ot(n.name||Uo,n,r);if(De(i))return Ot(n,i,r);if(Dn(i))return(r?Ti:$i).decorate_20223_(n,i);if(xt(i))return Nn(n,i,r?Ti:$i);if(xt(n))return qe(Ln(r?jo:Bo,{name:n,autoAction:r}))};return e}var Oe=Fo(!1);Object.assign(Oe,$i);var Cn=Fo(!0);Object.assign(Cn,Ti);Oe.bound=qe(Ff);Cn.bound=qe(Vf);function Tt(r){return Ro(r.name||Uo,!1,r,this,void 0)}function On(r){return De(r)&&r.isMobxAction===!0}function Hf(r,e){var t,n,i,s;e===void 0&&(e=Gi);var a=(t=(n=e)==null?void 0:n.name)!=null?t:"Autorun",o=!e.scheduler&&!e.delay,u;if(o)u=new Xe(a,function(){this.track(h)},e.onError,e.requiresObservable);else{var f=Vo(e),d=!1;u=new Xe(a,function(){d||(d=!0,f(function(){d=!1,u.isDisposed||u.track(h)}))},e.onError,e.requiresObservable)}function h(){r(u)}return(i=e)!=null&&(i=i.signal)!=null&&i.aborted||u.schedule_(),u.getDisposer_((s=e)==null?void 0:s.signal)}var Wf=function(e){return e()};function Vo(r){return r.scheduler?r.scheduler:r.delay?function(e){return setTimeout(e,r.delay)}:Wf}function es(r,e,t){var n,i,s;t===void 0&&(t=Gi);var a=(n=t.name)!=null?n:"Reaction",o=Oe(a,t.onError?Kf(t.onError,e):e),u=!t.scheduler&&!t.delay,f=Vo(t),d=!0,h=!1,_,b=t.compareStructural?Qt.structural:t.equals||Qt.default,w=new Xe(a,function(){d||u?C():h||(h=!0,f(C))},t.onError,t.requiresObservable);function C(){if(h=!1,!w.isDisposed){var A=!1,B=_;w.track(function(){var R=Rf(!1,function(){return r(w)});A=d||!b(_,R),_=R}),(d&&t.fireImmediately||!d&&A)&&o(_,B,w),d=!1}}return(i=t)!=null&&(i=i.signal)!=null&&i.aborted||w.schedule_(),w.getDisposer_((s=t)==null?void 0:s.signal)}function Kf(r,e){return function(){try{return e.apply(this,arguments)}catch(t){r.call(this,t)}}}var qf="onBO",zf="onBUO";function Xf(r,e,t){return Wo(qf,r,e,t)}function Ho(r,e,t){return Wo(zf,r,e,t)}function Wo(r,e,t,n){var i=Ii(e),s=De(n)?n:t,a=r+"L";return i[a]?i[a].add(s):i[a]=new Set([s]),function(){var o=i[a];o&&(o.delete(s),o.size===0&&delete i[a])}}var Jf="never",tr="always",Gf="observed";function Ko(r){r.isolateGlobalState===!0&&Tf();var e=r.useProxies,t=r.enforceActions;if(e!==void 0&&(T.useProxies=e===tr?!0:e===Jf?!1:typeof Proxy<"u"),e==="ifavailable"&&(T.verifyProxies=!0),t!==void 0){var n=t===tr?tr:t===Gf;T.enforceActions=n,T.allowStateChanges=!(n===!0||n===tr)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in r&&(T[i]=!!r[i])}),T.allowStateReads=!T.observableRequiresReaction,r.reactionScheduler&&Lf(r.reactionScheduler)}function qo(r,e,t,n){var i=Mc(e);return It(function(){var s=an(r,n)[L];xn(i).forEach(function(a){s.extend_(a,i[a],t&&a in t?t[a]:!0)})}),r}var Yf=0;function zo(){this.message="FLOW_CANCELLED"}zo.prototype=Object.create(Error.prototype);var ii=wo("flow"),Qf=wo("flow.bound",{bound:!0}),Zt=Object.assign(function(e,t){if(Dn(t))return ii.decorate_20223_(e,t);if(xt(t))return Nn(e,t,ii);var n=e,i=n.name||"<unnamed flow>",s=function(){var o=this,u=arguments,f=++Yf,d=Oe(i+" - runid: "+f+" - init",n).apply(o,u),h,_=void 0,b=new Promise(function(w,C){var A=0;h=C;function B(M){_=void 0;var S;try{S=Oe(i+" - runid: "+f+" - yield "+A++,d.next).call(d,M)}catch(I){return C(I)}D(S)}function R(M){_=void 0;var S;try{S=Oe(i+" - runid: "+f+" - yield "+A++,d.throw).call(d,M)}catch(I){return C(I)}D(S)}function D(M){if(De(M==null?void 0:M.then)){M.then(D,C);return}return M.done?w(M.value):(_=Promise.resolve(M.value),_.then(B,R))}B(void 0)});return b.cancel=Oe(i+" - runid: "+f+" - cancel",function(){try{_&&ua(_);var w=d.return(void 0),C=Promise.resolve(w.value);C.then(Ht,Ht),ua(C),h(new zo)}catch(A){h(A)}}),b};return s.isMobXFlow=!0,s},ii);Zt.bound=qe(Qf);function ua(r){De(r.cancel)&&r.cancel()}function Rn(r){return(r==null?void 0:r.isMobXFlow)===!0}function Zf(r,e){return r?Vn(r)||!!r[L]||Yi(r)||Er(r)||Bn(r):!1}function ts(r){return Zf(r)}function eh(r){if(Vn(r))return r[L].ownKeys_();K(38)}function nr(r,e,t){return r.set(e,t),t}function jt(r,e){if(r==null||typeof r!="object"||r instanceof Date||!ts(r))return r;if(Pf(r)||Bn(r))return jt(r.get(),e);if(e.has(r))return e.get(r);if(Fn(r)){var t=nr(e,r,new Array(r.length));return r.forEach(function(a,o){t[o]=jt(a,e)}),t}if(Te(r)){var n=nr(e,r,new Set);return r.forEach(function(a){n.add(jt(a,e))}),n}if(mt(r)){var i=nr(e,r,new Map);return r.forEach(function(a,o){i.set(o,jt(a,e))}),i}else{var s=nr(e,r,{});return eh(r).forEach(function(a){kn.propertyIsEnumerable.call(r,a)&&(s[a]=jt(r[a],e))}),s}}function Xo(r,e){return jt(r,new Map)}function Ze(r,e){e===void 0&&(e=void 0),xe();try{return r.apply(e)}finally{Ce()}}function Nt(r){return r[L]}var th={has:function(e,t){return Nt(e).has_(t)},get:function(e,t){return Nt(e).get_(t)},set:function(e,t,n){var i;return xt(t)?(i=Nt(e).set_(t,n,!0))!=null?i:!0:!1},deleteProperty:function(e,t){var n;return xt(t)?(n=Nt(e).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(e,t,n){var i;return(i=Nt(e).defineProperty_(t,n))!=null?i:!0},ownKeys:function(e){return Nt(e).ownKeys_()},preventExtensions:function(e){K(13)}};function nh(r,e){var t,n;return fo(),r=an(r,e),(n=(t=r[L]).proxy_)!=null?n:t.proxy_=new Proxy(r,th)}function Se(r){return r.interceptors_!==void 0&&r.interceptors_.length>0}function jn(r,e){var t=r.interceptors_||(r.interceptors_=[]);return t.push(e),ho(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Ee(r,e){var t=$t();try{for(var n=[].concat(r.interceptors_||[]),i=0,s=n.length;i<s&&(e=n[i](e),e&&!e.type&&K(14),!!e);i++);return e}finally{et(t)}}function ke(r){return r.changeListeners_!==void 0&&r.changeListeners_.length>0}function Un(r,e){var t=r.changeListeners_||(r.changeListeners_=[]);return t.push(e),ho(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Ne(r,e){var t=$t(),n=r.changeListeners_;if(n){n=n.slice();for(var i=0,s=n.length;i<s;i++)n[i](e);et(t)}}var si=Symbol("mobx-keys");function Vr(r,e,t){return tt(r)?qo(r,r,e,t):(It(function(){var n=an(r,t)[L];if(!r[si]){var i=Object.getPrototypeOf(r),s=new Set([].concat(xn(r),xn(i)));s.delete("constructor"),s.delete(L),Dr(i,si,s)}r[si].forEach(function(a){return n.make_(a,e&&a in e?e[a]:!0)})}),r)}var ca="splice",ze="update",rh=1e4,ih={get:function(e,t){var n=e[L];return t===L?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):ct(xr,t)?xr[t]:e[t]},set:function(e,t,n){var i=e[L];return t==="length"&&i.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){K(15)}},ns=function(){function r(t,n,i,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new pt(t),this.enhancer_=function(a,o){return n(a,o,"ObservableArray[..]")}}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return jn(this,n)},e.observe_=function(n,i){return i===void 0&&(i=!1),i&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Un(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&K("Out of range: "+n);var i=this.values_.length;if(n!==i)if(n>i){for(var s=new Array(n-i),a=0;a<n-i;a++)s[a]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(n,i-n)},e.updateArrayLength_=function(n,i){n!==this.lastKnownLength_&&K(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&tl(n+i+1)},e.spliceWithArray_=function(n,i,s){var a=this;this.atom_;var o=this.values_.length;if(n===void 0?n=0:n>o?n=o:n<0&&(n=Math.max(0,o+n)),arguments.length===1?i=o-n:i==null?i=0:i=Math.max(0,Math.min(i,o-n)),s===void 0&&(s=Si),Se(this)){var u=Ee(this,{object:this.proxy_,type:ca,index:n,removedCount:i,added:s});if(!u)return Si;i=u.removedCount,s=u.added}if(s=s.length===0?s:s.map(function(h){return a.enhancer_(h,void 0)}),this.legacyMode_){var f=s.length-i;this.updateArrayLength_(o,f)}var d=this.spliceItemsIntoValues_(n,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(n,s,d),this.dehanceValues_(d)},e.spliceItemsIntoValues_=function(n,i,s){if(s.length<rh){var a;return(a=this.values_).splice.apply(a,[n,i].concat(s))}else{var o=this.values_.slice(n,n+i),u=this.values_.slice(n+i);this.values_.length+=s.length-i;for(var f=0;f<s.length;f++)this.values_[n+f]=s[f];for(var d=0;d<u.length;d++)this.values_[n+s.length+d]=u[d];return o}},e.notifyArrayChildUpdate_=function(n,i,s){var a=!this.owned_&&yn(),o=ke(this),u=o||a?{observableKind:"array",object:this.proxy_,type:ze,debugObjectName:this.atom_.name_,index:n,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),o&&Ne(this,u)},e.notifyArraySplice_=function(n,i,s){var a=!this.owned_&&yn(),o=ke(this),u=o||a?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:ca,index:n,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),o&&Ne(this,u)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,i){var s=this.values_;if(this.legacyMode_&&n>s.length&&K(17,n,s.length),n<s.length){this.atom_;var a=s[n];if(Se(this)){var o=Ee(this,{type:ze,object:this.proxy_,index:n,newValue:i});if(!o)return;i=o.newValue}i=this.enhancer_(i,a);var u=i!==a;u&&(s[n]=i,this.notifyArrayChildUpdate_(n,i,a))}else{for(var f=new Array(n+1-s.length),d=0;d<f.length-1;d++)f[d]=void 0;f[f.length-1]=i,this.spliceWithArray_(s.length,0,f)}},r}();function sh(r,e,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),fo(),It(function(){var i=new ns(t,e,n,!1);mo(i.values_,L,i);var s=new Proxy(i.values_,ih);return i.proxy_=s,r&&r.length&&i.spliceWithArray_(0,0,r),s})}var xr={clear:function(){return this.splice(0)},replace:function(e){var t=this[L];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var a=this[L];switch(arguments.length){case 0:return[];case 1:return a.spliceWithArray_(e);case 2:return a.spliceWithArray_(e,t)}return a.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[L].spliceWithArray_(e,t,n)},push:function(){for(var e=this[L],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[L].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[L],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return T.trackingDerivation&&K(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){T.trackingDerivation&&K(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[L],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};Z("at",we);Z("concat",we);Z("flat",we);Z("includes",we);Z("indexOf",we);Z("join",we);Z("lastIndexOf",we);Z("slice",we);Z("toString",we);Z("toLocaleString",we);Z("toSorted",we);Z("toSpliced",we);Z("with",we);Z("every",Be);Z("filter",Be);Z("find",Be);Z("findIndex",Be);Z("findLast",Be);Z("findLastIndex",Be);Z("flatMap",Be);Z("forEach",Be);Z("map",Be);Z("some",Be);Z("toReversed",Be);Z("reduce",Jo);Z("reduceRight",Jo);function Z(r,e){typeof Array.prototype[r]=="function"&&(xr[r]=e(r))}function we(r){return function(){var e=this[L];e.atom_.reportObserved();var t=e.dehanceValues_(e.values_);return t[r].apply(t,arguments)}}function Be(r){return function(e,t){var n=this,i=this[L];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[r](function(a,o){return e.call(t,a,o,n)})}}function Jo(r){return function(){var e=this,t=this[L];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),i=arguments[0];return arguments[0]=function(s,a,o){return i(s,a,o,e)},n[r].apply(n,arguments)}}var ah=dt("ObservableArrayAdministration",ns);function Fn(r){return Nr(r)&&ah(r[L])}var oh={},lt="add",Cr="delete",Go=function(){function r(t,n,i){var s=this;n===void 0&&(n=Ct),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[L]=oh,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=i,De(Map)||K(18),It(function(){s.keysAtom_=bo("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var e=r.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var i=this;if(!T.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var a=s=new ft(this.has_(n),Lr,"ObservableMap.key?",!1);this.hasMap_.set(n,a),Ho(a,function(){return i.hasMap_.delete(n)})}return s.get()},e.set=function(n,i){var s=this.has_(n);if(Se(this)){var a=Ee(this,{type:s?ze:lt,object:this,newValue:i,name:n});if(!a)return this;i=a.newValue}return s?this.updateValue_(n,i):this.addValue_(n,i),this},e.delete=function(n){var i=this;if(this.keysAtom_,Se(this)){var s=Ee(this,{type:Cr,object:this,name:n});if(!s)return!1}if(this.has_(n)){var a=yn(),o=ke(this),u=o||a?{observableKind:"map",debugObjectName:this.name_,type:Cr,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return Ze(function(){var f;i.keysAtom_.reportChanged(),(f=i.hasMap_.get(n))==null||f.setNewValue_(!1);var d=i.data_.get(n);d.setNewValue_(void 0),i.data_.delete(n)}),o&&Ne(this,u),!0}return!1},e.updateValue_=function(n,i){var s=this.data_.get(n);if(i=s.prepareNewValue_(i),i!==T.UNCHANGED){var a=yn(),o=ke(this),u=o||a?{observableKind:"map",debugObjectName:this.name_,type:ze,object:this,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),o&&Ne(this,u)}},e.addValue_=function(n,i){var s=this;this.keysAtom_,Ze(function(){var f,d=new ft(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,d),i=d.value_,(f=s.hasMap_.get(n))==null||f.setNewValue_(!0),s.keysAtom_.reportChanged()});var a=yn(),o=ke(this),u=o||a?{observableKind:"map",debugObjectName:this.name_,type:lt,object:this,name:n,newValue:i}:null;o&&Ne(this,u)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,i=this.keys();return fa({next:function(){var a=i.next(),o=a.done,u=a.value;return{done:o,value:o?void 0:n.get(u)}}})},e.entries=function(){var n=this,i=this.keys();return fa({next:function(){var a=i.next(),o=a.done,u=a.value;return{done:o,value:o?void 0:[u,n.get(u)]}}})},e[Symbol.iterator]=function(){return this.entries()},e.forEach=function(n,i){for(var s=Wt(this),a;!(a=s()).done;){var o=a.value,u=o[0],f=o[1];n.call(i,f,u,this)}},e.merge=function(n){var i=this;return mt(n)&&(n=new Map(n)),Ze(function(){tt(n)?Ic(n).forEach(function(s){return i.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var a=s[0],o=s[1];return i.set(a,o)}):rn(n)?(Tc(n)||K(19,n),n.forEach(function(s,a){return i.set(a,s)})):n!=null&&K(20,n)}),this},e.clear=function(){var n=this;Ze(function(){$o(function(){for(var i=Wt(n.keys()),s;!(s=i()).done;){var a=s.value;n.delete(a)}})})},e.replace=function(n){var i=this;return Ze(function(){for(var s=lh(n),a=new Map,o=!1,u=Wt(i.data_.keys()),f;!(f=u()).done;){var d=f.value;if(!s.has(d)){var h=i.delete(d);if(h)o=!0;else{var _=i.data_.get(d);a.set(d,_)}}}for(var b=Wt(s.entries()),w;!(w=b()).done;){var C=w.value,A=C[0],B=C[1],R=i.data_.has(A);if(i.set(A,B),i.data_.has(A)){var D=i.data_.get(A);a.set(A,D),R||(o=!0)}}if(!o)if(i.data_.size!==a.size)i.keysAtom_.reportChanged();else for(var M=i.data_.keys(),S=a.keys(),I=M.next(),E=S.next();!I.done;){if(I.value!==E.value){i.keysAtom_.reportChanged();break}I=M.next(),E=S.next()}i.data_=a}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,i){return Un(this,n)},e.intercept_=function(n){return jn(this,n)},sn(r,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),mt=dt("ObservableMap",Go);function fa(r){return r[Symbol.toStringTag]="MapIterator",is(r)}function lh(r){if(rn(r)||mt(r))return r;if(Array.isArray(r))return new Map(r);if(tt(r)){var e=new Map;for(var t in r)e.set(t,r[t]);return e}else return K(21,r)}var uh={},Yo=function(){function r(t,n,i){var s=this;n===void 0&&(n=Ct),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[L]=uh,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,De(Set)||K(22),this.enhancer_=function(a,o){return n(a,o,i)},It(function(){s.atom_=bo(s.name_),t&&s.replace(t)})}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;Ze(function(){$o(function(){for(var i=Wt(n.data_.values()),s;!(s=i()).done;){var a=s.value;n.delete(a)}})})},e.forEach=function(n,i){for(var s=Wt(this),a;!(a=s()).done;){var o=a.value;n.call(i,o,o,this)}},e.add=function(n){var i=this;if(this.atom_,Se(this)){var s=Ee(this,{type:lt,object:this,newValue:n});if(!s)return this}if(!this.has(n)){Ze(function(){i.data_.add(i.enhancer_(n,void 0)),i.atom_.reportChanged()});var a=!1,o=ke(this),u=o||a?{observableKind:"set",debugObjectName:this.name_,type:lt,object:this,newValue:n}:null;o&&Ne(this,u)}return this},e.delete=function(n){var i=this;if(Se(this)){var s=Ee(this,{type:Cr,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var a=!1,o=ke(this),u=o||a?{observableKind:"set",debugObjectName:this.name_,type:Cr,object:this,oldValue:n}:null;return Ze(function(){i.atom_.reportChanged(),i.data_.delete(n)}),o&&Ne(this,u),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=this.values();return ha({next:function(){var s=n.next(),a=s.value,o=s.done;return o?{value:void 0,done:o}:{value:[a,a],done:o}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,i=this.data_.values();return ha({next:function(){var a=i.next(),o=a.value,u=a.done;return u?{value:void 0,done:u}:{value:n.dehanceValue_(o),done:u}}})},e.intersection=function(n){if(Qe(n)&&!Te(n))return n.intersection(this);var i=new Set(this);return i.intersection(n)},e.union=function(n){if(Qe(n)&&!Te(n))return n.union(this);var i=new Set(this);return i.union(n)},e.difference=function(n){return new Set(this).difference(n)},e.symmetricDifference=function(n){if(Qe(n)&&!Te(n))return n.symmetricDifference(this);var i=new Set(this);return i.symmetricDifference(n)},e.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},e.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},e.isDisjointFrom=function(n){if(Qe(n)&&!Te(n))return n.isDisjointFrom(this);var i=new Set(this);return i.isDisjointFrom(n)},e.replace=function(n){var i=this;return Te(n)&&(n=new Set(n)),Ze(function(){Array.isArray(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):Qe(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):n!=null&&K("Cannot initialize set from "+n)}),this},e.observe_=function(n,i){return Un(this,n)},e.intercept_=function(n){return jn(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Symbol.iterator]=function(){return this.values()},sn(r,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),Te=dt("ObservableSet",Yo);function ha(r){return r[Symbol.toStringTag]="SetIterator",is(r)}var da=Object.create(null),pa="remove",Qo=function(){function r(t,n,i,s){n===void 0&&(n=new Map),s===void 0&&(s=lf),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new pt("ObservableObject.keys"),this.isPlainObject_=tt(this.target_)}var e=r.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,i){var s=this.values_.get(n);if(s instanceof Le)return s.set(i),!0;if(Se(this)){var a=Ee(this,{type:ze,object:this.proxy_||this.target_,name:n,newValue:i});if(!a)return null;i=a.newValue}if(i=s.prepareNewValue_(i),i!==T.UNCHANGED){var o=ke(this),u=!1,f=o||u?{type:ze,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),o&&Ne(this,f)}return!0},e.get_=function(n){return T.trackingDerivation&&!ct(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,i,s){return s===void 0&&(s=!1),ct(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,i):s?Reflect.set(this.target_,n,i):(this.target_[n]=i,!0):this.extend_(n,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(n){if(!T.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(n);return i||(i=new ft(n in this.target_,Lr,"ObservableObject.key?",!1),this.pendingKeys_.set(n,i)),i.get()},e.make_=function(n,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(n in this.target_)){var s;if((s=this.target_[Kt])!=null&&s[n])return;K(1,i.annotationType_,this.name_+"."+n.toString())}for(var a=this.target_;a&&a!==kn;){var o=yr(a,n);if(o){var u=i.make_(this,n,o,a);if(u===0)return;if(u===1)break}a=Object.getPrototypeOf(a)}ga(this,i,n)}},e.extend_=function(n,i,s,a){if(a===void 0&&(a=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,i,a);var o=s.extend_(this,n,i,a);return o&&ga(this,s,n),o},e.defineProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{xe();var a=this.delete_(n);if(!a)return a;if(Se(this)){var o=Ee(this,{object:this.proxy_||this.target_,name:n,type:lt,newValue:i.value});if(!o)return null;var u=o.newValue;i.value!==u&&(i=Yt({},i,{value:u}))}if(s){if(!Reflect.defineProperty(this.target_,n,i))return!1}else Ke(this.target_,n,i);this.notifyPropertyAddition_(n,i.value)}finally{Ce()}return!0},e.defineObservableProperty_=function(n,i,s,a){a===void 0&&(a=!1),this.keysAtom_;try{xe();var o=this.delete_(n);if(!o)return o;if(Se(this)){var u=Ee(this,{object:this.proxy_||this.target_,name:n,type:lt,newValue:i});if(!u)return null;i=u.newValue}var f=ma(n),d={configurable:T.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:f.get,set:f.set};if(a){if(!Reflect.defineProperty(this.target_,n,d))return!1}else Ke(this.target_,n,d);var h=new ft(i,s,"ObservableObject.key",!1);this.values_.set(n,h),this.notifyPropertyAddition_(n,h.value_)}finally{Ce()}return!0},e.defineComputedProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{xe();var a=this.delete_(n);if(!a)return a;if(Se(this)){var o=Ee(this,{object:this.proxy_||this.target_,name:n,type:lt,newValue:void 0});if(!o)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var u=ma(n),f={configurable:T.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:u.get,set:u.set};if(s){if(!Reflect.defineProperty(this.target_,n,f))return!1}else Ke(this.target_,n,f);this.values_.set(n,new Le(i)),this.notifyPropertyAddition_(n,void 0)}finally{Ce()}return!0},e.delete_=function(n,i){if(i===void 0&&(i=!1),this.keysAtom_,!ct(this.target_,n))return!0;if(Se(this)){var s=Ee(this,{object:this.proxy_||this.target_,name:n,type:pa});if(!s)return null}try{var a;xe();var o=ke(this),u=!1,f=this.values_.get(n),d=void 0;if(!f&&(o||u)){var h;d=(h=yr(this.target_,n))==null?void 0:h.value}if(i){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(f&&(this.values_.delete(n),f instanceof ft&&(d=f.value_),Do(f)),this.keysAtom_.reportChanged(),(a=this.pendingKeys_)==null||(a=a.get(n))==null||a.set(n in this.target_),o||u){var _={type:pa,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:d,name:n};o&&Ne(this,_)}}finally{Ce()}return!0},e.observe_=function(n,i){return Un(this,n)},e.intercept_=function(n){return jn(this,n)},e.notifyPropertyAddition_=function(n,i){var s,a=ke(this),o=!1;if(a||o){var u=a||o?{type:lt,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:i}:null;a&&Ne(this,u)}(s=this.pendingKeys_)==null||(s=s.get(n))==null||s.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),xn(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},r}();function an(r,e){var t;if(ct(r,L))return r;var n=(t=e==null?void 0:e.name)!=null?t:"ObservableObject",i=new Qo(r,new Map,String(n),bf(e));return Dr(r,L,i),r}var ch=dt("ObservableObjectAdministration",Qo);function ma(r){return da[r]||(da[r]={get:function(){return this[L].getObservablePropValue_(r)},set:function(t){return this[L].setObservablePropValue_(r,t)}})}function Vn(r){return Nr(r)?ch(r[L]):!1}function ga(r,e,t){var n;(n=r.target_[Kt])==null||delete n[t]}var fh=el(0),hh=function(){var r=!1,e={};return Object.defineProperty(e,"0",{set:function(){r=!0}}),Object.create(e)[0]=1,r===!1}(),ai=0,Zo=function(){};function dh(r,e){Object.setPrototypeOf?Object.setPrototypeOf(r.prototype,e):r.prototype.__proto__!==void 0?r.prototype.__proto__=e:r.prototype=e}dh(Zo,Array.prototype);var rs=function(r){function e(n,i,s,a){var o;return s===void 0&&(s="ObservableArray"),a===void 0&&(a=!1),o=r.call(this)||this,It(function(){var u=new ns(s,i,a,!0);u.proxy_=o,mo(o,L,u),n&&n.length&&o.spliceWithArray(0,0,n),hh&&Object.defineProperty(o,"0",fh)}),o}vo(e,r);var t=e.prototype;return t.concat=function(){this[L].atom_.reportObserved();for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Array.prototype.concat.apply(this.slice(),s.map(function(o){return Fn(o)?o.slice():o}))},t[Symbol.iterator]=function(){var n=this,i=0;return is({next:function(){return i<n.length?{value:n[i++],done:!1}:{done:!0,value:void 0}}})},sn(e,[{key:"length",get:function(){return this[L].getArrayLength_()},set:function(i){this[L].setArrayLength_(i)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(Zo);Object.entries(xr).forEach(function(r){var e=r[0],t=r[1];e!=="concat"&&Dr(rs.prototype,e,t)});function el(r){return{enumerable:!1,configurable:!0,get:function(){return this[L].get_(r)},set:function(t){this[L].set_(r,t)}}}function ph(r){Ke(rs.prototype,""+r,el(r))}function tl(r){if(r>ai){for(var e=ai;e<r+100;e++)ph(e);ai=r}}tl(1e3);function mh(r,e,t){return new rs(r,e,t)}function Ii(r,e){if(typeof r=="object"&&r!==null){if(Fn(r))return e!==void 0&&K(23),r[L].atom_;if(Te(r))return r.atom_;if(mt(r)){if(e===void 0)return r.keysAtom_;var t=r.data_.get(e)||r.hasMap_.get(e);return t||K(25,e,Mi(r)),t}if(Vn(r)){if(!e)return K(26);var n=r[L].values_.get(e);return n||K(27,e,Mi(r)),n}if(Yi(r)||Bn(r)||Er(r))return r}else if(De(r)&&Er(r[L]))return r[L];K(28)}function gh(r,e){if(r||K(29),Yi(r)||Bn(r)||Er(r)||mt(r)||Te(r))return r;if(r[L])return r[L];K(24,r)}function Mi(r,e){var t;if(e!==void 0)t=Ii(r,e);else{if(On(r))return r.name;Vn(r)||mt(r)||Te(r)?t=gh(r):t=Ii(r)}return t.name_}function It(r){var e=$t(),t=Ur(!0);xe();try{return r()}finally{Ce(),Fr(t),et(e)}}var _a=kn.toString;function nl(r,e,t){return t===void 0&&(t=-1),ki(r,e,t)}function ki(r,e,t,n,i){if(r===e)return r!==0||1/r===1/e;if(r==null||e==null)return!1;if(r!==r)return e!==e;var s=typeof r;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var a=_a.call(r);if(a!==_a.call(e))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+r==""+e;case"[object Number]":return+r!=+r?+e!=+e:+r==0?1/+r===1/e:+r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":t>=0&&t++;break}r=va(r),e=va(e);var o=a==="[object Array]";if(!o){if(typeof r!="object"||typeof e!="object")return!1;var u=r.constructor,f=e.constructor;if(u!==f&&!(De(u)&&u instanceof u&&De(f)&&f instanceof f)&&"constructor"in r&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],i=i||[];for(var d=n.length;d--;)if(n[d]===r)return i[d]===e;if(n.push(r),i.push(e),o){if(d=r.length,d!==e.length)return!1;for(;d--;)if(!ki(r[d],e[d],t-1,n,i))return!1}else{var h=Object.keys(r),_;if(d=h.length,Object.keys(e).length!==d)return!1;for(;d--;)if(_=h[d],!(ct(e,_)&&ki(r[_],e[_],t-1,n,i)))return!1}return n.pop(),i.pop(),!0}function va(r){return Fn(r)?r.slice():rn(r)||mt(r)||Qe(r)||Te(r)?Array.from(r.entries()):r}var ba,_h=((ba=kr().Iterator)==null?void 0:ba.prototype)||{};function is(r){return r[Symbol.iterator]=vh,Object.assign(Object.create(_h),r)}function vh(){return this}["Symbol","Map","Set"].forEach(function(r){var e=kr();typeof e[r]>"u"&&K("MobX requires global '"+r+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Bf,extras:{getDebugName:Mi},$mobx:L});Ko({useProxies:"never"});const ne=Vr({title:"Untitled Conversation",id:`${crypto.randomUUID()}`,messages:[]}),rl=Oe(r=>{ne.messages.push({role:"user",content:r})});Oe(r=>{ne.messages.push({role:"assistant",content:r})});const bh=Oe(r=>{let e=ne.messages[ne.messages.length-1];e&&e.role==="assistant"?e.content+=r:ne.messages.push({role:"assistant",content:r})});Oe(r=>{ne.messages=[{role:"system",content:r},...ne.messages.filter(e=>e.role!=="system")]});const il=Oe(()=>(ne.messages=[],ne.id=`${crypto.randomUUID()}`,ne.title="Untitled Conversation",console.log(`New chat created with id: ${ne.id}`),ne.id));var rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ir(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oi={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var ya;function wh(){return ya||(ya=1,function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function a(f,d){if(!i[f]){if(!n[f]){var h=typeof ir=="function"&&ir;if(!d&&h)return h(f,!0);if(o)return o(f,!0);var _=new Error("Cannot find module '"+f+"'");throw _.code="MODULE_NOT_FOUND",_}var b=i[f]={exports:{}};n[f][0].call(b.exports,function(w){var C=n[f][1][w];return a(C||w)},b,b.exports,t,n,i,s)}return i[f].exports}for(var o=typeof ir=="function"&&ir,u=0;u<s.length;u++)a(s[u]);return a}({1:[function(t,n,i){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var u=0,f=new a(w),d=s.document.createTextNode("");f.observe(d,{characterData:!0}),o=function(){d.data=u=++u%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var h=new s.MessageChannel;h.port1.onmessage=w,o=function(){h.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var A=s.document.createElement("script");A.onreadystatechange=function(){w(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},s.document.documentElement.appendChild(A)}:o=function(){setTimeout(w,0)};var _,b=[];function w(){_=!0;for(var A,B,R=b.length;R;){for(B=b,b=[],A=-1;++A<R;)B[A]();R=b.length}_=!1}n.exports=C;function C(A){b.push(A)===1&&!_&&o()}}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,n,i){var s=t(1);function a(){}var o={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];n.exports=h;function h(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==a&&C(this,S)}h.prototype.catch=function(S){return this.then(null,S)},h.prototype.then=function(S,I){if(typeof S!="function"&&this.state===f||typeof I!="function"&&this.state===u)return this;var E=new this.constructor(a);if(this.state!==d){var j=this.state===f?S:I;b(E,j,this.outcome)}else this.queue.push(new _(E,S,I));return E};function _(S,I,E){this.promise=S,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}_.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},_.prototype.otherCallFulfilled=function(S){b(this.promise,this.onFulfilled,S)},_.prototype.callRejected=function(S){o.reject(this.promise,S)},_.prototype.otherCallRejected=function(S){b(this.promise,this.onRejected,S)};function b(S,I,E){s(function(){var j;try{j=I(E)}catch(F){return o.reject(S,F)}j===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,j)})}o.resolve=function(S,I){var E=A(w,I);if(E.status==="error")return o.reject(S,E.value);var j=E.value;if(j)C(S,j);else{S.state=f,S.outcome=I;for(var F=-1,H=S.queue.length;++F<H;)S.queue[F].callFulfilled(I)}return S},o.reject=function(S,I){S.state=u,S.outcome=I;for(var E=-1,j=S.queue.length;++E<j;)S.queue[E].callRejected(I);return S};function w(S){var I=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof I=="function")return function(){I.apply(S,arguments)}}function C(S,I){var E=!1;function j(se){E||(E=!0,o.reject(S,se))}function F(se){E||(E=!0,o.resolve(S,se))}function H(){I(F,j)}var U=A(H);U.status==="error"&&j(U.value)}function A(S,I){var E={};try{E.value=S(I),E.status="success"}catch(j){E.status="error",E.value=j}return E}h.resolve=B;function B(S){return S instanceof this?S:o.resolve(new this(a),S)}h.reject=R;function R(S){var I=new this(a);return o.reject(I,S)}h.all=D;function D(S){var I=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,j=!1;if(!E)return this.resolve([]);for(var F=new Array(E),H=0,U=-1,se=new this(a);++U<E;)ge(S[U],U);return se;function ge(vt,bt){I.resolve(vt).then(Xr,function(Mt){j||(j=!0,o.reject(se,Mt))});function Xr(Mt){F[bt]=Mt,++H===E&&!j&&(j=!0,o.resolve(se,F))}}}h.race=M;function M(S){var I=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=S.length,j=!1;if(!E)return this.resolve([]);for(var F=-1,H=new this(a);++F<E;)U(S[F]);return H;function U(se){I.resolve(se).then(function(ge){j||(j=!0,o.resolve(H,ge))},function(ge){j||(j=!0,o.reject(H,ge))})}}},{1:1}],3:[function(t,n,i){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,n,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l};function a(l,p){if(!(l instanceof p))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var u=o();function f(){try{if(!u||!u.open)return!1;var l=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),p=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!l||p)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(l,p){l=l||[],p=p||{};try{return new Blob(l,p)}catch(m){if(m.name!=="TypeError")throw m;for(var c=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,g=new c,v=0;v<l.length;v+=1)g.append(l[v]);return g.getBlob(p.type)}}typeof Promise>"u"&&t(3);var h=Promise;function _(l,p){p&&l.then(function(c){p(null,c)},function(c){p(c)})}function b(l,p,c){typeof p=="function"&&l.then(p),typeof c=="function"&&l.catch(c)}function w(l){return typeof l!="string"&&(console.warn(l+" used as a key, but it is not a string."),l=String(l)),l}function C(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var A="local-forage-detect-blob-support",B=void 0,R={},D=Object.prototype.toString,M="readonly",S="readwrite";function I(l){for(var p=l.length,c=new ArrayBuffer(p),g=new Uint8Array(c),v=0;v<p;v++)g[v]=l.charCodeAt(v);return c}function E(l){return new h(function(p){var c=l.transaction(A,S),g=d([""]);c.objectStore(A).put(g,"key"),c.onabort=function(v){v.preventDefault(),v.stopPropagation(),p(!1)},c.oncomplete=function(){var v=navigator.userAgent.match(/Chrome\/(\d+)/),m=navigator.userAgent.match(/Edge\//);p(m||!v||parseInt(v[1],10)>=43)}}).catch(function(){return!1})}function j(l){return typeof B=="boolean"?h.resolve(B):E(l).then(function(p){return B=p,B})}function F(l){var p=R[l.name],c={};c.promise=new h(function(g,v){c.resolve=g,c.reject=v}),p.deferredOperations.push(c),p.dbReady?p.dbReady=p.dbReady.then(function(){return c.promise}):p.dbReady=c.promise}function H(l){var p=R[l.name],c=p.deferredOperations.pop();if(c)return c.resolve(),c.promise}function U(l,p){var c=R[l.name],g=c.deferredOperations.pop();if(g)return g.reject(p),g.promise}function se(l,p){return new h(function(c,g){if(R[l.name]=R[l.name]||Ns(),l.db)if(p)F(l),l.db.close();else return c(l.db);var v=[l.name];p&&v.push(l.version);var m=u.open.apply(u,v);p&&(m.onupgradeneeded=function(y){var x=m.result;try{x.createObjectStore(l.storeName),y.oldVersion<=1&&x.createObjectStore(A)}catch(O){if(O.name==="ConstraintError")console.warn('The database "'+l.name+'" has been upgraded from version '+y.oldVersion+" to version "+y.newVersion+', but the storage "'+l.storeName+'" already exists.');else throw O}}),m.onerror=function(y){y.preventDefault(),g(m.error)},m.onsuccess=function(){var y=m.result;y.onversionchange=function(x){x.target.close()},c(y),H(l)}})}function ge(l){return se(l,!1)}function vt(l){return se(l,!0)}function bt(l,p){if(!l.db)return!0;var c=!l.db.objectStoreNames.contains(l.storeName),g=l.version<l.db.version,v=l.version>l.db.version;if(g&&(l.version!==p&&console.warn('The database "'+l.name+`" can't be downgraded from version `+l.db.version+" to version "+l.version+"."),l.version=l.db.version),v||c){if(c){var m=l.db.version+1;m>l.version&&(l.version=m)}return!0}return!1}function Xr(l){return new h(function(p,c){var g=new FileReader;g.onerror=c,g.onloadend=function(v){var m=btoa(v.target.result||"");p({__local_forage_encoded_blob:!0,data:m,type:l.type})},g.readAsBinaryString(l)})}function Mt(l){var p=I(atob(l.data));return d([p],{type:l.type})}function ks(l){return l&&l.__local_forage_encoded_blob}function Eu(l){var p=this,c=p._initReady().then(function(){var g=R[p._dbInfo.name];if(g&&g.dbReady)return g.dbReady});return b(c,l,l),c}function xu(l){F(l);for(var p=R[l.name],c=p.forages,g=0;g<c.length;g++){var v=c[g];v._dbInfo.db&&(v._dbInfo.db.close(),v._dbInfo.db=null)}return l.db=null,ge(l).then(function(m){return l.db=m,bt(l)?vt(l):m}).then(function(m){l.db=p.db=m;for(var y=0;y<c.length;y++)c[y]._dbInfo.db=m}).catch(function(m){throw U(l,m),m})}function Je(l,p,c,g){g===void 0&&(g=1);try{var v=l.db.transaction(l.storeName,p);c(null,v)}catch(m){if(g>0&&(!l.db||m.name==="InvalidStateError"||m.name==="NotFoundError"))return h.resolve().then(function(){if(!l.db||m.name==="NotFoundError"&&!l.db.objectStoreNames.contains(l.storeName)&&l.version<=l.db.version)return l.db&&(l.version=l.db.version+1),vt(l)}).then(function(){return xu(l).then(function(){Je(l,p,c,g-1)})}).catch(c);c(m)}}function Ns(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Cu(l){var p=this,c={db:null};if(l)for(var g in l)c[g]=l[g];var v=R[c.name];v||(v=Ns(),R[c.name]=v),v.forages.push(p),p._initReady||(p._initReady=p.ready,p.ready=Eu);var m=[];function y(){return h.resolve()}for(var x=0;x<v.forages.length;x++){var O=v.forages[x];O!==p&&m.push(O._initReady().catch(y))}var P=v.forages.slice(0);return h.all(m).then(function(){return c.db=v.db,ge(c)}).then(function($){return c.db=$,bt(c,p._defaultConfig.version)?vt(c):$}).then(function($){c.db=v.db=$,p._dbInfo=c;for(var k=0;k<P.length;k++){var V=P[k];V!==p&&(V._dbInfo.db=c.db,V._dbInfo.version=c.version)}})}function Ou(l,p){var c=this;l=w(l);var g=new h(function(v,m){c.ready().then(function(){Je(c._dbInfo,M,function(y,x){if(y)return m(y);try{var O=x.objectStore(c._dbInfo.storeName),P=O.get(l);P.onsuccess=function(){var $=P.result;$===void 0&&($=null),ks($)&&($=Mt($)),v($)},P.onerror=function(){m(P.error)}}catch($){m($)}})}).catch(m)});return _(g,p),g}function Ru(l,p){var c=this,g=new h(function(v,m){c.ready().then(function(){Je(c._dbInfo,M,function(y,x){if(y)return m(y);try{var O=x.objectStore(c._dbInfo.storeName),P=O.openCursor(),$=1;P.onsuccess=function(){var k=P.result;if(k){var V=k.value;ks(V)&&(V=Mt(V));var G=l(V,k.key,$++);G!==void 0?v(G):k.continue()}else v()},P.onerror=function(){m(P.error)}}catch(k){m(k)}})}).catch(m)});return _(g,p),g}function Pu(l,p,c){var g=this;l=w(l);var v=new h(function(m,y){var x;g.ready().then(function(){return x=g._dbInfo,D.call(p)==="[object Blob]"?j(x.db).then(function(O){return O?p:Xr(p)}):p}).then(function(O){Je(g._dbInfo,S,function(P,$){if(P)return y(P);try{var k=$.objectStore(g._dbInfo.storeName);O===null&&(O=void 0);var V=k.put(O,l);$.oncomplete=function(){O===void 0&&(O=null),m(O)},$.onabort=$.onerror=function(){var G=V.error?V.error:V.transaction.error;y(G)}}catch(G){y(G)}})}).catch(y)});return _(v,c),v}function $u(l,p){var c=this;l=w(l);var g=new h(function(v,m){c.ready().then(function(){Je(c._dbInfo,S,function(y,x){if(y)return m(y);try{var O=x.objectStore(c._dbInfo.storeName),P=O.delete(l);x.oncomplete=function(){v()},x.onerror=function(){m(P.error)},x.onabort=function(){var $=P.error?P.error:P.transaction.error;m($)}}catch($){m($)}})}).catch(m)});return _(g,p),g}function Tu(l){var p=this,c=new h(function(g,v){p.ready().then(function(){Je(p._dbInfo,S,function(m,y){if(m)return v(m);try{var x=y.objectStore(p._dbInfo.storeName),O=x.clear();y.oncomplete=function(){g()},y.onabort=y.onerror=function(){var P=O.error?O.error:O.transaction.error;v(P)}}catch(P){v(P)}})}).catch(v)});return _(c,l),c}function Iu(l){var p=this,c=new h(function(g,v){p.ready().then(function(){Je(p._dbInfo,M,function(m,y){if(m)return v(m);try{var x=y.objectStore(p._dbInfo.storeName),O=x.count();O.onsuccess=function(){g(O.result)},O.onerror=function(){v(O.error)}}catch(P){v(P)}})}).catch(v)});return _(c,l),c}function Mu(l,p){var c=this,g=new h(function(v,m){if(l<0){v(null);return}c.ready().then(function(){Je(c._dbInfo,M,function(y,x){if(y)return m(y);try{var O=x.objectStore(c._dbInfo.storeName),P=!1,$=O.openKeyCursor();$.onsuccess=function(){var k=$.result;if(!k){v(null);return}l===0||P?v(k.key):(P=!0,k.advance(l))},$.onerror=function(){m($.error)}}catch(k){m(k)}})}).catch(m)});return _(g,p),g}function ku(l){var p=this,c=new h(function(g,v){p.ready().then(function(){Je(p._dbInfo,M,function(m,y){if(m)return v(m);try{var x=y.objectStore(p._dbInfo.storeName),O=x.openKeyCursor(),P=[];O.onsuccess=function(){var $=O.result;if(!$){g(P);return}P.push($.key),$.continue()},O.onerror=function(){v(O.error)}}catch($){v($)}})}).catch(v)});return _(c,l),c}function Nu(l,p){p=C.apply(this,arguments);var c=this.config();l=typeof l!="function"&&l||{},l.name||(l.name=l.name||c.name,l.storeName=l.storeName||c.storeName);var g=this,v;if(!l.name)v=h.reject("Invalid arguments");else{var m=l.name===c.name&&g._dbInfo.db,y=m?h.resolve(g._dbInfo.db):ge(l).then(function(x){var O=R[l.name],P=O.forages;O.db=x;for(var $=0;$<P.length;$++)P[$]._dbInfo.db=x;return x});l.storeName?v=y.then(function(x){if(x.objectStoreNames.contains(l.storeName)){var O=x.version+1;F(l);var P=R[l.name],$=P.forages;x.close();for(var k=0;k<$.length;k++){var V=$[k];V._dbInfo.db=null,V._dbInfo.version=O}var G=new h(function(Y,re){var te=u.open(l.name,O);te.onerror=function(Ae){var fn=te.result;fn.close(),re(Ae)},te.onupgradeneeded=function(){var Ae=te.result;Ae.deleteObjectStore(l.storeName)},te.onsuccess=function(){var Ae=te.result;Ae.close(),Y(Ae)}});return G.then(function(Y){P.db=Y;for(var re=0;re<$.length;re++){var te=$[re];te._dbInfo.db=Y,H(te._dbInfo)}}).catch(function(Y){throw(U(l,Y)||h.resolve()).catch(function(){}),Y})}}):v=y.then(function(x){F(l);var O=R[l.name],P=O.forages;x.close();for(var $=0;$<P.length;$++){var k=P[$];k._dbInfo.db=null}var V=new h(function(G,Y){var re=u.deleteDatabase(l.name);re.onerror=function(){var te=re.result;te&&te.close(),Y(re.error)},re.onblocked=function(){console.warn('dropInstance blocked for database "'+l.name+'" until all open connections are closed')},re.onsuccess=function(){var te=re.result;te&&te.close(),G(te)}});return V.then(function(G){O.db=G;for(var Y=0;Y<P.length;Y++){var re=P[Y];H(re._dbInfo)}}).catch(function(G){throw(U(l,G)||h.resolve()).catch(function(){}),G})})}return _(v,p),v}var Du={_driver:"asyncStorage",_initStorage:Cu,_support:f(),iterate:Ru,getItem:Ou,setItem:Pu,removeItem:$u,clear:Tu,length:Iu,key:Mu,keys:ku,dropInstance:Nu};function Lu(){return typeof openDatabase=="function"}var rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bu="~~local_forage_type~",Ds=/^~~local_forage_type~([^~]+)~/,Yn="__lfsc__:",Jr=Yn.length,Gr="arbf",Yr="blob",Ls="si08",Bs="ui08",js="uic8",Us="si16",Fs="si32",Vs="ur16",Hs="ui32",Ws="fl32",Ks="fl64",qs=Jr+Gr.length,zs=Object.prototype.toString;function Xs(l){var p=l.length*.75,c=l.length,g,v=0,m,y,x,O;l[l.length-1]==="="&&(p--,l[l.length-2]==="="&&p--);var P=new ArrayBuffer(p),$=new Uint8Array(P);for(g=0;g<c;g+=4)m=rt.indexOf(l[g]),y=rt.indexOf(l[g+1]),x=rt.indexOf(l[g+2]),O=rt.indexOf(l[g+3]),$[v++]=m<<2|y>>4,$[v++]=(y&15)<<4|x>>2,$[v++]=(x&3)<<6|O&63;return P}function Qr(l){var p=new Uint8Array(l),c="",g;for(g=0;g<p.length;g+=3)c+=rt[p[g]>>2],c+=rt[(p[g]&3)<<4|p[g+1]>>4],c+=rt[(p[g+1]&15)<<2|p[g+2]>>6],c+=rt[p[g+2]&63];return p.length%3===2?c=c.substring(0,c.length-1)+"=":p.length%3===1&&(c=c.substring(0,c.length-2)+"=="),c}function ju(l,p){var c="";if(l&&(c=zs.call(l)),l&&(c==="[object ArrayBuffer]"||l.buffer&&zs.call(l.buffer)==="[object ArrayBuffer]")){var g,v=Yn;l instanceof ArrayBuffer?(g=l,v+=Gr):(g=l.buffer,c==="[object Int8Array]"?v+=Ls:c==="[object Uint8Array]"?v+=Bs:c==="[object Uint8ClampedArray]"?v+=js:c==="[object Int16Array]"?v+=Us:c==="[object Uint16Array]"?v+=Vs:c==="[object Int32Array]"?v+=Fs:c==="[object Uint32Array]"?v+=Hs:c==="[object Float32Array]"?v+=Ws:c==="[object Float64Array]"?v+=Ks:p(new Error("Failed to get type for BinaryArray"))),p(v+Qr(g))}else if(c==="[object Blob]"){var m=new FileReader;m.onload=function(){var y=Bu+l.type+"~"+Qr(this.result);p(Yn+Yr+y)},m.readAsArrayBuffer(l)}else try{p(JSON.stringify(l))}catch(y){console.error("Couldn't convert value into a JSON string: ",l),p(null,y)}}function Uu(l){if(l.substring(0,Jr)!==Yn)return JSON.parse(l);var p=l.substring(qs),c=l.substring(Jr,qs),g;if(c===Yr&&Ds.test(p)){var v=p.match(Ds);g=v[1],p=p.substring(v[0].length)}var m=Xs(p);switch(c){case Gr:return m;case Yr:return d([m],{type:g});case Ls:return new Int8Array(m);case Bs:return new Uint8Array(m);case js:return new Uint8ClampedArray(m);case Us:return new Int16Array(m);case Vs:return new Uint16Array(m);case Fs:return new Int32Array(m);case Hs:return new Uint32Array(m);case Ws:return new Float32Array(m);case Ks:return new Float64Array(m);default:throw new Error("Unkown type: "+c)}}var Zr={serialize:ju,deserialize:Uu,stringToBuffer:Xs,bufferToString:Qr};function Js(l,p,c,g){l.executeSql("CREATE TABLE IF NOT EXISTS "+p.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],c,g)}function Fu(l){var p=this,c={db:null};if(l)for(var g in l)c[g]=typeof l[g]!="string"?l[g].toString():l[g];var v=new h(function(m,y){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(x){return y(x)}c.db.transaction(function(x){Js(x,c,function(){p._dbInfo=c,m()},function(O,P){y(P)})},y)});return c.serializer=Zr,v}function it(l,p,c,g,v,m){l.executeSql(c,g,v,function(y,x){x.code===x.SYNTAX_ERR?y.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[p.storeName],function(O,P){P.rows.length?m(O,x):Js(O,p,function(){O.executeSql(c,g,v,m)},m)},m):m(y,x)},m)}function Vu(l,p){var c=this;l=w(l);var g=new h(function(v,m){c.ready().then(function(){var y=c._dbInfo;y.db.transaction(function(x){it(x,y,"SELECT * FROM "+y.storeName+" WHERE key = ? LIMIT 1",[l],function(O,P){var $=P.rows.length?P.rows.item(0).value:null;$&&($=y.serializer.deserialize($)),v($)},function(O,P){m(P)})})}).catch(m)});return _(g,p),g}function Hu(l,p){var c=this,g=new h(function(v,m){c.ready().then(function(){var y=c._dbInfo;y.db.transaction(function(x){it(x,y,"SELECT * FROM "+y.storeName,[],function(O,P){for(var $=P.rows,k=$.length,V=0;V<k;V++){var G=$.item(V),Y=G.value;if(Y&&(Y=y.serializer.deserialize(Y)),Y=l(Y,G.key,V+1),Y!==void 0){v(Y);return}}v()},function(O,P){m(P)})})}).catch(m)});return _(g,p),g}function Gs(l,p,c,g){var v=this;l=w(l);var m=new h(function(y,x){v.ready().then(function(){p===void 0&&(p=null);var O=p,P=v._dbInfo;P.serializer.serialize(p,function($,k){k?x(k):P.db.transaction(function(V){it(V,P,"INSERT OR REPLACE INTO "+P.storeName+" (key, value) VALUES (?, ?)",[l,$],function(){y(O)},function(G,Y){x(Y)})},function(V){if(V.code===V.QUOTA_ERR){if(g>0){y(Gs.apply(v,[l,O,c,g-1]));return}x(V)}})})}).catch(x)});return _(m,c),m}function Wu(l,p,c){return Gs.apply(this,[l,p,c,1])}function Ku(l,p){var c=this;l=w(l);var g=new h(function(v,m){c.ready().then(function(){var y=c._dbInfo;y.db.transaction(function(x){it(x,y,"DELETE FROM "+y.storeName+" WHERE key = ?",[l],function(){v()},function(O,P){m(P)})})}).catch(m)});return _(g,p),g}function qu(l){var p=this,c=new h(function(g,v){p.ready().then(function(){var m=p._dbInfo;m.db.transaction(function(y){it(y,m,"DELETE FROM "+m.storeName,[],function(){g()},function(x,O){v(O)})})}).catch(v)});return _(c,l),c}function zu(l){var p=this,c=new h(function(g,v){p.ready().then(function(){var m=p._dbInfo;m.db.transaction(function(y){it(y,m,"SELECT COUNT(key) as c FROM "+m.storeName,[],function(x,O){var P=O.rows.item(0).c;g(P)},function(x,O){v(O)})})}).catch(v)});return _(c,l),c}function Xu(l,p){var c=this,g=new h(function(v,m){c.ready().then(function(){var y=c._dbInfo;y.db.transaction(function(x){it(x,y,"SELECT key FROM "+y.storeName+" WHERE id = ? LIMIT 1",[l+1],function(O,P){var $=P.rows.length?P.rows.item(0).key:null;v($)},function(O,P){m(P)})})}).catch(m)});return _(g,p),g}function Ju(l){var p=this,c=new h(function(g,v){p.ready().then(function(){var m=p._dbInfo;m.db.transaction(function(y){it(y,m,"SELECT key FROM "+m.storeName,[],function(x,O){for(var P=[],$=0;$<O.rows.length;$++)P.push(O.rows.item($).key);g(P)},function(x,O){v(O)})})}).catch(v)});return _(c,l),c}function Gu(l){return new h(function(p,c){l.transaction(function(g){g.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(v,m){for(var y=[],x=0;x<m.rows.length;x++)y.push(m.rows.item(x).name);p({db:l,storeNames:y})},function(v,m){c(m)})},function(g){c(g)})})}function Yu(l,p){p=C.apply(this,arguments);var c=this.config();l=typeof l!="function"&&l||{},l.name||(l.name=l.name||c.name,l.storeName=l.storeName||c.storeName);var g=this,v;return l.name?v=new h(function(m){var y;l.name===c.name?y=g._dbInfo.db:y=openDatabase(l.name,"","",0),l.storeName?m({db:y,storeNames:[l.storeName]}):m(Gu(y))}).then(function(m){return new h(function(y,x){m.db.transaction(function(O){function P(G){return new h(function(Y,re){O.executeSql("DROP TABLE IF EXISTS "+G,[],function(){Y()},function(te,Ae){re(Ae)})})}for(var $=[],k=0,V=m.storeNames.length;k<V;k++)$.push(P(m.storeNames[k]));h.all($).then(function(){y()}).catch(function(G){x(G)})},function(O){x(O)})})}):v=h.reject("Invalid arguments"),_(v,p),v}var Qu={_driver:"webSQLStorage",_initStorage:Fu,_support:Lu(),iterate:Hu,getItem:Vu,setItem:Wu,removeItem:Ku,clear:qu,length:zu,key:Xu,keys:Ju,dropInstance:Yu};function Zu(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ys(l,p){var c=l.name+"/";return l.storeName!==p.storeName&&(c+=l.storeName+"/"),c}function ec(){var l="_localforage_support_test";try{return localStorage.setItem(l,!0),localStorage.removeItem(l),!1}catch{return!0}}function tc(){return!ec()||localStorage.length>0}function nc(l){var p=this,c={};if(l)for(var g in l)c[g]=l[g];return c.keyPrefix=Ys(l,p._defaultConfig),tc()?(p._dbInfo=c,c.serializer=Zr,h.resolve()):h.reject()}function rc(l){var p=this,c=p.ready().then(function(){for(var g=p._dbInfo.keyPrefix,v=localStorage.length-1;v>=0;v--){var m=localStorage.key(v);m.indexOf(g)===0&&localStorage.removeItem(m)}});return _(c,l),c}function ic(l,p){var c=this;l=w(l);var g=c.ready().then(function(){var v=c._dbInfo,m=localStorage.getItem(v.keyPrefix+l);return m&&(m=v.serializer.deserialize(m)),m});return _(g,p),g}function sc(l,p){var c=this,g=c.ready().then(function(){for(var v=c._dbInfo,m=v.keyPrefix,y=m.length,x=localStorage.length,O=1,P=0;P<x;P++){var $=localStorage.key(P);if($.indexOf(m)===0){var k=localStorage.getItem($);if(k&&(k=v.serializer.deserialize(k)),k=l(k,$.substring(y),O++),k!==void 0)return k}}});return _(g,p),g}function ac(l,p){var c=this,g=c.ready().then(function(){var v=c._dbInfo,m;try{m=localStorage.key(l)}catch{m=null}return m&&(m=m.substring(v.keyPrefix.length)),m});return _(g,p),g}function oc(l){var p=this,c=p.ready().then(function(){for(var g=p._dbInfo,v=localStorage.length,m=[],y=0;y<v;y++){var x=localStorage.key(y);x.indexOf(g.keyPrefix)===0&&m.push(x.substring(g.keyPrefix.length))}return m});return _(c,l),c}function lc(l){var p=this,c=p.keys().then(function(g){return g.length});return _(c,l),c}function uc(l,p){var c=this;l=w(l);var g=c.ready().then(function(){var v=c._dbInfo;localStorage.removeItem(v.keyPrefix+l)});return _(g,p),g}function cc(l,p,c){var g=this;l=w(l);var v=g.ready().then(function(){p===void 0&&(p=null);var m=p;return new h(function(y,x){var O=g._dbInfo;O.serializer.serialize(p,function(P,$){if($)x($);else try{localStorage.setItem(O.keyPrefix+l,P),y(m)}catch(k){(k.name==="QuotaExceededError"||k.name==="NS_ERROR_DOM_QUOTA_REACHED")&&x(k),x(k)}})})});return _(v,c),v}function fc(l,p){if(p=C.apply(this,arguments),l=typeof l!="function"&&l||{},!l.name){var c=this.config();l.name=l.name||c.name,l.storeName=l.storeName||c.storeName}var g=this,v;return l.name?v=new h(function(m){l.storeName?m(Ys(l,g._defaultConfig)):m(l.name+"/")}).then(function(m){for(var y=localStorage.length-1;y>=0;y--){var x=localStorage.key(y);x.indexOf(m)===0&&localStorage.removeItem(x)}}):v=h.reject("Invalid arguments"),_(v,p),v}var hc={_driver:"localStorageWrapper",_initStorage:nc,_support:Zu(),iterate:sc,getItem:ic,setItem:cc,removeItem:uc,clear:rc,length:lc,key:ac,keys:oc,dropInstance:fc},dc=function(p,c){return p===c||typeof p=="number"&&typeof c=="number"&&isNaN(p)&&isNaN(c)},pc=function(p,c){for(var g=p.length,v=0;v<g;){if(dc(p[v],c))return!0;v++}return!1},Qs=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"},cn={},Zs={},kt={INDEXEDDB:Du,WEBSQL:Qu,LOCALSTORAGE:hc},mc=[kt.INDEXEDDB._driver,kt.WEBSQL._driver,kt.LOCALSTORAGE._driver],Qn=["dropInstance"],ei=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Qn),gc={description:"",driver:mc.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function _c(l,p){l[p]=function(){var c=arguments;return l.ready().then(function(){return l[p].apply(l,c)})}}function ti(){for(var l=1;l<arguments.length;l++){var p=arguments[l];if(p)for(var c in p)p.hasOwnProperty(c)&&(Qs(p[c])?arguments[0][c]=p[c].slice():arguments[0][c]=p[c])}return arguments[0]}var vc=function(){function l(p){a(this,l);for(var c in kt)if(kt.hasOwnProperty(c)){var g=kt[c],v=g._driver;this[c]=v,cn[v]||this.defineDriver(g)}this._defaultConfig=ti({},gc),this._config=ti({},this._defaultConfig,p),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return l.prototype.config=function(c){if((typeof c>"u"?"undefined":s(c))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var g in c){if(g==="storeName"&&(c[g]=c[g].replace(/\W/g,"_")),g==="version"&&typeof c[g]!="number")return new Error("Database version must be a number.");this._config[g]=c[g]}return"driver"in c&&c.driver?this.setDriver(this._config.driver):!0}else return typeof c=="string"?this._config[c]:this._config},l.prototype.defineDriver=function(c,g,v){var m=new h(function(y,x){try{var O=c._driver,P=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!c._driver){x(P);return}for(var $=ei.concat("_initStorage"),k=0,V=$.length;k<V;k++){var G=$[k],Y=!pc(Qn,G);if((Y||c[G])&&typeof c[G]!="function"){x(P);return}}var re=function(){for(var fn=function(wc){return function(){var Ac=new Error("Method "+wc+" is not implemented by the current driver"),ea=h.reject(Ac);return _(ea,arguments[arguments.length-1]),ea}},ni=0,yc=Qn.length;ni<yc;ni++){var ri=Qn[ni];c[ri]||(c[ri]=fn(ri))}};re();var te=function(fn){cn[O]&&console.info("Redefining LocalForage driver: "+O),cn[O]=c,Zs[O]=fn,y()};"_support"in c?c._support&&typeof c._support=="function"?c._support().then(te,x):te(!!c._support):te(!0)}catch(Ae){x(Ae)}});return b(m,g,v),m},l.prototype.driver=function(){return this._driver||null},l.prototype.getDriver=function(c,g,v){var m=cn[c]?h.resolve(cn[c]):h.reject(new Error("Driver not found."));return b(m,g,v),m},l.prototype.getSerializer=function(c){var g=h.resolve(Zr);return b(g,c),g},l.prototype.ready=function(c){var g=this,v=g._driverSet.then(function(){return g._ready===null&&(g._ready=g._initDriver()),g._ready});return b(v,c,c),v},l.prototype.setDriver=function(c,g,v){var m=this;Qs(c)||(c=[c]);var y=this._getSupportedDrivers(c);function x(){m._config.driver=m.driver()}function O(k){return m._extend(k),x(),m._ready=m._initStorage(m._config),m._ready}function P(k){return function(){var V=0;function G(){for(;V<k.length;){var Y=k[V];return V++,m._dbInfo=null,m._ready=null,m.getDriver(Y).then(O).catch(G)}x();var re=new Error("No available storage method found.");return m._driverSet=h.reject(re),m._driverSet}return G()}}var $=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=$.then(function(){var k=y[0];return m._dbInfo=null,m._ready=null,m.getDriver(k).then(function(V){m._driver=V._driver,x(),m._wrapLibraryMethodsWithReady(),m._initDriver=P(y)})}).catch(function(){x();var k=new Error("No available storage method found.");return m._driverSet=h.reject(k),m._driverSet}),b(this._driverSet,g,v),this._driverSet},l.prototype.supports=function(c){return!!Zs[c]},l.prototype._extend=function(c){ti(this,c)},l.prototype._getSupportedDrivers=function(c){for(var g=[],v=0,m=c.length;v<m;v++){var y=c[v];this.supports(y)&&g.push(y)}return g},l.prototype._wrapLibraryMethodsWithReady=function(){for(var c=0,g=ei.length;c<g;c++)_c(this,ei[c])},l.prototype.createInstance=function(c){return new l(c)},l}(),bc=new vc;n.exports=bc},{3:3}]},{},[4])(4)})}(oi)),oi.exports}var Ah=wh();const Sh=yh(Ah),gt=Sh.createInstance({name:"remembrain"}),ss="history",ut=Vr({chats:[]});es(()=>ut.chats.length,()=>{gt.setItem(ss,Xo(ut.chats))});gt.getItem(ss).then(r=>{r&&Tt(()=>{ut.chats=r})});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const dr=globalThis,as=dr.ShadowRoot&&(dr.ShadyCSS===void 0||dr.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,sl=Symbol(),wa=new WeakMap;let Eh=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==sl)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(as&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=wa.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&wa.set(t,e))}return e}toString(){return this.cssText}};const xh=r=>new Eh(typeof r=="string"?r:r+"",void 0,sl),Ch=(r,e)=>{if(as)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),i=dr.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=t.cssText,r.appendChild(n)}},Aa=as?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return xh(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Oh,defineProperty:Rh,getOwnPropertyDescriptor:Ph,getOwnPropertyNames:$h,getOwnPropertySymbols:Th,getPrototypeOf:Ih}=Object,ht=globalThis,Sa=ht.trustedTypes,Mh=Sa?Sa.emptyScript:"",li=ht.reactiveElementPolyfillSupport,wn=(r,e)=>r,Or={toAttribute(r,e){switch(e){case Boolean:r=r?Mh:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},os=(r,e)=>!Oh(r,e),Ea={attribute:!0,type:String,converter:Or,reflect:!1,hasChanged:os};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ht.litPropertyMetadata??(ht.litPropertyMetadata=new WeakMap);class Ut extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Ea){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);i!==void 0&&Rh(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:s}=Ph(this.prototype,e)??{get(){return this[t]},set(a){this[t]=a}};return{get(){return i==null?void 0:i.call(this)},set(a){const o=i==null?void 0:i.call(this);s.call(this,a),this.requestUpdate(e,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Ea}static _$Ei(){if(this.hasOwnProperty(wn("elementProperties")))return;const e=Ih(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(wn("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(wn("properties"))){const t=this.properties,n=[...$h(t),...Th(t)];for(const i of n)this.createProperty(i,t[i])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,i]of t)this.elementProperties.set(n,i)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const i=this._$Eu(t,n);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const i of n)t.unshift(Aa(i))}else e!==void 0&&t.push(Aa(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Ch(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EC(e,t){var s;const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(i!==void 0&&n.reflect===!0){const a=(((s=n.converter)==null?void 0:s.toAttribute)!==void 0?n.converter:Or).toAttribute(t,n.type);this._$Em=e,a==null?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){var s;const n=this.constructor,i=n._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const a=n.getPropertyOptions(i),o=typeof a.converter=="function"?{fromAttribute:a.converter}:((s=a.converter)==null?void 0:s.fromAttribute)!==void 0?a.converter:Or;this._$Em=i,this[i]=o.fromAttribute(t,a.type),this._$Em=null}}requestUpdate(e,t,n){if(e!==void 0){if(n??(n=this.constructor.getPropertyOptions(e)),!(n.hasChanged??os)(this[e],t))return;this.P(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,n){this._$AL.has(e)||this._$AL.set(e,t),n.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[s,a]of this._$Ep)this[s]=a;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,a]of i)a.wrapped!==!0||this._$AL.has(s)||this[s]===void 0||this.P(s,this[s],a)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$EO)==null||n.forEach(i=>{var s;return(s=i.hostUpdate)==null?void 0:s.call(i)}),this.update(t)):this._$EU()}catch(i){throw e=!1,this._$EU(),i}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(n=>{var i;return(i=n.hostUpdated)==null?void 0:i.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}}Ut.elementStyles=[],Ut.shadowRootOptions={mode:"open"},Ut[wn("elementProperties")]=new Map,Ut[wn("finalized")]=new Map,li==null||li({ReactiveElement:Ut}),(ht.reactiveElementVersions??(ht.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const An=globalThis,Rr=An.trustedTypes,xa=Rr?Rr.createPolicy("lit-html",{createHTML:r=>r}):void 0,al="$lit$",at=`lit$${Math.random().toFixed(9).slice(2)}$`,ol="?"+at,kh=`<${ol}>`,Rt=document,Pn=()=>Rt.createComment(""),$n=r=>r===null||typeof r!="object"&&typeof r!="function",ls=Array.isArray,Nh=r=>ls(r)||typeof(r==null?void 0:r[Symbol.iterator])=="function",ui=`[ 	
\f\r]`,hn=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ca=/-->/g,Oa=/>/g,yt=RegExp(`>|${ui}(?:([^\\s"'>=/]+)(${ui}*=${ui}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ra=/'/g,Pa=/"/g,ll=/^(?:script|style|textarea|title)$/i,Dh=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),X=Dh(1),en=Symbol.for("lit-noChange"),ue=Symbol.for("lit-nothing"),$a=new WeakMap,At=Rt.createTreeWalker(Rt,129);function ul(r,e){if(!ls(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return xa!==void 0?xa.createHTML(e):e}const Lh=(r,e)=>{const t=r.length-1,n=[];let i,s=e===2?"<svg>":e===3?"<math>":"",a=hn;for(let o=0;o<t;o++){const u=r[o];let f,d,h=-1,_=0;for(;_<u.length&&(a.lastIndex=_,d=a.exec(u),d!==null);)_=a.lastIndex,a===hn?d[1]==="!--"?a=Ca:d[1]!==void 0?a=Oa:d[2]!==void 0?(ll.test(d[2])&&(i=RegExp("</"+d[2],"g")),a=yt):d[3]!==void 0&&(a=yt):a===yt?d[0]===">"?(a=i??hn,h=-1):d[1]===void 0?h=-2:(h=a.lastIndex-d[2].length,f=d[1],a=d[3]===void 0?yt:d[3]==='"'?Pa:Ra):a===Pa||a===Ra?a=yt:a===Ca||a===Oa?a=hn:(a=yt,i=void 0);const b=a===yt&&r[o+1].startsWith("/>")?" ":"";s+=a===hn?u+kh:h>=0?(n.push(f),u.slice(0,h)+al+u.slice(h)+at+b):u+at+(h===-2?o:b)}return[ul(r,s+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Tn{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let s=0,a=0;const o=e.length-1,u=this.parts,[f,d]=Lh(e,t);if(this.el=Tn.createElement(f,n),At.currentNode=this.el.content,t===2||t===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=At.nextNode())!==null&&u.length<o;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(al)){const _=d[a++],b=i.getAttribute(h).split(at),w=/([.?@])?(.*)/.exec(_);u.push({type:1,index:s,name:w[2],strings:b,ctor:w[1]==="."?jh:w[1]==="?"?Uh:w[1]==="@"?Fh:Hr}),i.removeAttribute(h)}else h.startsWith(at)&&(u.push({type:6,index:s}),i.removeAttribute(h));if(ll.test(i.tagName)){const h=i.textContent.split(at),_=h.length-1;if(_>0){i.textContent=Rr?Rr.emptyScript:"";for(let b=0;b<_;b++)i.append(h[b],Pn()),At.nextNode(),u.push({type:2,index:++s});i.append(h[_],Pn())}}}else if(i.nodeType===8)if(i.data===ol)u.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(at,h+1))!==-1;)u.push({type:7,index:s}),h+=at.length-1}s++}}static createElement(e,t){const n=Rt.createElement("template");return n.innerHTML=e,n}}function tn(r,e,t=r,n){var a,o;if(e===en)return e;let i=n!==void 0?(a=t._$Co)==null?void 0:a[n]:t._$Cl;const s=$n(e)?void 0:e._$litDirective$;return(i==null?void 0:i.constructor)!==s&&((o=i==null?void 0:i._$AO)==null||o.call(i,!1),s===void 0?i=void 0:(i=new s(r),i._$AT(r,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=i:t._$Cl=i),i!==void 0&&(e=tn(r,i._$AS(r,e.values),i,n)),e}class Bh{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=((e==null?void 0:e.creationScope)??Rt).importNode(t,!0);At.currentNode=i;let s=At.nextNode(),a=0,o=0,u=n[0];for(;u!==void 0;){if(a===u.index){let f;u.type===2?f=new Hn(s,s.nextSibling,this,e):u.type===1?f=new u.ctor(s,u.name,u.strings,this,e):u.type===6&&(f=new Vh(s,this,e)),this._$AV.push(f),u=n[++o]}a!==(u==null?void 0:u.index)&&(s=At.nextNode(),a++)}return At.currentNode=Rt,i}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class Hn{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=ue,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=(i==null?void 0:i.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=tn(this,e,t),$n(e)?e===ue||e==null||e===""?(this._$AH!==ue&&this._$AR(),this._$AH=ue):e!==this._$AH&&e!==en&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Nh(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==ue&&$n(this._$AH)?this._$AA.nextSibling.data=e:this.T(Rt.createTextNode(e)),this._$AH=e}$(e){var s;const{values:t,_$litType$:n}=e,i=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Tn.createElement(ul(n.h,n.h[0]),this.options)),n);if(((s=this._$AH)==null?void 0:s._$AD)===i)this._$AH.p(t);else{const a=new Bh(i,this),o=a.u(this.options);a.p(t),this.T(o),this._$AH=a}}_$AC(e){let t=$a.get(e.strings);return t===void 0&&$a.set(e.strings,t=new Tn(e)),t}k(e){ls(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const s of e)i===t.length?t.push(n=new Hn(this.O(Pn()),this.O(Pn()),this,this.options)):n=t[i],n._$AI(s),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Hr{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,s){this.type=1,this._$AH=ue,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=ue}_$AI(e,t=this,n,i){const s=this.strings;let a=!1;if(s===void 0)e=tn(this,e,t,0),a=!$n(e)||e!==this._$AH&&e!==en,a&&(this._$AH=e);else{const o=e;let u,f;for(e=s[0],u=0;u<s.length-1;u++)f=tn(this,o[n+u],t,u),f===en&&(f=this._$AH[u]),a||(a=!$n(f)||f!==this._$AH[u]),f===ue?e=ue:e!==ue&&(e+=(f??"")+s[u+1]),this._$AH[u]=f}a&&!i&&this.j(e)}j(e){e===ue?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class jh extends Hr{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ue?void 0:e}}class Uh extends Hr{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ue)}}class Fh extends Hr{constructor(e,t,n,i,s){super(e,t,n,i,s),this.type=5}_$AI(e,t=this){if((e=tn(this,e,t,0)??ue)===en)return;const n=this._$AH,i=e===ue&&n!==ue||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,s=e!==ue&&(n===ue||i);i&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class Vh{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){tn(this,e)}}const ci=An.litHtmlPolyfillSupport;ci==null||ci(Tn,Hn),(An.litHtmlVersions??(An.litHtmlVersions=[])).push("3.2.1");const Hh=(r,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let i=n._$litPart$;if(i===void 0){const s=(t==null?void 0:t.renderBefore)??null;n._$litPart$=i=new Hn(e.insertBefore(Pn(),s),s,void 0,t??{})}return i._$AI(r),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let ie=class extends Ut{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Hh(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return en}};var oo;ie._$litElement$=!0,ie.finalized=!0,(oo=globalThis.litElementHydrateSupport)==null||oo.call(globalThis,{LitElement:ie});const fi=globalThis.litElementPolyfillSupport;fi==null||fi({LitElement:ie});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");let Wh=class extends ie{constructor(){super(...arguments),this.router=new Oc(this,[{path:"/",render:()=>X`<x-homepage></x-homepage>`},{path:"/chat",render:()=>(il(),X`<x-chat></x-chat>`)},{path:"/chat/:id?",enter:async({id:e})=>{const n=(await gt.getItem(ss)).find(i=>i.id===e);return ne.id=e,ne.title=(n==null?void 0:n.title)??"Untitled Conversation",ne.messages=(n==null?void 0:n.messages)??[],!0},render:({id:e})=>X`<x-chat></x-chat>`},{path:"/settings",render:()=>X`<x-settings-general></x-settings-general>`},{path:"/settings/integrations",render:()=>X`<x-settings-integrations></x-settings-integrations>`},{path:"/knowledgebase",enter:async()=>(await lo(()=>import("./x-knowledgebase-DwxK5McB.js"),[]),!0),render:()=>X`<x-knowledgebase></x-knowledgebase>`}])}createRenderRoot(){return this}render(){return X` <div class="h-screen flex flex-col">
      <!-- Navbar -->
      <x-navbar></x-navbar>
      <div class="flex-1 flex flex-row  overflow-hidden">
        <!-- Left Sidebar -->
        <input type="checkbox" id="drawer-toggle" class="hidden peer/sidebar" />
        <x-sidebar
          class="w-[35%] md:w-[30%] lg:w-[25%] peer-checked/sidebar:w-0 transition-all"
        ></x-sidebar>
        <!-- Router area -->
        <div class="flex flex-1 *:w-full overflow-y-scroll">
          ${this.router.outlet()}
        </div>
      </div>
    </div>`}};customElements.define("x-router",Wh);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const je=r=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(r,e)}):customElements.define(r,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Kh={attribute:!0,type:String,converter:Or,reflect:!1,hasChanged:os},qh=(r=Kh,e,t)=>{const{kind:n,metadata:i}=t;let s=globalThis.litPropertyMetadata.get(i);if(s===void 0&&globalThis.litPropertyMetadata.set(i,s=new Map),s.set(t.name,r),n==="accessor"){const{name:a}=t;return{set(o){const u=e.get.call(this);e.set.call(this,o),this.requestUpdate(a,u,r)},init(o){return o!==void 0&&this.P(a,void 0,r),o}}}if(n==="setter"){const{name:a}=t;return function(o){const u=this[a];e.call(this,o),this.requestUpdate(a,u,r)}}throw Error("Unsupported decorator location: "+n)};function Wn(r){return(e,t)=>typeof t=="object"?qh(r,e,t):((n,i,s)=>{const a=i.hasOwnProperty(s);return i.constructor.createProperty(s,a?{...n,wrapped:!0}:n),a?Object.getOwnPropertyDescriptor(i,s):void 0})(r,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function cl(r){return Wn({...r,state:!0,attribute:!1})}const Ni="RFC3986",Di={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},zh="RFC1738",Xh=Array.isArray,Fe=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),hi=1024,Jh=(r,e,t,n,i)=>{if(r.length===0)return r;let s=r;if(typeof r=="symbol"?s=Symbol.prototype.toString.call(r):typeof r!="string"&&(s=String(r)),t==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<s.length;o+=hi){const u=s.length>=hi?s.slice(o,o+hi):s,f=[];for(let d=0;d<u.length;++d){let h=u.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||i===zh&&(h===40||h===41)){f[f.length]=u.charAt(d);continue}if(h<128){f[f.length]=Fe[h];continue}if(h<2048){f[f.length]=Fe[192|h>>6]+Fe[128|h&63];continue}if(h<55296||h>=57344){f[f.length]=Fe[224|h>>12]+Fe[128|h>>6&63]+Fe[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|u.charCodeAt(d)&1023),f[f.length]=Fe[240|h>>18]+Fe[128|h>>12&63]+Fe[128|h>>6&63]+Fe[128|h&63]}a+=f.join("")}return a};function Gh(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function Ta(r,e){if(Xh(r)){const t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}const Yh=Object.prototype.hasOwnProperty,fl={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Ve=Array.isArray,Qh=Array.prototype.push,hl=function(r,e){Qh.apply(r,Ve(e)?e:[e])},Zh=Date.prototype.toISOString,oe={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Jh,encodeValuesOnly:!1,format:Ni,formatter:Di[Ni],indices:!1,serializeDate(r){return Zh.call(r)},skipNulls:!1,strictNullHandling:!1};function ed(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const di={};function dl(r,e,t,n,i,s,a,o,u,f,d,h,_,b,w,C,A,B){let R=r,D=B,M=0,S=!1;for(;(D=D.get(di))!==void 0&&!S;){const H=D.get(r);if(M+=1,typeof H<"u"){if(H===M)throw new RangeError("Cyclic object value");S=!0}typeof D.get(di)>"u"&&(M=0)}if(typeof f=="function"?R=f(e,R):R instanceof Date?R=_==null?void 0:_(R):t==="comma"&&Ve(R)&&(R=Ta(R,function(H){return H instanceof Date?_==null?void 0:_(H):H})),R===null){if(s)return u&&!C?u(e,oe.encoder,A,"key",b):e;R=""}if(ed(R)||Gh(R)){if(u){const H=C?e:u(e,oe.encoder,A,"key",b);return[(w==null?void 0:w(H))+"="+(w==null?void 0:w(u(R,oe.encoder,A,"value",b)))]}return[(w==null?void 0:w(e))+"="+(w==null?void 0:w(String(R)))]}const I=[];if(typeof R>"u")return I;let E;if(t==="comma"&&Ve(R))C&&u&&(R=Ta(R,u)),E=[{value:R.length>0?R.join(",")||null:void 0}];else if(Ve(f))E=f;else{const H=Object.keys(R);E=d?H.sort(d):H}const j=o?String(e).replace(/\./g,"%2E"):String(e),F=n&&Ve(R)&&R.length===1?j+"[]":j;if(i&&Ve(R)&&R.length===0)return F+"[]";for(let H=0;H<E.length;++H){const U=E[H],se=typeof U=="object"&&typeof U.value<"u"?U.value:R[U];if(a&&se===null)continue;const ge=h&&o?U.replace(/\./g,"%2E"):U,vt=Ve(R)?typeof t=="function"?t(F,ge):F:F+(h?"."+ge:"["+ge+"]");B.set(r,M);const bt=new WeakMap;bt.set(di,B),hl(I,dl(se,vt,t,n,i,s,a,o,t==="comma"&&C&&Ve(R)?null:u,f,d,h,_,b,w,C,A,bt))}return I}function td(r=oe){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||oe.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Ni;if(typeof r.format<"u"){if(!Yh.call(Di,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const n=Di[t];let i=oe.filter;(typeof r.filter=="function"||Ve(r.filter))&&(i=r.filter);let s;if(r.arrayFormat&&r.arrayFormat in fl?s=r.arrayFormat:"indices"in r?s=r.indices?"indices":"repeat":s=oe.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:oe.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:oe.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:oe.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:oe.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?oe.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:oe.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:oe.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:oe.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:oe.encodeValuesOnly,filter:i,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:oe.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:oe.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:oe.strictNullHandling}}function nd(r,e={}){let t=r;const n=td(e);let i,s;typeof n.filter=="function"?(s=n.filter,t=s("",t)):Ve(n.filter)&&(s=n.filter,i=s);const a=[];if(typeof t!="object"||t===null)return"";const o=fl[n.arrayFormat],u=o==="comma"&&n.commaRoundTrip;i||(i=Object.keys(t)),n.sort&&i.sort(n.sort);const f=new WeakMap;for(let _=0;_<i.length;++_){const b=i[_];n.skipNulls&&t[b]===null||hl(a,dl(t[b],b,o,u,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}const d=a.join(n.delimiter);let h=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const Ft="4.82.0";let Ia=!1,Sn,pl,ml,Li,gl,_l,vl,bl,yl;function rd(r,e={auto:!1}){if(Ia)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(Sn)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${Sn}'\``);Ia=e.auto,Sn=r.kind,pl=r.fetch,ml=r.FormData,Li=r.File,gl=r.ReadableStream,_l=r.getMultipartRequestOptions,vl=r.getDefaultAgent,bl=r.fileFromPath,yl=r.isFsReadStream}class id{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function sd({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,i,s;try{t=fetch,n=Request,i=Response,s=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new id(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Sn||rd(sd(),{auto:!0});class W extends Error{}class he extends W{constructor(e,t,n,i){super(`${he.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["x-request-id"],this.error=t;const s=t;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,t,n){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new Wr({message:n,cause:ji(t)});const s=t==null?void 0:t.error;return e===400?new wl(e,s,n,i):e===401?new Al(e,s,n,i):e===403?new Sl(e,s,n,i):e===404?new El(e,s,n,i):e===409?new xl(e,s,n,i):e===422?new Cl(e,s,n,i):e===429?new Ol(e,s,n,i):e>=500?new Rl(e,s,n,i):new he(e,s,n,i)}}class Ie extends he{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Wr extends he{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class us extends Wr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class wl extends he{}class Al extends he{}class Sl extends he{}class El extends he{}class xl extends he{}class Cl extends he{}class Ol extends he{}class Rl extends he{}class Pl extends W{constructor(){super("Could not parse response content as the length limit was reached")}}class $l extends W{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Pt{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=Pt.NEWLINE_CHARS.has(t[t.length-1]||"");let i=t.split(Pt.NEWLINE_REGEXP);return n&&i.pop(),i.length===1&&!n?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),n||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new W(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new W(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new W("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Pt.NEWLINE_CHARS=new Set([`
`,"\r"]);Pt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Tl(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class We{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const a of ad(e,t))if(!s){if(a.data.startsWith("[DONE]")){s=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(o&&o.error)throw new he(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(a.event=="error")throw new he(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}s=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{s||t.abort()}}return new We(i,t)}static fromReadableStream(e,t){let n=!1;async function*i(){const a=new Pt,o=Tl(e);for await(const u of o)for(const f of a.decode(u))yield f;for(const u of a.flush())yield u}async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of i())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new We(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=s=>({next:()=>{if(s.length===0){const a=n.next();e.push(a),t.push(a)}return s.shift()}});return[new We(()=>i(e),this.controller),new We(()=>i(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new gl({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await t.next();if(a)return i.close();const o=n.encode(JSON.stringify(s)+`
`);i.enqueue(o)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)==null?void 0:i.call(t))}})}}async function*ad(r,e){if(!r.body)throw e.abort(),new W("Attempted to iterate over a response with no body");const t=new ud,n=new Pt,i=Tl(r.body);for await(const s of od(i))for(const a of n.decode(s)){const o=t.decode(a);o&&(yield o)}for(const s of n.flush()){const a=t.decode(s);a&&(yield a)}}async function*od(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let s;for(;(s=ld(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}function ld(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class ud{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=cd(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function cd(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}const Il=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",Ml=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Kr(r),Kr=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",fd=r=>Ml(r)||Il(r)||yl(r);async function kl(r,e,t){var i;if(r=await r,Ml(r))return r;if(Il(r)){const s=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=Kr(s)?[await s.arrayBuffer()]:[s];return new Li(a,e,t)}const n=await hd(r);if(e||(e=pd(r)??"unknown_file"),!(t!=null&&t.type)){const s=(i=n[0])==null?void 0:i.type;typeof s=="string"&&(t={...t,type:s})}return new Li(n,e,t)}async function hd(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Kr(r))e.push(await r.arrayBuffer());else if(md(r))for await(const n of r)e.push(n);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t=r==null?void 0:r.constructor)==null?void 0:t.name}; props: ${dd(r)}`);return e}function dd(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function pd(r){var e;return pi(r.name)||pi(r.filename)||((e=pi(r.path))==null?void 0:e.split(/[\\/]/).pop())}const pi=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},md=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",Ma=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",nn=async r=>{const e=await gd(r.body);return _l(e,r)},gd=async r=>{const e=new ml;return await Promise.all(Object.entries(r||{}).map(([t,n])=>Bi(e,t,n))),e},Bi=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(fd(t)){const n=await kl(t);r.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>Bi(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,i])=>Bi(r,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var zt={},_d=function(r,e,t,n,i){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},vd=function(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},sr;async function Nl(r){const{response:e}=r;if(r.options.stream)return Xt("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):We.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const s=await e.json();return Xt("response",e.status,e.url,e.headers,s),Dl(s,e)}const i=await e.text();return Xt("response",e.status,e.url,e.headers,i),i}function Dl(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class qr extends Promise{constructor(e,t=Nl){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new qr(this.responsePromise,async t=>Dl(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class bd{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=mi("maxRetries",t),this.timeout=mi("timeout",n),this.httpAgent=i,this.fetch=s??pl}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...xd(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Pd()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async i=>{const s=i&&Kr(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:t,...i,body:s}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var C;const{method:n,path:i,query:s,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Ma(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(o),f=this.buildURL(i,s);"timeout"in e&&mi("timeout",e.timeout);const d=e.timeout??this.timeout,h=e.httpAgent??this.httpAgent??vl(f),_=d+1e3;typeof((C=h==null?void 0:h.options)==null?void 0:C.timeout)=="number"&&_>(h.options.timeout??0)&&(h.options.timeout=_),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const b=this.buildHeaders({options:e,headers:a,contentLength:u,retryCount:t});return{req:{method:n,...o&&{body:o},headers:b,...h&&{agent:h},signal:e.signal??null},url:f,timeout:d}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:i}){const s={};n&&(s["content-length"]=n);const a=this.defaultHeaders(e);return La(s,a),La(s,t),Ma(e.body)&&Sn!=="node"&&delete s["content-type"],ja(a,"x-stainless-retry-count")===void 0&&ja(t,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(i)),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,i){return he.generate(e,t,n,i)}request(e,t=null){return new qr(this.makeRequest(e,t))}async makeRequest(e,t){var h,_;const n=await e,i=n.maxRetries??this.maxRetries;t==null&&(t=i),await this.prepareOptions(n);const{req:s,url:a,timeout:o}=this.buildRequest(n,{retryCount:i-t});if(await this.prepareRequest(s,{url:a,options:n}),Xt("request",a,n,s.headers),(h=n.signal)!=null&&h.aborted)throw new Ie;const u=new AbortController,f=await this.fetchWithTimeout(a,s,o,u).catch(ji);if(f instanceof Error){if((_=n.signal)!=null&&_.aborted)throw new Ie;if(t)return this.retryRequest(n,t);throw f.name==="AbortError"?new us:new Wr({cause:f})}const d=wd(f.headers);if(!f.ok){if(t&&this.shouldRetry(f)){const R=`retrying, ${t} attempts remaining`;return Xt(`response (error; ${R})`,f.status,a,d),this.retryRequest(n,t,d)}const b=await f.text().catch(R=>ji(R).message),w=Cd(b),C=w?void 0:b;throw Xt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,f.status,a,d,C),this.makeStatusError(f.status,w,C,d)}return{response:f,options:n,controller:u}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new yd(this,n,e)}buildURL(e,t){const n=Rd(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return Bl(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new W(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,i){const{signal:s,...a}=t||{};s&&s.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),n),u={signal:i.signal,...a};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let i;const s=n==null?void 0:n["retry-after-ms"];if(s){const o=parseFloat(s);Number.isNaN(o)||(i=o)}const a=n==null?void 0:n["retry-after"];if(a&&!i){const o=parseFloat(a);Number.isNaN(o)?i=Date.parse(a)-Date.now():i=o*1e3}if(!(i&&0<=i&&i<60*1e3)){const o=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Kn(i),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,a=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ft}`}}class Ll{constructor(e,t,n,i){sr.set(this,void 0),_d(this,sr,e),this.options=i,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new W("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[i,s]of n)e.url.searchParams.set(i,s);t.query=void 0,t.path=e.url.toString()}return await vd(this,sr,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(sr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class yd extends qr{constructor(e,t,n){super(t,async i=>new n(e,i.response,await Nl(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const wd=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),Ad={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},me=r=>typeof r=="object"&&r!==null&&!Bl(r)&&Object.keys(r).every(e=>jl(Ad,e)),Sd=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ft,"X-Stainless-OS":Na(Deno.build.os),"X-Stainless-Arch":ka(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ft,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ft,"X-Stainless-OS":Na(process.platform),"X-Stainless-Arch":ka(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=Ed();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ft,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ft,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ed(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,s=n[2]||0,a=n[3]||0;return{browser:e,version:`${i}.${s}.${a}`}}}return null}const ka=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Na=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let Da;const xd=()=>Da??(Da=Sd()),Cd=r=>{try{return JSON.parse(r)}catch{return}},Od=/^[a-z][a-z0-9+.-]*:/i,Rd=r=>Od.test(r),Kn=r=>new Promise(e=>setTimeout(e,r)),mi=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new W(`${r} must be an integer`);if(e<0)throw new W(`${r} must be a positive integer`);return e},ji=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},ar=r=>{var e,t,n,i;if(typeof process<"u")return((e=zt==null?void 0:zt[r])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,r))==null?void 0:i.trim()};function Bl(r){if(!r)return!0;for(const e in r)return!1;return!0}function jl(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function La(r,e){for(const t in e){if(!jl(e,t))continue;const n=t.toLowerCase();if(!n)continue;const i=e[t];i===null?delete r[n]:i!==void 0&&(r[n]=i)}}const Ba=new Set(["authorization","api-key"]);function Xt(r,...e){if(typeof process<"u"&&(zt==null?void 0:zt.DEBUG)==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const s={...n,headers:{...n.headers}};for(const a in n.headers)Ba.has(a.toLowerCase())&&(s.headers[a]="REDACTED");return s}let i=null;for(const s in n)Ba.has(s.toLowerCase())&&(i??(i={...n}),i[s]="REDACTED");return i??n});console.log(`OpenAI:DEBUG:${r}`,...t)}}const Pd=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),$d=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Td=r=>typeof(r==null?void 0:r.get)=="function",ja=(r,e)=>{var n;const t=e.toLowerCase();if(Td(r)){const i=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(s,a,o)=>a+o.toUpperCase());for(const s of[e,t,e.toUpperCase(),i]){const a=r.get(s);if(a)return a}}for(const[i,s]of Object.entries(r))if(i.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};function gi(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class Id extends Ll{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ue extends Ll{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class J{constructor(e){this._client=e}}let Ul=class extends J{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},cs=class extends J{constructor(){super(...arguments),this.completions=new Ul(this._client)}};cs.Completions=Ul;class Fl extends J{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Vl extends J{create(e,t){return this._client.post("/audio/transcriptions",nn({body:e,...t}))}}class Hl extends J{create(e,t){return this._client.post("/audio/translations",nn({body:e,...t}))}}class qn extends J{constructor(){super(...arguments),this.transcriptions=new Vl(this._client),this.translations=new Hl(this._client),this.speech=new Fl(this._client)}}qn.Transcriptions=Vl;qn.Translations=Hl;qn.Speech=Fl;class fs extends J{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return me(e)?this.list({},e):this._client.getAPIList("/batches",hs,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class hs extends Ue{}fs.BatchesPage=hs;class ds extends J{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return me(e)?this.list({},e):this._client.getAPIList("/assistants",ps,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class ps extends Ue{}ds.AssistantsPage=ps;function Ua(r){return typeof r.parse=="function"}const Jt=r=>(r==null?void 0:r.role)==="assistant",Wl=r=>(r==null?void 0:r.role)==="function",Kl=r=>(r==null?void 0:r.role)==="tool";var Pe=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ee=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ui,pr,mr,dn,pn,gr,mn,Ye,gn,Pr,$r,Vt,ql;class zl{constructor(){Ui.add(this),this.controller=new AbortController,pr.set(this,void 0),mr.set(this,()=>{}),dn.set(this,()=>{}),pn.set(this,void 0),gr.set(this,()=>{}),mn.set(this,()=>{}),Ye.set(this,{}),gn.set(this,!1),Pr.set(this,!1),$r.set(this,!1),Vt.set(this,!1),Pe(this,pr,new Promise((e,t)=>{Pe(this,mr,e,"f"),Pe(this,dn,t,"f")}),"f"),Pe(this,pn,new Promise((e,t)=>{Pe(this,gr,e,"f"),Pe(this,mn,t,"f")}),"f"),ee(this,pr,"f").catch(()=>{}),ee(this,pn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ee(this,Ui,"m",ql).bind(this))},0)}_connected(){this.ended||(ee(this,mr,"f").call(this),this._emit("connect"))}get ended(){return ee(this,gn,"f")}get errored(){return ee(this,Pr,"f")}get aborted(){return ee(this,$r,"f")}abort(){this.controller.abort()}on(e,t){return(ee(this,Ye,"f")[e]||(ee(this,Ye,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=ee(this,Ye,"f")[e];if(!n)return this;const i=n.findIndex(s=>s.listener===t);return i>=0&&n.splice(i,1),this}once(e,t){return(ee(this,Ye,"f")[e]||(ee(this,Ye,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{Pe(this,Vt,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){Pe(this,Vt,!0,"f"),await ee(this,pn,"f")}_emit(e,...t){if(ee(this,gn,"f"))return;e==="end"&&(Pe(this,gn,!0,"f"),ee(this,gr,"f").call(this));const n=ee(this,Ye,"f")[e];if(n&&(ee(this,Ye,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...t))),e==="abort"){const i=t[0];!ee(this,Vt,"f")&&!(n!=null&&n.length)&&Promise.reject(i),ee(this,dn,"f").call(this,i),ee(this,mn,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=t[0];!ee(this,Vt,"f")&&!(n!=null&&n.length)&&Promise.reject(i),ee(this,dn,"f").call(this,i),ee(this,mn,"f").call(this,i),this._emit("end")}}_emitFinal(){}}pr=new WeakMap,mr=new WeakMap,dn=new WeakMap,pn=new WeakMap,gr=new WeakMap,mn=new WeakMap,Ye=new WeakMap,gn=new WeakMap,Pr=new WeakMap,$r=new WeakMap,Vt=new WeakMap,Ui=new WeakSet,ql=function(e){if(Pe(this,Pr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Ie),e instanceof Ie)return Pe(this,$r,!0,"f"),this._emit("abort",e);if(e instanceof W)return this._emit("error",e);if(e instanceof Error){const t=new W(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new W(String(e)))};function Xl(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function zn(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function Md(r,e){return!e||!Jl(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:ms(r,e)}function ms(r,e){const t=r.choices.map(n=>{var i;if(n.finish_reason==="length")throw new Pl;if(n.finish_reason==="content_filter")throw new $l;return{...n,message:{...n.message,tool_calls:((i=n.message.tool_calls)==null?void 0:i.map(s=>Nd(e,s)))??[],parsed:n.message.content&&!n.message.refusal?kd(e,n.message.content):null}}});return{...r,choices:t}}function kd(r,e){var t,n;return((t=r.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=r.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function Nd(r,e){var n;const t=(n=r.tools)==null?void 0:n.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:zn(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Dd(r,e){var n;if(!r)return!1;const t=(n=r.tools)==null?void 0:n.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return zn(t)||(t==null?void 0:t.function.strict)||!1}function Jl(r){var e;return Xl(r.response_format)?!0:((e=r.tools)==null?void 0:e.some(t=>zn(t)||t.type==="function"&&t.function.strict===!0))??!1}function Ld(r){for(const e of r??[]){if(e.type!=="function")throw new W(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new W(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var pe=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},de,Fi,Tr,Vi,Hi,Wi,Gl,Ki;const Fa=10;class Yl extends zl{constructor(){super(...arguments),de.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Wl(e)||Kl(e))&&e.content)this._emit("functionCallResult",e.content);else if(Jt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Jt(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new W("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),pe(this,de,"m",Fi).call(this)}async finalMessage(){return await this.done(),pe(this,de,"m",Tr).call(this)}async finalFunctionCall(){return await this.done(),pe(this,de,"m",Vi).call(this)}async finalFunctionCallResult(){return await this.done(),pe(this,de,"m",Hi).call(this)}async totalUsage(){return await this.done(),pe(this,de,"m",Wi).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=pe(this,de,"m",Tr).call(this);t&&this._emit("finalMessage",t);const n=pe(this,de,"m",Fi).call(this);n&&this._emit("finalContent",n);const i=pe(this,de,"m",Vi).call(this);i&&this._emit("finalFunctionCall",i);const s=pe(this,de,"m",Hi).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",pe(this,de,"m",Wi).call(this))}async _createChatCompletion(e,t,n){const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),pe(this,de,"m",Gl).call(this,t);const s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ms(s,t))}async _runChatCompletion(e,t,n){for(const i of t.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var _;const i="function",{function_call:s="auto",stream:a,...o}=t,u=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:f=Fa}=n||{},d={};for(const b of t.functions)d[b.name||b.function.name]=b;const h=t.functions.map(b=>({name:b.name||b.function.name,parameters:b.parameters,description:b.description}));for(const b of t.messages)this._addMessage(b,!1);for(let b=0;b<f;++b){const C=(_=(await this._createChatCompletion(e,{...o,function_call:s,functions:h,messages:[...this.messages]},n)).choices[0])==null?void 0:_.message;if(!C)throw new W("missing message in ChatCompletion response");if(!C.function_call)return;const{name:A,arguments:B}=C.function_call,R=d[A];if(R){if(u&&u!==A){const I=`Invalid function_call: ${JSON.stringify(A)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,name:A,content:I});continue}}else{const I=`Invalid function_call: ${JSON.stringify(A)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:A,content:I});continue}let D;try{D=Ua(R)?await R.parse(B):B}catch(I){this._addMessage({role:i,name:A,content:I instanceof Error?I.message:String(I)});continue}const M=await R.function(D,this),S=pe(this,de,"m",Ki).call(this,M);if(this._addMessage({role:i,name:A,content:S}),u)return}}async _runTools(e,t,n){var b,w,C;const i="tool",{tool_choice:s="auto",stream:a,...o}=t,u=typeof s!="string"&&((b=s==null?void 0:s.function)==null?void 0:b.name),{maxChatCompletions:f=Fa}=n||{},d=t.tools.map(A=>{if(zn(A)){if(!A.$callback)throw new W("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:A.$callback,name:A.function.name,description:A.function.description||"",parameters:A.function.parameters,parse:A.$parseRaw,strict:!0}}}return A}),h={};for(const A of d)A.type==="function"&&(h[A.function.name||A.function.function.name]=A.function);const _="tools"in t?d.map(A=>A.type==="function"?{type:"function",function:{name:A.function.name||A.function.function.name,parameters:A.function.parameters,description:A.function.description,strict:A.function.strict}}:A):void 0;for(const A of t.messages)this._addMessage(A,!1);for(let A=0;A<f;++A){const R=(w=(await this._createChatCompletion(e,{...o,tool_choice:s,tools:_,messages:[...this.messages]},n)).choices[0])==null?void 0:w.message;if(!R)throw new W("missing message in ChatCompletion response");if(!((C=R.tool_calls)!=null&&C.length))return;for(const D of R.tool_calls){if(D.type!=="function")continue;const M=D.id,{name:S,arguments:I}=D.function,E=h[S];if(E){if(u&&u!==S){const U=`Invalid tool_call: ${JSON.stringify(S)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,tool_call_id:M,content:U});continue}}else{const U=`Invalid tool_call: ${JSON.stringify(S)}. Available options are: ${Object.keys(h).map(se=>JSON.stringify(se)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:M,content:U});continue}let j;try{j=Ua(E)?await E.parse(I):I}catch(U){const se=U instanceof Error?U.message:String(U);this._addMessage({role:i,tool_call_id:M,content:se});continue}const F=await E.function(j,this),H=pe(this,de,"m",Ki).call(this,F);if(this._addMessage({role:i,tool_call_id:M,content:H}),u)return}}}}de=new WeakSet,Fi=function(){return pe(this,de,"m",Tr).call(this).content??null},Tr=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Jt(t)){const{function_call:n,...i}=t,s={...i,content:t.content??null,refusal:t.refusal??null};return n&&(s.function_call=n),s}}throw new W("stream ended without producing a ChatCompletionMessage with role=assistant")},Vi=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const i=this.messages[n];if(Jt(i)&&(i!=null&&i.function_call))return i.function_call;if(Jt(i)&&((e=i==null?void 0:i.tool_calls)!=null&&e.length))return(t=i.tool_calls.at(-1))==null?void 0:t.function}},Hi=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Wl(t)&&t.content!=null||Kl(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var i;return n.role==="assistant"&&((i=n.tool_calls)==null?void 0:i.some(s=>s.type==="function"&&s.id===t.tool_call_id))}))return t.content}},Wi=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Gl=function(e){if(e.n!=null&&e.n>1)throw new W("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ki=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class In extends Yl{static runFunctions(e,t,n){const i=new In,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,t,s)),i}static runTools(e,t,n){const i=new In,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,s)),i}_addMessage(e,t=!0){super._addMessage(e,t),Jt(e)&&e.content&&this._emit("content",e.content)}}const Ql=1,Zl=2,eu=4,tu=8,nu=16,ru=32,iu=64,su=128,au=256,Bd=su|au,jd=nu|ru|Bd|iu,Ud=Ql|Zl|jd,Fd=eu|tu,Vd=Ud|Fd,le={STR:Ql,NUM:Zl,ARR:eu,OBJ:tu,NULL:nu,BOOL:ru,NAN:iu,INFINITY:su,MINUS_INFINITY:au,ALL:Vd};class Hd extends Error{}class Wd extends Error{}function Kd(r,e=le.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return qd(r.trim(),e)}const qd=(r,e)=>{const t=r.length;let n=0;const i=_=>{throw new Hd(`${_} at position ${n}`)},s=_=>{throw new Wd(`${_} at position ${n}`)},a=()=>(h(),n>=t&&i("Unexpected end of input"),r[n]==='"'?o():r[n]==="{"?u():r[n]==="["?f():r.substring(n,n+4)==="null"||le.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||le.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||le.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||le.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||le.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||le.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):d()),o=()=>{const _=n;let b=!1;for(n++;n<t&&(r[n]!=='"'||b&&r[n-1]==="\\");)b=r[n]==="\\"?!b:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(_,++n-Number(b)))}catch(w){s(String(w))}else if(le.STR&e)try{return JSON.parse(r.substring(_,n-Number(b))+'"')}catch{return JSON.parse(r.substring(_,r.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},u=()=>{n++,h();const _={};try{for(;r[n]!=="}";){if(h(),n>=t&&le.OBJ&e)return _;const b=o();h(),n++;try{const w=a();Object.defineProperty(_,b,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(le.OBJ&e)return _;throw w}h(),r[n]===","&&n++}}catch{if(le.OBJ&e)return _;i("Expected '}' at end of object")}return n++,_},f=()=>{n++;const _=[];try{for(;r[n]!=="]";)_.push(a()),h(),r[n]===","&&n++}catch{if(le.ARR&e)return _;i("Expected ']' at end of array")}return n++,_},d=()=>{if(n===0){r==="-"&&le.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(r)}catch(b){if(le.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}s(String(b))}}const _=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(le.NUM&e)&&i("Unterminated number literal");try{return JSON.parse(r.substring(_,n))}catch{r.substring(_,n)==="-"&&le.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(r.substring(_,r.lastIndexOf("e")))}catch(w){s(String(w))}}},h=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return a()},Va=r=>Kd(r,le.ALL^le.NUM);var Dt=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Q=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ae,Ge,Lt,st,_i,or,vi,bi,yi,lr,wi,Ha;class Mn extends Yl{constructor(e){super(),ae.add(this),Ge.set(this,void 0),Lt.set(this,void 0),st.set(this,void 0),Dt(this,Ge,e,"f"),Dt(this,Lt,[],"f")}get currentChatCompletionSnapshot(){return Q(this,st,"f")}static fromReadableStream(e){const t=new Mn(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const i=new Mn(t);return i._run(()=>i._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,t,n){var a;super._createChatCompletion;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Q(this,ae,"m",_i).call(this);const s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of s)Q(this,ae,"m",vi).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new Ie;return this._addChatCompletion(Q(this,ae,"m",lr).call(this))}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Q(this,ae,"m",_i).call(this),this._connected();const i=We.fromReadableStream(e,this.controller);let s;for await(const o of i)s&&s!==o.id&&this._addChatCompletion(Q(this,ae,"m",lr).call(this)),Q(this,ae,"m",vi).call(this,o),s=o.id;if((a=i.controller.signal)!=null&&a.aborted)throw new Ie;return this._addChatCompletion(Q(this,ae,"m",lr).call(this))}[(Ge=new WeakMap,Lt=new WeakMap,st=new WeakMap,ae=new WeakSet,_i=function(){this.ended||Dt(this,st,void 0,"f")},or=function(t){let n=Q(this,Lt,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Q(this,Lt,"f")[t.index]=n,n)},vi=function(t){var i,s,a,o,u,f,d,h,_,b,w,C,A,B,R;if(this.ended)return;const n=Q(this,ae,"m",Ha).call(this,t);this._emit("chunk",t,n);for(const D of t.choices){const M=n.choices[D.index];D.delta.content!=null&&((i=M.message)==null?void 0:i.role)==="assistant"&&((s=M.message)!=null&&s.content)&&(this._emit("content",D.delta.content,M.message.content),this._emit("content.delta",{delta:D.delta.content,snapshot:M.message.content,parsed:M.message.parsed})),D.delta.refusal!=null&&((a=M.message)==null?void 0:a.role)==="assistant"&&((o=M.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:D.delta.refusal,snapshot:M.message.refusal}),((u=D.logprobs)==null?void 0:u.content)!=null&&((f=M.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=D.logprobs)==null?void 0:d.content,snapshot:((h=M.logprobs)==null?void 0:h.content)??[]}),((_=D.logprobs)==null?void 0:_.refusal)!=null&&((b=M.message)==null?void 0:b.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(w=D.logprobs)==null?void 0:w.refusal,snapshot:((C=M.logprobs)==null?void 0:C.refusal)??[]});const S=Q(this,ae,"m",or).call(this,M);M.finish_reason&&(Q(this,ae,"m",yi).call(this,M),S.current_tool_call_index!=null&&Q(this,ae,"m",bi).call(this,M,S.current_tool_call_index));for(const I of D.delta.tool_calls??[])S.current_tool_call_index!==I.index&&(Q(this,ae,"m",yi).call(this,M),S.current_tool_call_index!=null&&Q(this,ae,"m",bi).call(this,M,S.current_tool_call_index)),S.current_tool_call_index=I.index;for(const I of D.delta.tool_calls??[]){const E=(A=M.message.tool_calls)==null?void 0:A[I.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(B=E.function)==null?void 0:B.name,index:I.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((R=I.function)==null?void 0:R.arguments)??""}):(E==null||E.type,void 0))}}},bi=function(t,n){var a,o,u;if(Q(this,ae,"m",or).call(this,t).done_tool_calls.has(n))return;const s=(a=t.message.tool_calls)==null?void 0:a[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const f=(u=(o=Q(this,Ge,"f"))==null?void 0:o.tools)==null?void 0:u.find(d=>d.type==="function"&&d.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:zn(f)?f.$parseRaw(s.function.arguments):f!=null&&f.function.strict?JSON.parse(s.function.arguments):null})}else s.type},yi=function(t){var i,s;const n=Q(this,ae,"m",or).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const a=Q(this,ae,"m",wi).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(i=t.logprobs)!=null&&i.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(s=t.logprobs)!=null&&s.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},lr=function(){if(this.ended)throw new W("stream has ended, this shouldn't happen");const t=Q(this,st,"f");if(!t)throw new W("request ended without sending any chunks");return Dt(this,st,void 0,"f"),Dt(this,Lt,[],"f"),zd(t,Q(this,Ge,"f"))},wi=function(){var n;const t=(n=Q(this,Ge,"f"))==null?void 0:n.response_format;return Xl(t)?t:null},Ha=function(t){var n,i,s,a;let o=Q(this,st,"f");const{choices:u,...f}=t;o?Object.assign(o,f):o=Dt(this,st,{...f,choices:[]},"f");for(const{delta:d,finish_reason:h,index:_,logprobs:b=null,...w}of t.choices){let C=o.choices[_];if(C||(C=o.choices[_]={finish_reason:h,index:_,message:{},logprobs:b,...w}),b)if(!C.logprobs)C.logprobs=Object.assign({},b);else{const{content:I,refusal:E,...j}=b;Object.assign(C.logprobs,j),I&&((n=C.logprobs).content??(n.content=[]),C.logprobs.content.push(...I)),E&&((i=C.logprobs).refusal??(i.refusal=[]),C.logprobs.refusal.push(...E))}if(h&&(C.finish_reason=h,Q(this,Ge,"f")&&Jl(Q(this,Ge,"f")))){if(h==="length")throw new Pl;if(h==="content_filter")throw new $l}if(Object.assign(C,w),!d)continue;const{content:A,refusal:B,function_call:R,role:D,tool_calls:M,...S}=d;if(Object.assign(C.message,S),B&&(C.message.refusal=(C.message.refusal||"")+B),D&&(C.message.role=D),R&&(C.message.function_call?(R.name&&(C.message.function_call.name=R.name),R.arguments&&((s=C.message.function_call).arguments??(s.arguments=""),C.message.function_call.arguments+=R.arguments)):C.message.function_call=R),A&&(C.message.content=(C.message.content||"")+A,!C.message.refusal&&Q(this,ae,"m",wi).call(this)&&(C.message.parsed=Va(C.message.content))),M){C.message.tool_calls||(C.message.tool_calls=[]);for(const{index:I,id:E,type:j,function:F,...H}of M){const U=(a=C.message.tool_calls)[I]??(a[I]={});Object.assign(U,H),E&&(U.id=E),j&&(U.type=j),F&&(U.function??(U.function={name:F.name??"",arguments:""})),F!=null&&F.name&&(U.function.name=F.name),F!=null&&F.arguments&&(U.function.arguments+=F.arguments,Dd(Q(this,Ge,"f"),U)&&(U.function.parsed_arguments=Va(U.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new We(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function zd(r,e){const{id:t,choices:n,created:i,model:s,system_fingerprint:a,...o}=r,u={...o,id:t,choices:n.map(({message:f,finish_reason:d,index:h,logprobs:_,...b})=>{if(!d)throw new W(`missing finish_reason for choice ${h}`);const{content:w=null,function_call:C,tool_calls:A,...B}=f,R=f.role;if(!R)throw new W(`missing role for choice ${h}`);if(C){const{arguments:D,name:M}=C;if(D==null)throw new W(`missing function_call.arguments for choice ${h}`);if(!M)throw new W(`missing function_call.name for choice ${h}`);return{...b,message:{content:w,function_call:{arguments:D,name:M},role:R,refusal:f.refusal??null},finish_reason:d,index:h,logprobs:_}}return A?{...b,index:h,finish_reason:d,logprobs:_,message:{...B,role:R,content:w,refusal:f.refusal??null,tool_calls:A.map((D,M)=>{const{function:S,type:I,id:E,...j}=D,{arguments:F,name:H,...U}=S||{};if(E==null)throw new W(`missing choices[${h}].tool_calls[${M}].id
${ur(r)}`);if(I==null)throw new W(`missing choices[${h}].tool_calls[${M}].type
${ur(r)}`);if(H==null)throw new W(`missing choices[${h}].tool_calls[${M}].function.name
${ur(r)}`);if(F==null)throw new W(`missing choices[${h}].tool_calls[${M}].function.arguments
${ur(r)}`);return{...j,id:E,type:I,function:{...U,name:H,arguments:F}}})}}:{...b,message:{...B,content:w,role:R,refusal:f.refusal??null},finish_reason:d,index:h,logprobs:_}}),created:i,model:s,object:"chat.completion",...a?{system_fingerprint:a}:{}};return Md(u,e)}function ur(r){return JSON.stringify(r)}class Gt extends Mn{static fromReadableStream(e){const t=new Gt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const i=new Gt(null),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,t,s)),i}static runTools(e,t,n){const i=new Gt(t),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,s)),i}}let ou=class extends J{parse(e,t){return Ld(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>ms(n,e))}runFunctions(e,t){return e.stream?Gt.runFunctions(this._client,e,t):In.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Gt.runTools(this._client,e,t):In.runTools(this._client,e,t)}stream(e,t){return Mn.createChatCompletion(this._client,e,t)}};class qi extends J{constructor(){super(...arguments),this.completions=new ou(this._client)}}(function(r){r.Completions=ou})(qi||(qi={}));class lu extends J{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class gs extends J{constructor(){super(...arguments),this.sessions=new lu(this._client)}}gs.Sessions=lu;var N=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},_e=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ce,zi,He,_r,$e,St,qt,wt,Ir,ve,vr,br,En,_n,vn,Wa,Ka,qa,za,Xa,Ja,Ga;class Me extends zl{constructor(){super(...arguments),ce.add(this),zi.set(this,[]),He.set(this,{}),_r.set(this,{}),$e.set(this,void 0),St.set(this,void 0),qt.set(this,void 0),wt.set(this,void 0),Ir.set(this,void 0),ve.set(this,void 0),vr.set(this,void 0),br.set(this,void 0),En.set(this,void 0)}[(zi=new WeakMap,He=new WeakMap,_r=new WeakMap,$e=new WeakMap,St=new WeakMap,qt=new WeakMap,wt=new WeakMap,Ir=new WeakMap,ve=new WeakMap,vr=new WeakMap,br=new WeakMap,En=new WeakMap,ce=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",i=>{const s=t.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const s of t)s.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,a)=>t.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Me;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var s;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=We.fromReadableStream(e,this.controller);for await(const a of i)N(this,ce,"m",_n).call(this,a);if((s=i.controller.signal)!=null&&s.aborted)throw new Ie;return this._addRun(N(this,ce,"m",vn).call(this))}toReadableStream(){return new We(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,i,s){const a=new Me;return a._run(()=>a._runToolAssistantStream(e,t,n,i,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,n,i,s){var f;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...i,stream:!0},u=await e.submitToolOutputs(t,n,o,{...s,signal:this.controller.signal});this._connected();for await(const d of u)N(this,ce,"m",_n).call(this,d);if((f=u.controller.signal)!=null&&f.aborted)throw new Ie;return this._addRun(N(this,ce,"m",vn).call(this))}static createThreadAssistantStream(e,t,n){const i=new Me;return i._run(()=>i._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,t,n,i){const s=new Me;return s._run(()=>s._runAssistantStream(e,t,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return N(this,vr,"f")}currentRun(){return N(this,br,"f")}currentMessageSnapshot(){return N(this,$e,"f")}currentRunStepSnapshot(){return N(this,En,"f")}async finalRunSteps(){return await this.done(),Object.values(N(this,He,"f"))}async finalMessages(){return await this.done(),Object.values(N(this,_r,"f"))}async finalRun(){if(await this.done(),!N(this,St,"f"))throw Error("Final run was not received.");return N(this,St,"f")}async _createThreadAssistantStream(e,t,n){var o;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...t,stream:!0},a=await e.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const u of a)N(this,ce,"m",_n).call(this,u);if((o=a.controller.signal)!=null&&o.aborted)throw new Ie;return this._addRun(N(this,ce,"m",vn).call(this))}async _createAssistantStream(e,t,n,i){var u;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},o=await e.create(t,a,{...i,signal:this.controller.signal});this._connected();for await(const f of o)N(this,ce,"m",_n).call(this,f);if((u=o.controller.signal)!=null&&u.aborted)throw new Ie;return this._addRun(N(this,ce,"m",vn).call(this))}static accumulateDelta(e,t){for(const[n,i]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=i;continue}let s=e[n];if(s==null){e[n]=i;continue}if(n==="index"||n==="type"){e[n]=i;continue}if(typeof s=="string"&&typeof i=="string")s+=i;else if(typeof s=="number"&&typeof i=="number")s+=i;else if(gi(s)&&gi(i))s=this.accumulateDelta(s,i);else if(Array.isArray(s)&&Array.isArray(i)){if(s.every(a=>typeof a=="string"||typeof a=="number")){s.push(...i);continue}for(const a of i){if(!gi(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const u=s[o];u==null?s.push(a):s[o]=this.accumulateDelta(u,a)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${i}, accValue: ${s}`);e[n]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,i){return await this._createAssistantStream(t,e,n,i)}async _runToolAssistantStream(e,t,n,i,s){return await this._createToolAssistantStream(n,e,t,i,s)}}_n=function(e){if(!this.ended)switch(_e(this,vr,e,"f"),N(this,ce,"m",qa).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":N(this,ce,"m",Ga).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":N(this,ce,"m",Ka).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":N(this,ce,"m",Wa).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},vn=function(){if(this.ended)throw new W("stream has ended, this shouldn't happen");if(!N(this,St,"f"))throw Error("Final run has not been received");return N(this,St,"f")},Wa=function(e){const[t,n]=N(this,ce,"m",Xa).call(this,e,N(this,$e,"f"));_e(this,$e,t,"f"),N(this,_r,"f")[t.id]=t;for(const i of n){const s=t.content[i.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let s=i.text,a=t.content[i.index];if(a&&a.type=="text")this._emit("textDelta",s,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=N(this,qt,"f")){if(N(this,wt,"f"))switch(N(this,wt,"f").type){case"text":this._emit("textDone",N(this,wt,"f").text,N(this,$e,"f"));break;case"image_file":this._emit("imageFileDone",N(this,wt,"f").image_file,N(this,$e,"f"));break}_e(this,qt,i.index,"f")}_e(this,wt,t.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(N(this,qt,"f")!==void 0){const i=e.data.content[N(this,qt,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,N(this,$e,"f"));break;case"text":this._emit("textDone",i.text,N(this,$e,"f"));break}}N(this,$e,"f")&&this._emit("messageDone",e.data),_e(this,$e,void 0,"f")}},Ka=function(e){const t=N(this,ce,"m",za).call(this,e);switch(_e(this,En,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of n.step_details.tool_calls)s.index==N(this,Ir,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(N(this,ve,"f")&&this._emit("toolCallDone",N(this,ve,"f")),_e(this,Ir,s.index,"f"),_e(this,ve,t.step_details.tool_calls[s.index],"f"),N(this,ve,"f")&&this._emit("toolCallCreated",N(this,ve,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_e(this,En,void 0,"f"),e.data.step_details.type=="tool_calls"&&N(this,ve,"f")&&(this._emit("toolCallDone",N(this,ve,"f")),_e(this,ve,void 0,"f")),this._emit("runStepDone",e.data,t);break}},qa=function(e){N(this,zi,"f").push(e),this._emit("event",e)},za=function(e){switch(e.event){case"thread.run.step.created":return N(this,He,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=N(this,He,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const i=Me.accumulateDelta(t,n.delta);N(this,He,"f")[e.data.id]=i}return N(this,He,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":N(this,He,"f")[e.data.id]=e.data;break}if(N(this,He,"f")[e.data.id])return N(this,He,"f")[e.data.id];throw new Error("No snapshot available")},Xa=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const s of i.delta.content)if(s.index in t.content){let a=t.content[s.index];t.content[s.index]=N(this,ce,"m",Ja).call(this,s,a)}else t.content[s.index]=s,n.push(s);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ja=function(e,t){return Me.accumulateDelta(t,e)},Ga=function(e){switch(_e(this,br,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":_e(this,St,e.data,"f"),N(this,ve,"f")&&(this._emit("toolCallDone",N(this,ve,"f")),_e(this,ve,void 0,"f"));break}};class _s extends J{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,i){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t={},n){return me(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,vs,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class vs extends Ue{}_s.MessagesPage=vs;class bs extends J{retrieve(e,t,n,i={},s){return me(i)?this.retrieve(e,t,n,{},i):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:i,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t,n={},i){return me(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,ys,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class ys extends Ue{}bs.RunStepsPage=ys;class Xn extends J{constructor(){super(...arguments),this.steps=new bs(this._client)}create(e,t,n){const{include:i,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:i},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,i){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t={},n){return me(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,ws,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(e,i.id,n)}createAndStream(e,t,n){return Me.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...i}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const f=parseInt(u);isNaN(f)||(o=f)}}await Kn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return Me.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,i){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,i){const s=await this.submitToolOutputs(e,t,n,i);return await this.poll(e,s.id,i)}submitToolOutputsStream(e,t,n,i){return Me.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,i)}}class ws extends Ue{}Xn.RunsPage=ws;Xn.Steps=bs;Xn.RunStepsPage=ys;class on extends J{constructor(){super(...arguments),this.runs=new Xn(this._client),this.messages=new _s(this._client)}create(e={},t){return me(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return Me.createThreadAssistantStream(e,this._client.beta.threads,t)}}on.Runs=Xn;on.RunsPage=ws;on.Messages=_s;on.MessagesPage=vs;const Xd=async r=>{const e=await Promise.allSettled(r),t=e.filter(i=>i.status==="rejected");if(t.length){for(const i of t)console.error(i.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const i of e)i.status==="fulfilled"&&n.push(i.value);return n};let As=class extends J{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return me(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,zr,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(e,i.id,n)}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(e,t,{...n,headers:i}).withResponse(),a=s.data;switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=s.response.headers.get("openai-poll-after-ms");if(u){const f=parseInt(u);isNaN(f)||(o=f)}}await Kn(o);break;case"failed":case"completed":return a}}}async upload(e,t,n){const i=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:i.id},n)}async uploadAndPoll(e,t,n){const i=await this.upload(e,t,n);return await this.poll(e,i.id,n)}};class zr extends Ue{}As.VectorStoreFilesPage=zr;class uu extends J{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const i=await this.create(e,t);return await this.poll(e,i.id,n)}listFiles(e,t,n={},i){return me(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,zr,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async poll(e,t,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,t,{...n,headers:i}).withResponse();switch(s.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const f=parseInt(u);isNaN(f)||(o=f)}}await Kn(o);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},i){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(i==null?void 0:i.maxConcurrency)??5,a=Math.min(s,t.length),o=this._client,u=t.values(),f=[...n];async function d(_){for(let b of _){const w=await o.files.create({file:b,purpose:"assistants"},i);f.push(w.id)}}const h=Array(a).fill(u).map(d);return await Xd(h),await this.createAndPoll(e,{file_ids:f})}}class ln extends J{constructor(){super(...arguments),this.files=new As(this._client),this.fileBatches=new uu(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return me(e)?this.list({},e):this._client.getAPIList("/vector_stores",Ss,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ss extends Ue{}ln.VectorStoresPage=Ss;ln.Files=As;ln.VectorStoreFilesPage=zr;ln.FileBatches=uu;class _t extends J{constructor(){super(...arguments),this.realtime=new gs(this._client),this.vectorStores=new ln(this._client),this.chat=new qi(this._client),this.assistants=new ds(this._client),this.threads=new on(this._client)}}_t.Realtime=gs;_t.VectorStores=ln;_t.VectorStoresPage=Ss;_t.Assistants=ds;_t.AssistantsPage=ps;_t.Threads=on;class cu extends J{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class fu extends J{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Es extends J{create(e,t){return this._client.post("/files",nn({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return me(e)?this.list({},e):this._client.getAPIList("/files",xs,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),s=Date.now();let a=await this.retrieve(e);for(;!a.status||!i.has(a.status);)if(await Kn(t),a=await this.retrieve(e),Date.now()-s>n)throw new us({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class xs extends Ue{}Es.FileObjectsPage=xs;class Cs extends J{list(e,t={},n){return me(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Os,{query:t,...n})}}class Os extends Ue{}Cs.FineTuningJobCheckpointsPage=Os;class un extends J{constructor(){super(...arguments),this.checkpoints=new Cs(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return me(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Rs,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return me(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Ps,{query:t,...n})}}class Rs extends Ue{}class Ps extends Ue{}un.FineTuningJobsPage=Rs;un.FineTuningJobEventsPage=Ps;un.Checkpoints=Cs;un.FineTuningJobCheckpointsPage=Os;class Jn extends J{constructor(){super(...arguments),this.jobs=new un(this._client)}}Jn.Jobs=un;Jn.FineTuningJobsPage=Rs;Jn.FineTuningJobEventsPage=Ps;class hu extends J{createVariation(e,t){return this._client.post("/images/variations",nn({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",nn({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class $s extends J{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Ts,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Ts extends Id{}$s.ModelsPage=Ts;class du extends J{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class pu extends J{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,nn({body:t,...n}))}}class Is extends J{constructor(){super(...arguments),this.parts=new pu(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}Is.Parts=pu;var mu;class q extends bd{constructor({baseURL:e=ar("OPENAI_BASE_URL"),apiKey:t=ar("OPENAI_API_KEY"),organization:n=ar("OPENAI_ORG_ID")??null,project:i=ar("OPENAI_PROJECT_ID")??null,...s}={}){if(t===void 0)throw new W("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:n,project:i,...s,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&$d())throw new W(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new cu(this),this.chat=new cs(this),this.embeddings=new fu(this),this.files=new Es(this),this.images=new hu(this),this.audio=new qn(this),this.moderations=new du(this),this.models=new $s(this),this.fineTuning=new Jn(this),this.beta=new _t(this),this.batches=new fs(this),this.uploads=new Is(this),this._options=a,this.apiKey=t,this.organization=n,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return nd(e,{arrayFormat:"brackets"})}}mu=q;q.OpenAI=mu;q.DEFAULT_TIMEOUT=6e5;q.OpenAIError=W;q.APIError=he;q.APIConnectionError=Wr;q.APIConnectionTimeoutError=us;q.APIUserAbortError=Ie;q.NotFoundError=El;q.ConflictError=xl;q.RateLimitError=Ol;q.BadRequestError=wl;q.AuthenticationError=Al;q.InternalServerError=Rl;q.PermissionDeniedError=Sl;q.UnprocessableEntityError=Cl;q.toFile=kl;q.fileFromPath=bl;q.Completions=cu;q.Chat=cs;q.Embeddings=fu;q.Files=Es;q.FileObjectsPage=xs;q.Images=hu;q.Audio=qn;q.Moderations=du;q.Models=$s;q.ModelsPage=Ts;q.FineTuning=Jn;q.Beta=_t;q.Batches=fs;q.BatchesPage=hs;q.Uploads=Is;function Jd(r,e){return new q({apiKey:r,baseURL:e,dangerouslyAllowBrowser:!0})}const gu="integrations";Ko({useProxies:"never"});const Re=Vr({integrations:[{name:"OpenAI",baseURL:"https://api.openai.com/v1",model:"gpt-4o",apiKey:"",embeddingModel:"text-embedding-3-small"},{name:"Hugging Face",baseURL:"https://api-inference.huggingface.co/models",apiKey:"",model:"gpt2",embeddingModel:"sentence-transformers/paraphrase-MiniLM-L6-v2"},{name:"Ollama",baseURL:"http://localhost:11434/v1",model:"llama3.2",embeddingModel:"nomic-embed-text"},{name:"Deepseek",baseURL:"http://api.deepseek.com/v1",apiKey:"",model:"deepseek",embeddingModel:"deepseek"}]});gt.getItem(gu).then(r=>{r&&Tt(()=>{Re.integrations=r.integrations})});es(()=>Re.integrations,()=>{gt.setItem(gu,Xo(Re))});const Bt=Symbol("LitMobxRenderReaction"),Ya=Symbol("LitMobxRequestUpdate");function Gd(r,e){var t,n;return n=class extends r{constructor(){super(...arguments),this[t]=()=>{this.requestUpdate()}}connectedCallback(){super.connectedCallback();const s=this.constructor.name||this.nodeName;this[Bt]=new e(`${s}.update()`,this[Ya]),this.hasUpdated&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),this[Bt]&&(this[Bt].dispose(),this[Bt]=void 0)}update(s){this[Bt]?this[Bt].track(super.update.bind(this,s)):super.update(s)}},t=Ya,n}function Yd(r){return Gd(r,Xe)}class Gn extends Yd(ie){}var Qd=Object.defineProperty,Zd=Object.getOwnPropertyDescriptor,_u=(r,e,t,n)=>{for(var i=n>1?void 0:n?Zd(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Qd(e,t,i),i};let Xi=class extends Gn{constructor(){super(...arguments),this.id=""}createRenderRoot(){return this}firstUpdated(e){}async prompt(e){var o,u,f;console.log(e.detail),rl(e.detail);const t=((o=Re.integrations.find(d=>d.selected))==null?void 0:o.apiKey)??"ollama",n=((u=Re.integrations.find(d=>d.selected))==null?void 0:u.baseURL)??"http://127.0.0.1:11434/v1",i=((f=Re.integrations.find(d=>d.selected))==null?void 0:f.model)??"llama3.2",a=await Jd(t,n).chat.completions.create({messages:ne.messages,model:i,stream:!0});for await(const d of a)bh(d.choices[0].delta.content);Tt(()=>{let d=!1;ut.chats=ut.chats.map(h=>(h.id===ne.id&&(h.messages=ne.messages,d=!0),h)),d||(ut.chats=[...ut.chats,{id:ne.id,title:"Untitled Conversation",messages:ne.messages}])})}render(){return X` <div class="flex-1 flex flex-col h-full overflow-hidden">
      <!-- Chat Messages -->
      <div class="flex-1 overflow-y-auto p-4 text-xs">
        ${ne.messages.map(e=>X` <div
            class="chat ${e.role==="assistant"?"chat-start":"chat-end"}"
          >
            <div class="chat-bubble bg-gray-700 text-gray-100">
              ${e.content}
            </div>
          </div>`)}
      </div>

      <!-- Message Input Area -->
      <x-prompt @submit="${this.prompt}"></x-prompt>
    </div>`}};_u([Wn({type:String})],Xi.prototype,"id",2);Xi=_u([je("x-chat")],Xi);let ep=class extends ie{createRenderRoot(){return this}startNewChat(e){const t=il();rl(e.detail),window.location.href=`/chat/${t}`}firstUpdated(e){}render(){return X`<div class="flex flex-col w-full items-center justify-center">
      <dotlottie-player
        src="https://lottie.host/abb6b1b2-0821-439d-a438-0684acbfb013/qTEczEobzl.lottie"
        background="transparent"
        speed="1"
        style="width: 300px; height: 300px"
        loop
        autoplay
      ></dotlottie-player>
      <x-prompt @submit="${this.startNewChat}"></x-prompt>
    </div>`}};customElements.define("x-homepage",ep);const vu="general-settings";function bu(r){document.documentElement.dataset.theme=`remembrain-${r}`}const Et=Vr({theme:"dark"});gt.getItem(vu).then(r=>{r&&Tt(()=>{Et.theme=r.theme,bu(r.theme)})});es(()=>[Et.theme],()=>{gt.setItem(vu,Et),bu(Et.theme)});let tp=class extends Gn{createRenderRoot(){return this}changeTheme(e){Tt(()=>{Et.theme=e})}purgeDB(){confirm("Are you sure you want to delete all data?")&&gt.dropInstance()}render(){return X`<div class="">
      <h1 class="text-xl">General Settings</h1>
      <div class="border-1 border-primary p-2 mb-3">
        <h2 class="text-lg">Theme</h2>
        <div class="join">
          <label
            @click="${()=>this.changeTheme("light")}"
            for="lighttheme-checkbox"
            class="btn join-item ${Et.theme==="light"?"btn-primary":""}"
            >Light</label
          >
          <label
            @click="${()=>this.changeTheme("dark")}"
            for="darktheme-checkbox"
            class="btn join-item ${Et.theme==="dark"?"btn-primary":""}"
            >Dark</label
          >
        </div>
      </div>
      <div class="border-1 border-primary p-2 mb-3">
        <h2 class="text-lg">Delete all data</h2>
        <button class="btn btn-error" @click="${this.purgeDB}">Delete</button>
      </div>
    </div>`}};customElements.define("x-settings-general",tp);var np=Object.defineProperty,rp=Object.getOwnPropertyDescriptor,yu=(r,e,t,n)=>{for(var i=n>1?void 0:n?rp(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&np(e,t,i),i};let Ji=class extends Gn{constructor(){super(...arguments),this.integrations=[]}createRenderRoot(){return this}addIntegration(){const e=this.querySelector("select").value;this.integrations=[...this.integrations,e],console.log("Adding integration",e)}updateIntegration(e,t,n){console.log("Updating integration",e,t,n),Tt(()=>{Re.integrations=Re.integrations.map((i,s)=>s===e?{...i,[t]:n}:i)})}render(){return X`<div
      class="[&_h1]:text-xl [&_h1]:mt-2 [&_h1]:mb-2 p-3 [&_.form-control]:flex [&_.form-control_label]:flex-1 [&_.form-control_label]:border-b-1 [&_.form-control_label]:border-dashed [&_.form-control_label]:border-b-neutral"
    >
      <h1>AI Settings</h1>
      ${Re.integrations.map((e,t)=>X`<div
          class="[&_h2]:text-lg [&_h2]:border-b-1 [&_h2]:border-b-primary *:mt-2 *:mb-3 pb-10"
        >
          <h2>${e.name}</h2>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Base URL</span>
            </label>
            <input
              type="text"
              class="input input-bordered "
              .value=${e.baseURL}
              @input=${n=>this.updateIntegration(t,"baseURL",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">API Key</span>
            </label>
            <input
              type="password"
              class="input input-bordered "
              .value=${e.apiKey}
              placeholder="sk-***"
              @input=${n=>this.updateIntegration(t,"apiKey",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Model</span>
            </label>
            <input
              type="text"
              class="input input-bordered settingfield"
              .value=${e.model}
              @input=${n=>this.updateIntegration(t,"model",n.target.value)}
            />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">Embedding Model</span>
            </label>
            <input
              type="text"
              class="input input-bordered "
              .value=${e.embeddingModel}
              @input=${n=>this.updateIntegration(t,"embeddingModel",n.target.value)}
            />
          </div>
        </div> `)}
    </div>`}};yu([cl()],Ji.prototype,"integrations",2);Ji=yu([je("x-settings-integrations")],Ji);var ip=Object.getOwnPropertyDescriptor,nt=(r,e,t,n)=>{for(var i=n>1?void 0:n?ip(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(i)||i);return i};let Qa=class extends ie{createRenderRoot(){return this}render(){return X`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        fill-rule="evenodd"
        d="M9 2.221V7H4.221a2 2 0 0 1 .365-.5L8.5 2.586A2 2 0 0 1 9 2.22ZM11 2v5a2 2 0 0 1-2 2H4v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-7Z"
        clip-rule="evenodd"
      />
    </svg>`}};Qa=nt([je("icon-file")],Qa);let Za=class extends ie{createRenderRoot(){return this}render(){return X`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m4.988 19.012 5.41-5.41m2.366-6.424 4.058 4.058-2.03 5.41L5.3 20 4 18.701l3.355-9.494 5.41-2.029Zm4.626 4.625L12.197 6.61 14.807 4 20 9.194l-2.61 2.61Z"
      />
    </svg> `}};Za=nt([je("icon-pen")],Za);let eo=class extends ie{createRenderRoot(){return this}render(){return X`<svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="size-6 inline-block"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"
      />
    </svg>`}};eo=nt([je("icon-stack")],eo);let to=class extends ie{createRenderRoot(){return this}render(){return X`
      <svg
        class="w-6 h-6  dark:text-white inline-block"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 7.757v8.486M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
        />
      </svg>
    `}};to=nt([je("icon-plus")],to);let no=class extends ie{createRenderRoot(){return this}render(){return X` <svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        fill-rule="evenodd"
        d="M9 7V2.221a2 2 0 0 0-.5.365L4.586 6.5a2 2 0 0 0-.365.5H9Zm2 0V2h7a2 2 0 0 1 2 2v6.41A7.5 7.5 0 1 0 10.5 22H6a2 2 0 0 1-2-2V9h5a2 2 0 0 0 2-2Z"
        clip-rule="evenodd"
      />
      <path
        fill-rule="evenodd"
        d="M9 16a6 6 0 1 1 12 0 6 6 0 0 1-12 0Zm6-3a1 1 0 0 1 1 1v1h1a1 1 0 1 1 0 2h-1v1a1 1 0 1 1-2 0v-1h-1a1 1 0 1 1 0-2h1v-1a1 1 0 0 1 1-1Z"
        clip-rule="evenodd"
      />
    </svg>`}};no=nt([je("icon-plus-file")],no);let ro=class extends ie{createRenderRoot(){return this}render(){return X` <svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M14 8H4m8 3.5v5M9.5 14h5M4 6v13a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1h-5.032a1 1 0 0 1-.768-.36l-1.9-2.28a1 1 0 0 0-.768-.36H5a1 1 0 0 0-1 1Z"
      />
    </svg>`}};ro=nt([je("icon-plus-folder")],ro);let io=class extends ie{createRenderRoot(){return this}render(){return X`<svg
      class="w-6 h-6  dark:text-white inline-block"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
      />
    </svg> `}};io=nt([je("icon-edit")],io);let so=class extends ie{createRenderRoot(){return this}render(){return X`
      <svg
        class="w-6 h-6  dark:text-white inline-block"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
        />
      </svg>
    `}};so=nt([je("icon-trash")],so);let ao=class extends ie{createRenderRoot(){return this}render(){return X`<svg
      xmlns="http://www.w3.org/2000/svg"
      width="1280"
      height="314.982"
      fill="#0f0f0f"
      viewBox="0 0 338.667 83.339"
      id="openai"
      class="dark:text-white"
    >
      <path
        stroke="currentColor"
        d="M200.154 32.427v.028c-.169 0-.339.028-.508.028s-.339-.028-.508-.028c-10.075 0-16.312 6.294-16.312 16.397v4.967c0 9.736 6.322 15.776 16.453 15.776a4.38 4.38 0 0 0 .621-.028c.141 0 .254.028.395.028 6.801 0 11.543-2.483 14.562-7.62l-6.011-3.472c-2.004 2.963-4.685 5.193-8.523 5.193-5.136 0-8.212-3.161-8.212-8.495V53.79h23.819v-5.87c0-9.426-6.18-15.494-15.776-15.494zm-.508 5.786c4.685.226 7.507 3.33 7.507 8.438v1.411h-15.07v-.819c0-5.644 2.681-8.805 7.563-9.031zm-36.998-5.758c-4.487 0-8.353 1.863-10.385 4.967l-.508.79v-4.911h-8.523v47.667h8.946v-16.65l.508.762c1.919 2.85 5.673 4.543 10.047 4.543h.226.197c7.366 0 14.788-4.798 14.788-15.55v-6.039c0-7.733-4.572-15.55-14.845-15.55l-.056-.028h-.197zm-2.088 6.717c5.193.085 8.41 3.612 8.41 9.257v5.192c0 5.644-3.246 9.144-8.495 9.257-4.882-.085-8.297-3.81-8.297-9.116v-5.334c0-5.362 3.443-9.144 8.382-9.257zm115.934-18.485l-17.215 48.09h9.68l3.302-10.301h18.795v.113l3.302 10.216h9.68l-17.243-48.09h-1.016l-.028-.028zm5.137 8.269l7.196 22.719h-14.45zm57.035-1.496v-6.773h-29.52v6.773h10.357v34.487h-10.357v6.773h29.52v-6.773h-10.357V27.46zm-97.139 4.996h-.254-.141c-4.995 0-8.551 1.693-10.301 4.939l-.536.988v-5.08h-8.523v35.446h8.946v-21.11c0-4.967 2.681-7.817 7.309-7.902 4.431.085 6.971 2.879 6.971 7.705v21.307h8.946V45.917c0-8.438-4.628-13.462-12.389-13.462zM114.473 19.699c-13.18 0-21.392 8.213-21.392 21.449v7.14c0 13.236 8.184 21.448 21.392 21.448h.198.197c13.18 0 21.392-8.212 21.392-21.448v-7.14c0-13.236-8.212-21.449-21.392-21.449h-.197zm.198 7.169c7.846.085 12.361 5.108 12.361 13.8v8.128c0 8.692-4.515 13.716-12.361 13.8-7.846-.085-12.362-5.108-12.362-13.8v-8.128c0-8.692 4.516-13.716 12.362-13.8zM36.751.001c-9.116 0-17.215 5.87-20.038 14.534A20.83 20.83 0 0 0 2.828 24.61C-1.744 32.512-.7 42.446 5.425 49.219 3.534 54.892 4.183 61.1 7.203 66.237c4.544 7.93 13.687 11.994 22.634 10.103a20.78 20.78 0 0 0 15.635 6.999c9.116 0 17.215-5.87 20.038-14.534 5.87-1.214 10.922-4.883 13.857-10.075 4.6-7.902 3.556-17.836-2.568-24.609v-.028a20.76 20.76 0 0 0-1.778-17.046C70.476 9.145 61.332 5.08 52.414 6.971A20.86 20.86 0 0 0 36.751.001zm0 5.419l-.028.028c3.669 0 7.197 1.27 10.019 3.613-.113.056-.339.197-.508.282L29.64 18.91c-.847.48-1.355 1.383-1.355 2.371v22.464l-7.14-4.12v-18.57A15.63 15.63 0 0 1 36.751 5.419zm19.99 6.54a15.62 15.62 0 0 1 13.566 7.825c1.806 3.161 2.483 6.858 1.862 10.442-.113-.085-.338-.197-.48-.282l-16.594-9.596a2.78 2.78 0 0 0-2.737 0L32.913 31.581V23.34l16.058-9.285a15.54 15.54 0 0 1 7.77-2.096zm-41.043 8.53v19.727c0 .988.508 1.863 1.355 2.371l19.416 11.204L29.3 57.94l-16.03-9.257a15.63 15.63 0 0 1-5.7-21.336 15.65 15.65 0 0 1 8.128-6.858zm37.196 4.882l16.058 9.257c7.479 4.318 10.018 13.857 5.7 21.336l.028.028c-1.834 3.161-4.713 5.588-8.128 6.83V43.095c0-.988-.508-1.891-1.355-2.37L45.753 29.492zm-11.797 6.802l8.185 4.741v9.454l-8.185 4.741-8.184-4.741v-9.454zm12.869 7.451l7.14 4.12v18.542c0 8.636-6.999 15.635-15.606 15.635v-.028c-3.641 0-7.197-1.27-9.991-3.612.113-.056.367-.198.508-.283l16.594-9.567c.847-.48 1.383-1.383 1.354-2.371zM49.309 51.76V60l-16.058 9.257c-7.479 4.29-17.018 1.75-21.336-5.701h.028c-1.834-3.133-2.484-6.858-1.863-10.442.113.085.339.197.48.282l16.594 9.596a2.78 2.78 0 0 0 2.737 0z"
      ></path>
    </svg>`}};ao=nt([je("icon-openai")],ao);var sp=Object.defineProperty,ap=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&sp(e,t,i),i};let wu=class extends ie{constructor(){super(...arguments),this.type="openai"}createRenderRoot(){return this}render(){return X`<div class="p-4 border">
      <h1>Integration setting</h1>
      ${this.type==="openai"?X`<icon-openai></icon-openai>`:""}
    </div>`}};ap([Wn({type:String})],wu.prototype,"type");customElements.define("x-integration-setting",wu);let op=class extends ie{createRenderRoot(){return this}render(){return X`<h1 class="font-bold text-2xl inline-block">
      Remembr<span
        class="bg-linear-to-r from-cyan-500 to-blue-400 bg-clip-text text-transparent"
        >AI</span
      >n
    </h1>`}};customElements.define("x-logo",op);let lp=class extends ie{createRenderRoot(){return this}newChat(){const e=Math.random().toString(36).substring(7);window.location.href=`/chat/${e}`}render(){return X`<nav class="border-b border-gray-700">
      <div class="flex items-center justify-between h-16 px-4">
        <label
          for="drawer-toggle"
          class="p-2 rounded-md text-gray-400 hover:text-gray-200 hover:bg-gray-700 cursor-pointer"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            ></path>
          </svg>
        </label>
        <a href="/">
          <h1 class="text-2xl font-bold font-[Permanent_Marker]">
            Remembr<span
              class="bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-secondary)] bg-clip-text text-transparent"
              >AI</span
            >n
          </h1></a
        >

        <div class="">
          <a href="/chat" class="btn btn-primary btn-sm">
            <svg
              class="w-6 h-6 text-gray-800 dark:text-white"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
              />
            </svg>
            <span class="dark:text-white">New Chat</span>
          </a>
        </div>
      </div>
    </nav>`}};customElements.define("x-navbar",lp);async function up({allowedExtensions:r=["pdf","txt","md"]}){const e=document.createElement("input");return e.type="file",e.multiple=!0,e.accept=r.map(t=>`.${t}`).join(","),e.click(),new Promise(t=>{e.onchange=n=>{const s=n.target.files;if(!s)return t([]);t(Array.from(s))}})}Array.prototype.find||(Array.prototype.find=function(r){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof r!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),t=e.length>>>0,n=arguments[1],i,s=0;s<t;s++)if(i=e[s],r.call(n,i,s,e))return i});if(window&&typeof window.CustomEvent!="function"){let r=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};typeof window.Event<"u"&&(r.prototype=window.Event.prototype),window.CustomEvent=r}class Mr{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,t){e.shouldDeactivate(t)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let n=this;e.commandEvent=!1,Mr.keys().forEach(i=>{i.key===t.keyCode&&(e.commandEvent=!0,e.callbacks()[i.value.toLowerCase()](t,n))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let n=e.tribute;if(n.menu&&n.menu.contains(t.target)){let i=t.target;for(t.preventDefault(),t.stopPropagation();i.nodeName.toLowerCase()!=="li";)if(i=i.parentNode,!i||i===n.menu)throw new Error("cannot find the <li> container for the click");n.selectItemAtIndex(i.getAttribute("data-index"),t),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout(()=>n.hideMenu()))}keyup(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{let n=e.getKeyCode(e,this,t);if(isNaN(n)||!n)return;let i=e.tribute.triggers().find(s=>s.charCodeAt(0)===n);typeof i<"u"&&e.callbacks().triggerChar(t,this,i)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let t=!1;return Mr.keys().forEach(n=>{e.keyCode===n.key&&(t=!0)}),!t}return!1}getKeyCode(e,t,n){let i=e.tribute,s=i.range.getTriggerInfo(!1,i.hasTrailingSpace,!0,i.allowSpaces,i.autocompleteMode);return s?s.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,n)=>{let i=this.tribute;i.current.trigger=n;let s=i.collection.find(a=>a.trigger===n);i.current.collection=s,i.current.mentionText.length>=i.current.collection.menuShowMinLength&&i.inputEvent&&i.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,i=this.tribute.menuSelected;n>i&&i>0?(this.tribute.menuSelected--,this.setActiveLi()):i===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,i=this.tribute.menuSelected;n>i?(this.tribute.menuSelected++,this.setActiveLi()):n===i&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll("li"),n=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let i=0;i<n;i++){let s=t[i];if(i===this.tribute.menuSelected){s.classList.add(this.tribute.current.collection.selectClass);let a=s.getBoundingClientRect(),o=this.tribute.menu.getBoundingClientRect();if(a.bottom>o.bottom){let u=a.bottom-o.bottom;this.tribute.menu.scrollTop+=u}else if(a.top<o.top){let u=o.top-a.top;this.tribute.menu.scrollTop-=u}}else s.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let n=e.getBoundingClientRect().height;if(t){let i=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(i.marginTop)+parseFloat(i.marginBottom)}return n}}class cp{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.showMenuFor(this.tribute.current.element,!1)},300,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.range.positionMenuAtCaret(!0)},300,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,t,n){var i;return()=>{var s=this,a=arguments,o=()=>{i=null,n||e.apply(s,a)},u=n&&!i;clearTimeout(i),i=setTimeout(o,t),u&&e.apply(s,a)}}}class fp{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,n,i=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof i<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(t.element)?n=this.getContentEditableCaretPosition(i.mentionPosition):n=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,i.mentionPosition),this.tribute.menu.style.cssText=`top: ${n.top}px;
                                     left: ${n.left}px;
                                     right: ${n.right}px;
                                     bottom: ${n.bottom}px;
                                     position: absolute;
                                     display: block;`,n.left==="auto"&&(this.tribute.menu.style.left="auto"),n.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView(),window.setTimeout(()=>{let s={width:this.tribute.menu.offsetWidth,height:this.tribute.menu.offsetHeight},a=this.isMenuOffScreen(n,s),o=window.innerWidth>s.width&&(a.left||a.right),u=window.innerHeight>s.height&&(a.top||a.bottom);(o||u)&&(this.tribute.menu.style.cssText="display: none",this.positionMenuAtCaret(e))},0)}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,n){let i,s=e;if(t)for(var a=0;a<t.length;a++){if(s=s.childNodes[t[a]],s===void 0)return;for(;s.length<n;)n-=s.length,s=s.nextSibling;s.childNodes.length===0&&!s.length&&(s=s.previousSibling)}let o=this.getWindowSelection();i=this.getDocument().createRange(),i.setStart(s,n),i.setEnd(s,n),i.collapse(!0);try{o.removeAllRanges()}catch{}o.addRange(i),e.focus()}replaceTriggerText(e,t,n,i,s){let a=this.getTriggerInfo(!0,n,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(a!==void 0){let o=this.tribute.current,u=new CustomEvent("tribute-replaced",{detail:{item:s,instance:o,context:a,event:i}});if(this.isContentEditable(o.element)){let f=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=f;let d=a.mentionPosition+a.mentionText.length;this.tribute.autocompleteMode||(d+=a.mentionTriggerChar.length),this.pasteHtml(e,a.mentionPosition,d)}else{let f=this.tribute.current.element,d=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=d;let h=a.mentionPosition,_=a.mentionPosition+a.mentionText.length+d.length;this.tribute.autocompleteMode||(_+=a.mentionTriggerChar.length-1),f.value=f.value.substring(0,h)+e+f.value.substring(_,f.value.length),f.selectionStart=h+e.length,f.selectionEnd=h+e.length}o.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),o.element.dispatchEvent(u)}}pasteHtml(e,t,n){let i,s;s=this.getWindowSelection(),i=this.getDocument().createRange(),i.setStart(s.anchorNode,t),i.setEnd(s.anchorNode,n),i.deleteContents();let a=this.getDocument().createElement("div");a.innerHTML=e;let o=this.getDocument().createDocumentFragment(),u,f;for(;u=a.firstChild;)f=o.appendChild(u);i.insertNode(o),f&&(i=i.cloneRange(),i.setStartAfter(f),i.collapse(!0),s.removeAllRanges(),s.addRange(i))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),n=t.anchorNode,i=[],s;if(n!=null){let a,o=n.contentEditable;for(;n!==null&&o!=="true";)a=this.getNodePositionInParent(n),i.push(a),n=n.parentNode,n!==null&&(o=n.contentEditable);return i.reverse(),s=t.getRangeAt(0).startOffset,{selected:n,path:i,offset:s}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t="";if(this.isContentEditable(e.element)){let n=this.getWindowSelection().anchorNode;if(n!=null){let i=n.textContent,s=this.getWindowSelection().getRangeAt(0).startOffset;i&&s>=0&&(t=i.substring(0,s))}}else{let n=this.tribute.current.element;if(n){let i=n.selectionStart;n.value&&i>=0&&(t=n.value.substring(0,i))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g," ");let t=e.split(/\s+/),n=t.length-1;return t[n].trim()}getTriggerInfo(e,t,n,i,s){let a=this.tribute.current,o,u,f;if(!this.isContentEditable(a.element))o=this.tribute.current.element;else{let _=this.getContentEditableSelectedPath(a);_&&(o=_.selected,u=_.path,f=_.offset)}let d=this.getTextPrecedingCurrentSelection(),h=this.getLastWordInText(d);if(s)return{mentionPosition:d.length-h.length,mentionText:h,mentionSelectedElement:o,mentionSelectedPath:u,mentionSelectedOffset:f};if(d!=null){let _=-1,b;if(this.tribute.collection.forEach(w=>{let C=w.trigger,A=w.requireLeadingSpace?this.lastIndexWithLeadingSpace(d,C):d.lastIndexOf(C);A>_&&(_=A,b=C,n=w.requireLeadingSpace)}),_>=0&&(_===0||!n||/[\xA0\s]/g.test(d.substring(_-1,_)))){let w=d.substring(_+b.length,d.length);b=d.substring(_,_+b.length);let C=w.substring(0,1),A=w.length>0&&(C===" "||C===" ");t&&(w=w.trim());let B=i?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=B.test(w),!A&&(e||!B.test(w)))return{mentionPosition:_,mentionText:w,mentionSelectedElement:o,mentionSelectedPath:u,mentionSelectedOffset:f,mentionTriggerChar:b}}}}lastIndexWithLeadingSpace(e,t){let n=e.split("").reverse().join(""),i=-1;for(let s=0,a=e.length;s<a;s++){let o=s===e.length-1,u=/\s/.test(n[s+1]),f=!0;for(let d=t.length-1;d>=0;d--)if(t[d]!==n[s-d]){f=!1;break}if(f&&(o||u)){i=e.length-1-s;break}}return i}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,t){let n=window.innerWidth,i=window.innerHeight,s=document.documentElement,a=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),o=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),u=typeof e.top=="number"?e.top:o+i-e.bottom-t.height,f=typeof e.right=="number"?e.right:e.left+t.width,d=typeof e.bottom=="number"?e.bottom:e.top+t.height,h=typeof e.left=="number"?e.left:a+n-e.right-t.width;return{top:u<Math.floor(o),right:f>Math.ceil(a+n),bottom:d>Math.ceil(o+i),left:h<Math.floor(a)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,t,n){let i=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],s=window.mozInnerScreenX!==null,a=this.getDocument().createElement("div");a.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(a);let o=a.style,u=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",i.forEach(I=>{o[I]=u[I]}),s?(o.width=`${parseInt(u.width)-2}px`,e.scrollHeight>parseInt(u.height)&&(o.overflowY="scroll")):o.overflow="hidden",a.textContent=e.value.substring(0,t),e.nodeName==="INPUT"&&(a.textContent=a.textContent.replace(/\s/g," "));let f=this.getDocument().createElement("span");f.textContent=e.value.substring(t)||".",a.appendChild(f);let d=e.getBoundingClientRect(),h=document.documentElement,_=(window.pageXOffset||h.scrollLeft)-(h.clientLeft||0),b=(window.pageYOffset||h.scrollTop)-(h.clientTop||0),w=0,C=0;this.menuContainerIsBody&&(w=d.top,C=d.left);let A={top:w+b+f.offsetTop+parseInt(u.borderTopWidth)+parseInt(u.fontSize)-e.scrollTop,left:C+_+f.offsetLeft+parseInt(u.borderLeftWidth)},B=window.innerWidth,R=window.innerHeight,D=this.getMenuDimensions(),M=this.isMenuOffScreen(A,D);M.right&&(A.right=B-A.left,A.left="auto");let S=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(M.bottom){let I=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),E=S-(R-I.top);A.bottom=E+(R-d.top-f.offsetTop),A.top="auto"}return M=this.isMenuOffScreen(A,D),M.left&&(A.left=B>D.width?_+B-D.width:_,delete A.right),M.top&&(A.top=R>D.height?b+R-D.height:b,delete A.bottom),this.getDocument().body.removeChild(a),A}getContentEditableCaretPosition(e){let t,n=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(n.anchorNode,e),t.setEnd(n.anchorNode,e),t.collapse(!1);let i=t.getBoundingClientRect(),s=document.documentElement,a=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),o=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),u=i.left,f=i.top,d={left:u+a,top:f+i.height+o},h=window.innerWidth,_=window.innerHeight,b=this.getMenuDimensions(),w=this.isMenuOffScreen(d,b);w.right&&(d.left="auto",d.right=h-i.left-a);let C=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(w.bottom){let A=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),B=C-(_-A.top);d.top="auto",d.bottom=B+(_-i.top)}return w=this.isMenuOffScreen(d,b),w.left&&(d.left=h>b.width?a+h-b.width:a,delete d.right),w.top&&(d.top=_>b.height?o+_-b.height:o,delete d.bottom),this.menuContainerIsBody||(d.left=d.left?d.left-this.tribute.menuContainer.offsetLeft:d.left,d.top=d.top?d.top-this.tribute.menuContainer.offsetTop:d.top),d}scrollIntoView(e){let t=20,n,i=100,s=this.menu;if(typeof s>"u")return;for(;n===void 0||n.height===0;)if(n=s.getBoundingClientRect(),n.height===0&&(s=s.childNodes[0],s===void 0||!s.getBoundingClientRect))return;let a=n.top,o=a+n.height;if(a<0)window.scrollTo(0,window.pageYOffset+n.top-t);else if(o>window.innerHeight){let u=window.pageYOffset+n.top-t;u-window.pageYOffset>i&&(u=window.pageYOffset+i);let f=window.pageYOffset-(window.innerHeight-o);f>u&&(f=u),window.scrollTo(0,f)}}}class hp{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(n=>this.test(e,n))}test(e,t){return this.match(e,t)!==null}match(e,t,n){n=n||{},t.length;let i=n.pre||"",s=n.post||"",a=n.caseSensitive&&t||t.toLowerCase();if(n.skip)return{rendered:t,score:0};e=n.caseSensitive&&e||e.toLowerCase();let o=this.traverse(a,e,0,0,[]);return o?{rendered:this.render(t,o.cache,i,s),score:o.score}:null}traverse(e,t,n,i,s){if(t.length===i)return{score:this.calculateScore(s),cache:s.slice()};if(e.length===n||t.length-i>e.length-n)return;let a=t[i],o=e.indexOf(a,n),u,f;for(;o>-1;){if(s.push(o),f=this.traverse(e,t,o+1,i+1,s),s.pop(),!f)return u;(!u||u.score<f.score)&&(u=f),o=e.indexOf(a,o+1)}return u}calculateScore(e){let t=0,n=1;return e.forEach((i,s)=>{s>0&&(e[s-1]+1===i?n+=n+1:n=1),t+=n}),t}render(e,t,n,i){var s=e.substring(0,t[0]);return t.forEach((a,o)=>{s+=n+e[a]+i+e.substring(a+1,t[o+1]?t[o+1]:e.length)}),s}filter(e,t,n){return n=n||{},t.reduce((i,s,a,o)=>{let u=s;n.extract&&(u=n.extract(s),u||(u=""));let f=this.match(e,u,n);return f!=null&&(i[i.length]={string:f.rendered,score:f.score,index:a,original:s}),i},[]).sort((i,s)=>{let a=s.score-i.score;return a||i.index-s.index})}}class ot{constructor({values:e=null,iframe:t=null,selectClass:n="highlight",containerClass:i="tribute-container",itemClass:s="",trigger:a="@",autocompleteMode:o=!1,selectTemplate:u=null,menuItemTemplate:f=null,lookup:d="key",fillAttr:h="value",collection:_=null,menuContainer:b=null,noMatchTemplate:w=null,requireLeadingSpace:C=!0,allowSpaces:A=!1,replaceTextSuffix:B=null,positionMenu:R=!0,spaceSelectsMatch:D=!1,searchOpts:M={},menuItemLimit:S=null,menuShowMinLength:I=0}){if(this.autocompleteMode=o,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=b,this.allowSpaces=A,this.replaceTextSuffix=B,this.positionMenu=R,this.hasTrailingSpace=!1,this.spaceSelectsMatch=D,this.autocompleteMode&&(a="",A=!1),e)this.collection=[{trigger:a,iframe:t,selectClass:n,containerClass:i,itemClass:s,selectTemplate:(u||ot.defaultSelectTemplate).bind(this),menuItemTemplate:(f||ot.defaultMenuItemTemplate).bind(this),noMatchTemplate:(E=>typeof E=="string"?E.trim()===""?null:E:typeof E=="function"?E.bind(this):w||(function(){return"<li>No Match Found!</li>"}).bind(this))(w),lookup:d,fillAttr:h,values:e,requireLeadingSpace:C,searchOpts:M,menuItemLimit:S,menuShowMinLength:I}];else if(_)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=_.map(E=>({trigger:E.trigger||a,iframe:E.iframe||t,selectClass:E.selectClass||n,containerClass:E.containerClass||i,itemClass:E.itemClass||s,selectTemplate:(E.selectTemplate||ot.defaultSelectTemplate).bind(this),menuItemTemplate:(E.menuItemTemplate||ot.defaultMenuItemTemplate).bind(this),noMatchTemplate:(j=>typeof j=="string"?j.trim()===""?null:j:typeof j=="function"?j.bind(this):w||(function(){return"<li>No Match Found!</li>"}).bind(this))(w),lookup:E.lookup||d,fillAttr:E.fillAttr||h,values:E.values,requireLeadingSpace:E.requireLeadingSpace,searchOpts:E.searchOpts||M,menuItemLimit:E.menuItemLimit||S,menuShowMinLength:E.menuShowMinLength||I}));else throw new Error("[Tribute] No collection specified.");new fp(this),new Mr(this),new cp(this),new hp(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(ot.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let t=this.range.getDocument().createElement("div"),n=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(n),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const n=i=>{if(!this.isActive)return;let s=this.search.filter(this.current.mentionText,i,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:u=>{if(typeof this.current.collection.lookup=="string")return u[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(u,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(s=s.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=s;let a=this.menu.querySelector("ul");if(this.range.positionMenuAtCaret(t),!s.length){let u=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(u),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():typeof this.current.collection.noMatchTemplate=="function"?a.innerHTML=this.current.collection.noMatchTemplate():a.innerHTML=this.current.collection.noMatchTemplate;return}a.innerHTML="";let o=this.range.getDocument().createDocumentFragment();s.forEach((u,f)=>{let d=this.range.getDocument().createElement("li");d.setAttribute("data-index",f),d.className=this.current.collection.itemClass,d.addEventListener("mousemove",h=>{let[_,b]=this._findLiTarget(h.target);h.movementY!==0&&this.events.setActiveLi(b)}),this.menuSelected===f&&d.classList.add(this.current.collection.selectClass),d.innerHTML=this.current.collection.menuItemTemplate(u),o.appendChild(d)}),a.appendChild(o)};typeof this.current.collection.values=="function"?this.current.collection.values(this.current.mentionText,n):n(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(typeof document.body.createTextRange<"u"){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}}insertTextAtCursor(e){var t,n;t=window.getSelection(),n=t.getRangeAt(0),n.deleteContents();var i=document.createTextNode(e);n.insertNode(i),n.selectNodeContents(i),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}insertAtCaret(e,t){var n=e.scrollTop,i=e.selectionStart,s=e.value.substring(0,i),a=e.value.substring(e.selectionEnd,e.value.length);e.value=s+t+a,i=i+t.length,e.selectionStart=i,e.selectionEnd=i,e.focus(),e.scrollTop=n}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let n=this.current.filteredItems[e],i=this.current.collection.selectTemplate(n);i!==null&&this.replaceText(i,t,n)}replaceText(e,t,n){this.range.replaceTriggerText(e,!0,!0,t,n)}_append(e,t,n){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");n?e.values=t:e.values=e.values.concat(t)}append(e,t,n){let i=parseInt(e);if(typeof i!="number")throw new Error("please provide an index for the collection to update.");let s=this.collection[i];this._append(s,t,n)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}var dp=Object.defineProperty,pp=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&dp(e,t,i),i};let Au=class extends Gn{constructor(){super(...arguments),this.files=[]}createRenderRoot(){return this}async attach(){const e=await up({});this.files=e}selectIntegration(e){const t=e.target;Tt(()=>{Re.integrations=Re.integrations.map(n=>n.name===t.value?{...n,selected:!0}:{...n,selected:!1})})}submit(){const e=this.querySelector("#message-input");this.dispatchEvent(new CustomEvent("submit",{detail:e.innerText})),this.querySelector("#message-input").innerHTML=""}keydown(e){e.key==="Enter"&&e.metaKey&&this.submit()}firstUpdated(e){super.firstUpdated(e);const t=new ot({selectClass:"text-primary",itemClass:"",containerClass:"card bg-black text-primary-content p-2",values:async function(i,s){console.log(`Searching for ${i}`),await new Promise(a=>setTimeout(a,1e3)),s([{key:"Phil",value:"Phil"},{key:"Bob",value:"Bob"},{key:"Alice",value:"Alice"},{key:"Dave",value:"Dave"}])}}),n=new ot({trigger:"/",selectClass:"text-primary",itemClass:"",containerClass:"card bg-black text-primary-content p-2",values:async function(i,s){console.log(`Command select for ${i}`),await new Promise(a=>setTimeout(a,1e3)),s([{key:"Command 1",value:""},{key:"Command 2",value:""}])}});t.attach(this.querySelector("#message-input")),n.attach(this.querySelector("#message-input"))}render(){return X`<div class="border-t border-gray-700 p-4">
      <div class="relative">
        <div
          id="message-input"
          class="text-xs empty:before:content-[attr(data-placeholder)] w-full max-h-36 p-4 pr-10 resize-none overflow-y-scroll rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-800 text-gray-100"
          contenteditable="true"
          data-placeholder="Type your message here..."
          @keydown="${this.keydown}"
          autofocus
        ></div>

        <div class="grid grid-cols-5 mt-2">
          <!-- Option Buttons -->
          <div class="col-span-4 align-center flex *:mr-1">
            <button class="btn btn-sm" @click="${this.attach}">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="size-6 dark:text-white"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"
                />
              </svg>
              <span class="hidden md:inline-block"> Attach </span>${this.files.length>0?`(${this.files.length})`:""}
            </button>
            <input type="checkbox" id="web" class="hidden peer/web" />
            <label
              for="web"
              class="btn btn-sm peer-checked/web:btn-primary hidden because_this_functionality_is_not_implemented_yet"
            >
              <svg
                class="w-6 h-6 text-gray-800 dark:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-width="2"
                  d="M4.37 7.657c2.063.528 2.396 2.806 3.202 3.87 1.07 1.413 2.075 1.228 3.192 2.644 1.805 2.289 1.312 5.705 1.312 6.705M20 15h-1a4 4 0 0 0-4 4v1M8.587 3.992c0 .822.112 1.886 1.515 2.58 1.402.693 2.918.351 2.918 2.334 0 .276 0 2.008 1.972 2.008 2.026.031 2.026-1.678 2.026-2.008 0-.65.527-.9 1.177-.9H20M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
                />
              </svg>
              <span class="hidden md:inline-block"> Search Web </span>
            </label>
            <select
              @input=${this.selectIntegration}
              class="select select-primary select-sm w-32"
            >
              <option disabled selected>Model</option>
              ${Re.integrations.map(e=>X`<option .selected="${e.selected}">
                    ${e.name}
                  </option>`)}
            </select>
          </div>
          <div class="col-span-1 flex justify-end">
            <button role="button" @click="${this.submit}" class="btn btn-sm">
              <svg
                class="w-6 h-6 text-gray-800 dark:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="m12 18-7 3 7-18 7 18-7-3Zm0 0v-5"
                />
              </svg>
              Send
            </button>
          </div>
        </div>
      </div>
    </div>`}};pp([Wn({type:Array})],Au.prototype,"files");customElements.define("x-prompt",Au);function mp(r){let e=0,t=!1;window.addEventListener("keydown",n=>{r.compare(n)&&(e=setTimeout(()=>{r.callback(),t=!0},r.time))}),window.addEventListener("keyup",n=>{r.compare(n)&&(clearTimeout(e),t&&r.cancel&&(t=!1,r.cancel()))})}var gp=Object.defineProperty,Su=(r,e,t,n)=>{for(var i=void 0,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=a(e,t,i)||i);return i&&gp(e,t,i),i};let Ms=class extends ie{constructor(){super(...arguments),this.keys=[["Meta"]],this.metaDown=!1}createRenderRoot(){return this}firstUpdated(e){super.firstUpdated(e);const t=document.querySelectorAll("x-shortcut-tip");if(t.length>1){console.warn("Shortcut tip already mounted!");const i=Array.from(t).map(s=>s.parentElement);console.log("Mounted parents:",i);return}const n=this.querySelector("dialog");mp({compare:i=>i.code==="MetaLeft",time:1e3,callback:()=>{n==null||n.showModal()},cancel:()=>{n==null||n.close()}})}render(){return X`
      <dialog id="my_modal_3" class="modal">
        <div class="modal-box">
          <form method="dialog">
            <button
              class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2"
            >
              ✕
            </button>
          </form>
          <div>
            <div class="overflow-x-auto">
              <table class="table table-xs">
                <thead>
                  <tr>
                    <th></th>
                    <th>Name</th>
                    <th>Hotkey</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th></th>
                    <td>Show this screen</td>
                    <td><kbd class="kbd">K</kbd></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </dialog>
    `}};Su([Wn({type:Array})],Ms.prototype,"keys");Su([cl()],Ms.prototype,"metaDown");customElements.define("x-shortcut-tip",Ms);class _p extends Gn{createRenderRoot(){return this}render(){return X`<div class=" overflow-y-scroll h-full">
      <div class="p-4 border-b border-gray-700">
        <h2 class="text-xl font-bold font-[Permanent_marker]">Menu</h2>
      </div>

      <!-- Accordion Menu -->

      <!-- Chats Section -->
      <details class="group border-b border-gray-700 marker:content-none" open>
        <summary
          class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
        >
          <span class="font-medium font-[Permanent_marker]">Chats</span>
          <svg
            class="w-5 h-5 transition-transform duration-200 group-open:rotate-180"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </summary>
        <div
          class="p-2 *:block text-sm *:btn *:hover *:hover:btn-primary *:text-left *:mb-1"
        >
          ${ut.chats.map(e=>X`<a href="/chat/${e.id}" class="p-2">
                ${e.messages[0].content.slice(0,22)}
              </a>`)}
        </div>
      </details>
      <!-- Knowledgebase section -->

      <a
        href="/knowledgebase"
        class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
      >
        <span class="font-medium font-[permanent_marker]">Knowledgebase</span>
      </a>

      <!-- Settings Section -->
      <details class="group marker:content-none">
        <summary
          class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-700"
        >
          <span class="font-medium font-[Permanent_marker]">Settings</span>
          <svg
            class="w-5 h-5 transition-transform duration-200 group-open:rotate-180"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </summary>
        <div
          class="p-2 text-sm *:block *:btn *:hover *:hover:btn-primary *:text-left *:mb-1"
        >
          <a href="/settings" class="block p-2"> General Settings </a>
          <a href="/settings/integrations" class="block p-2">
            AI Configuration
          </a>
        </div>
      </details>
    </div>`}}customElements.define("x-sidebar",_p);globalThis.URLPattern||lo(()=>import("./index-BuwMbGsw.js"),[]);export{Gn as M,q as O,es as a,cl as b,gt as d,up as f,yh as g,Vr as m,Wn as n,Tt as r,Xo as t,X as x};
